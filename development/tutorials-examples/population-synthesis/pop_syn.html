

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; posydon development documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=d66fa8e6" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=249f3023"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Stellar Transient Populations 🔍" href="bbh_analysis.html" />
    <link rel="prev" title="Your First Binary Simulations with POSYDON 🌠" href="10_binaries_pop_syn.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/posydon_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction-acknowledgements/intro.html">Introduction, Objectives, and Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction-acknowledgements/collaborative-team.html">Collaborative Team</a></li>
<li class="toctree-l1"><a class="reference external" href="https://posydon.org/papers.html">Publications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation-guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/verification.html">Verification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user-guides/user-roadmap.html">Roadmap to Becoming an Expert POSYDON User</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials and Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="binary-pop-syn.html">Binary-Star Population Synthesis with POSYDON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generating-datasets/generating-datasets.html">Crafting the Core Datasets for POSYDON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MESA-grids/running-grids.html">Architecting MESA Simulation Grids with POSYDON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">In-Depth Components Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../components-overview/mesa-grids.html">MESA Grids API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components-overview/processing-pipeline.html">Processing Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components-overview/machine-learning-components.html">Machine Learning Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components-overview/stellar-binary-simulation.html">Stellar &amp; Binary-star Simulation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference/posydon.html">posydon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference/bin.html">executables</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Troubleshooting and FAQs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting-faqs/installation-issues.html">Installation Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting-faqs/code-questions.html">Code Usage Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to POSYDON</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/how-to-contribute.html">How To Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/code-style-guidelines.html">Code Style Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/reporting-issues.html">Reporting issues</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Releases and Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/POSYDON-code/POSYDON/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://zenodo.org/communities/posydon/">Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contact and Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contact-support/contact-information.html">Contact Information</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">posydon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="binary-pop-syn.html">Binary-Star Population Synthesis with POSYDON</a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials-examples/population-synthesis/pop_syn.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <dl>
<dt>{</dt><dd><dl>
<dt>“cells”: [</dt><dd><dl>
<dt>{</dt><dd><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“# Large-Scale Population Synthesis on HPC Facilities 🚀n”,
“n”,
“n”,
“This tutorial will cover how to setup and run a large, multi-metallicity population run on a HPC with slurm.n”,
“We will dive deeper into the <cite>population_params.ini</cite> file and how the <cite>Population</cite> class works for multi-metallicity populations.”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## Initialization File for multi-metallicity runs”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“Let’s copy the default population synthesis <cite>ini</cite> file to your working directory.n”,
“Make sure you’re on a cluster to be able to run and submit the jobs!n”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“import osn”,
“import shutiln”,
“from posydon.config import PATH_TO_POSYDONn”,
“n”,
“path_to_params = os.path.join(PATH_TO_POSYDON, &quot;posydon/popsyn/population_params_default.ini&quot;)n”,
“shutil.copyfile(path_to_params, ‘./population_params.ini’)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“Open the <cite>population_params.ini</cite> file and you should see all 8 currently supported metallicities present. n”,
“n”,
“<code class="docutils literal notranslate"><span class="pre">`\n&quot;,</span>
<span class="pre">&quot;metallicity</span> <span class="pre">=</span> <span class="pre">[2.,</span> <span class="pre">1.,</span> <span class="pre">0.45,</span> <span class="pre">0.2,</span> <span class="pre">0.1,</span> <span class="pre">0.01,</span> <span class="pre">0.001,</span> <span class="pre">0.0001]\n&quot;,</span>
<span class="pre">&quot;`</span></code>n”,
“n”,
“For our test run, we do not require a large population, so set the number of binaries to 1000.n”,
“You might also want to make sure the <cite>dump_rate</cite> is set to 100 binaries for this example.n”,
“n”,
“n”,
“<code class="docutils literal notranslate"><span class="pre">`\n&quot;,</span>
<span class="pre">&quot;dump_rate</span> <span class="pre">=</span> <span class="pre">100\n&quot;,</span>
<span class="pre">&quot;...\n&quot;,</span>
<span class="pre">&quot;number_of_binaries</span> <span class="pre">=</span> <span class="pre">1000\n&quot;,</span>
<span class="pre">&quot;`</span></code>”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## Setup the Population Synthesis Run”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“POSYDON provides <cite>posydon-popsyn setup</cite> as a command line script that you can use to setup a (multi-metallicity) population run on a HPC facility.n”,
“This will split each metallicity into a separate slurm job-array and a dependent job which will automatically merge the output of the separate jobs.n”,
“This removes the need to manually setup each slurm job.n”,
“Below are two examples, but you might need to adjust the inputs for your email, cluster and available partitions.n”,
“n”,
“&lt;div class=&quot;alert alert-warning&quot;&gt;n”,
“n”,
“<strong>Older POSYDON installations</strong>n”,
“n”,
“If the <cite>posydon-popsyn setup</cite> command is not available, you might have to install POSYDON.n”,
“1. Go to the directory: <cite>cd $PATH_TO_POSYDON</cite>n”,
“2. Uninstall using pip <cite>pip uninstall posydon</cite>n”,
“3. Reinstall: if you’re using the development version: <cite>pip install .</cite>n”,
“   n”,
“See the [Installation instructions](../../getting-started/installation-guide.rst) if any issues occur.n”,
“&lt;/div&gt;n”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“vscode”: {</dt><dd><p>“languageId”: “shellscript”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# example for yggdrasiln”,
“posydon-popsyn setup population_params.ini –job_array=10 \n”,
“                                            –walltime=00:14:00 \n”,
“                                            –mem_per_cpu=5G  \n”,
“                                            –partition=debug-cpu \n”,
“                                            <a class="reference external" href="mailto:--email=max&#46;briel&#37;&#52;&#48;unige&#46;ch">–email=max<span>&#46;</span>briel<span>&#64;</span>unige<span>&#46;</span>ch</a> \n”,
“                                            –account=fragkos”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“vscode”: {</dt><dd><p>“languageId”: “shellscript”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# example for quest clustern”,
“posydon-popsyn setup population_params.ini –job-array=10 \n”,
“                                           –walltime=00:14:00 \n”,
“                                           –partition=posydon-std \n”,</p>
<blockquote>
<div><p>–account=b1119 \n”,</p>
</div></blockquote>
<p>“                                           <a class="reference external" href="mailto:--email=max&#46;briel&#37;&#52;&#48;unige&#46;ch">–email=max<span>&#46;</span>briel<span>&#64;</span>unige<span>&#46;</span>ch</a> \n”,
“                                           –mem_per_cpu=5Gn”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“<cite>posydon-popsyn setup –help</cite> should provide a complete list of possible input parameters.n”,
“n”,
“n”,
“### Walltime and job_array number fine-tuningn”,
“n”,
“The above examples will setup the population run with an array of 10 jobs for each metallicity. As such, each job will run 100 binaries of the 1000 binaries per metallicity.n”,
“n”,
“Fine-tuning the <cite>dump_rate</cite>, <cite>mem_per_cpu</cite>, number of <cite>job-array</cite>’s, and <cite>walltime</cite> compared to the total number of binaries can be helpful in optimizing your cluster usage. See [the FAQ](../../troubleshooting-faqs/code-questions.rst) for more detailed guidance on the memory footprint of a population synthesis run in POSYDON.n”,
“By default, 5GB of RAM is requested per job, which fits well with the default <cite>dump_rate</cite> of 2000.n”,
“n”,
“As a rule of thumb for the <cite>walltime</cite>, a single binary takes about 1-2 seconds to run. In the example run, each job of 100 binaries should take around 2 to 3 minutes. However, some additional setup time for loading the grids is required! See [the FAQ](../../troubleshooting-faqs/code-questions.rst) for another example of <code class="docutils literal notranslate"><span class="pre">`walltime`</span></code> estimation.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“After you’ve run the above setup, you should now have several files in your work directory.n”,
“n”,
“You can submit all job arrays and merged jobs using <cite>slurm_submit.sh</cite>n”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“vscode”: {</dt><dd><p>“languageId”: “shellscript”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“sh slurm_submit.sh”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“After your job has finished, you can use the following command to verify that your run was successful.n”,
“Please replace <cite>{run_folder}</cite> with the folder, where you ran the population.n”,
“n”,
“<code class="docutils literal notranslate"><span class="pre">`\n&quot;,</span>
<span class="pre">&quot;posydon-popsyn</span> <span class="pre">check</span> <span class="pre">{run_folder}\n&quot;,</span>
<span class="pre">&quot;`</span></code>n”,
“n”,
“Additionally, the <cite>*_logs</cite> folder will contain the logs of each job in the job_array.n”,
“n”,
“If one of your runs failed, you can use the <cite>posydon-popsyn rescue {run_folder}</cite> command to try to rescue it.n”,
“This allows failed job in a job array to be resubmitted. You can provide the same commands as <cite>posydon-popsyn setup</cite>, if you want to change slurm parameters, such as walltime and mem-per-cpu.n”,
“n”,
“n”,
“## Populations inspectionn”,
“n”,
“Once the runs and the concatenation have finished. You should have 8 files named <cite>MET_Zsun_population.h5</cite>, where <cite>MET</cite> are the metallicities.n”,
“n”,
“We will inspect two to check the number of binaries in the population.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“from posydon.popsyn.synthetic_population import Populationn”,
“n”,
“file1 = ‘1e-01_Zsun_population.h5’n”,
“file2 = ‘1e-02_Zsun_population.h5’n”,
“n”,
“pop1 = Population(file1)n”,
“print(pop1.mass_per_metallicity)n”,
“n”,
“pop2 = Population(file2)n”,
“print(pop2.mass_per_metallicity)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“In the next tutorial ([BBH analysis](bbh_analysis.ipynb)), we will look into selecting specific events and combining the different metallicity runs into a single population and selecting the binary black hole mergers in them!”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: []</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>],
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“kernelspec”: {</dt><dd><p>“display_name”: “posydon_env”,
“language”: “python”,
“name”: “python3”</p>
</dd>
</dl>
<p>},
“language_info”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“codemirror_mode”: {</dt><dd><p>“name”: “ipython”,
“version”: 3</p>
</dd>
</dl>
<p>},
“file_extension”: “.py”,
“mimetype”: “text/x-python”,
“name”: “python”,
“nbconvert_exporter”: “python”,
“pygments_lexer”: “ipython3”,
“version”: “3.11.5”</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
“nbformat”: 4,
“nbformat_minor”: 4</p>
</dd>
</dl>
<p>}</p>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="10_binaries_pop_syn.html" class="btn btn-neutral float-left" title="Your First Binary Simulations with POSYDON 🌠" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bbh_analysis.html" class="btn btn-neutral float-right" title="Stellar Transient Populations 🔍" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Tassos Fragos.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      Version: dev
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        
        <dl>
            <dt> v1 versions</dt>
            
            <dd><a href="https://posydon.org/POSYDON/v1.0.0/index.html">1.0.0</a></dd>
            
            <dd><a href="https://posydon.org/POSYDON/v1.0.4/index.html">1.0.4</a></dd>
            
            <dd><a href="https://posydon.org/POSYDON/v1.0.5/index.html">1.0.5</a></dd>
            
        </dL>
        
        
        <dl>
            <dt> v2 versions</dt>
            
            <dd><a href="https://posydon.org/POSYDON/v2.0.0-pre1/index.html">2.0.0-pre1</a></dd>
            
            <dd><a href="https://posydon.org/POSYDON/v2.0.0-pre2/index.html">2.0.0-pre2</a></dd>
            
            <dd><a href="https://posydon.org/POSYDON/development/index.html">dev</a></dd>
            
        </dL>
        
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>