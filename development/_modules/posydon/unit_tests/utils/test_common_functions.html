

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>posydon.unit_tests.utils.test_common_functions &mdash; posydon development documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=d66fa8e6" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=249f3023"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html">
            
              <img src="../../../../_static/posydon_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction-acknowledgements/intro.html">Introduction, Objectives, and Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction-acknowledgements/collaborative-team.html">Collaborative Team</a></li>
<li class="toctree-l1"><a class="reference external" href="https://posydon.org/papers.html">Publications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting-started/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting-started/installation-guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting-started/verification.html">Verification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../user-guides/user-roadmap.html">Roadmap to Becoming an Expert POSYDON User</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials and Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials-examples/population-synthesis/binary-pop-syn.html">Binary-Star Population Synthesis with POSYDON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials-examples/generating-datasets/generating-datasets.html">Crafting the Core Datasets for POSYDON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials-examples/MESA-grids/running-grids.html">Architecting MESA Simulation Grids with POSYDON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">In-Depth Components Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../components-overview/mesa-grids.html">MESA Grids API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components-overview/processing-pipeline.html">Processing Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components-overview/machine-learning-components.html">Machine Learning Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../components-overview/stellar-binary-simulation.html">Stellar &amp; Binary-star Simulation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api_reference/posydon.html">posydon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api_reference/bin.html">executables</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Troubleshooting and FAQs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../troubleshooting-faqs/installation-issues.html">Installation Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../troubleshooting-faqs/code-questions.html">Code Usage Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to POSYDON</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/how-to-contribute.html">How To Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/code-style-guidelines.html">Code Style Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/reporting-issues.html">Reporting issues</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Releases and Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/POSYDON-code/POSYDON/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://zenodo.org/communities/posydon/">Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contact and Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../contact-support/contact-information.html">Contact Information</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">posydon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">posydon.unit_tests.utils.test_common_functions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for posydon.unit_tests.utils.test_common_functions</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Unit tests of posydon/utils/common_functions.py</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__authors__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Matthias Kruckow &lt;Matthias.Kruckow@unige.ch&gt;&quot;</span>
<span class="p">]</span>

<span class="c1"># import the module which will be tested</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">posydon.utils.common_functions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">totest</span>
<span class="c1"># aliases</span>
<span class="n">np</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">np</span>
<span class="n">os</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">os</span>

<span class="c1"># import other needed code for the tests, which is not already imported in the</span>
<span class="c1"># module you like to test</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytest</span><span class="w"> </span><span class="kn">import</span> <span class="n">fixture</span><span class="p">,</span> <span class="n">raises</span><span class="p">,</span> <span class="n">warns</span><span class="p">,</span> <span class="n">approx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inspect</span><span class="w"> </span><span class="kn">import</span> <span class="n">isroutine</span><span class="p">,</span> <span class="n">isclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">posydon.binary_evol.binarystar</span><span class="w"> </span><span class="kn">import</span> <span class="n">BinaryStar</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">posydon.binary_evol.singlestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">SingleStar</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">posydon.utils.posydonwarning</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">EvolutionWarning</span><span class="p">,</span>\
    <span class="n">InappropriateValueWarning</span><span class="p">,</span> <span class="n">ApproximationWarning</span><span class="p">,</span> <span class="n">InterpolationWarning</span><span class="p">,</span>\
    <span class="n">ReplaceValueWarning</span><span class="p">,</span> <span class="n">ClassificationWarning</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">posydon.utils.interpolators</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>

<div class="viewcode-block" id="binary">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.binary">[docs]</a>
<span class="nd">@fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">binary</span><span class="p">():</span>
    <span class="c1"># initialize a BinaryStar instance, which is a required argument</span>
    <span class="k">return</span> <span class="n">BinaryStar</span><span class="p">()</span></div>


<div class="viewcode-block" id="star">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.star">[docs]</a>
<span class="nd">@fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">star</span><span class="p">():</span>
    <span class="c1"># initialize a SingleStar instance, which is a required argument</span>
    <span class="k">return</span> <span class="n">SingleStar</span><span class="p">()</span></div>


<div class="viewcode-block" id="star_profile">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.star_profile">[docs]</a>
<span class="nd">@fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">star_profile</span><span class="p">():</span>
    <span class="c1"># generate a profile of a test star</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;dm&#39;</span><span class="p">,</span> <span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="s1">&#39;log_R&#39;</span><span class="p">,</span> <span class="s1">&#39;energy&#39;</span><span class="p">,</span> <span class="s1">&#39;x_mass_fraction_H&#39;</span><span class="p">,</span>\
            <span class="s1">&#39;y_mass_fraction_He&#39;</span><span class="p">,</span> <span class="s1">&#39;z_mass_fraction_metals&#39;</span><span class="p">,</span>\
            <span class="s1">&#39;neutral_fraction_H&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral_fraction_He&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_charge_He&#39;</span><span class="p">]</span>
    <span class="n">profile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">4</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">])</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">])</span>
    <span class="c1"># get dm as differences from mass and the last mass entry (like next would</span>
    <span class="c1"># be 0)</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;dm&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;dm&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">])</span>
    <span class="c1"># get log10 of radius</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;log_R&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">])</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.0e+16</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;x_mass_fraction_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">])</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;y_mass_fraction_He&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
    <span class="c1"># get Z=1-X-Y</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;z_mass_fraction_metals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;x_mass_fraction_H&#39;</span><span class="p">]</span>\
                                        <span class="o">-</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;y_mass_fraction_He&#39;</span><span class="p">]</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;neutral_fraction_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;neutral_fraction_He&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
    <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;avg_charge_He&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">profile</span></div>


<span class="c1"># define test classes collecting several test functions</span>
<div class="viewcode-block" id="TestElements">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestElements</span><span class="p">:</span>
    <span class="c1"># check for objects, which should be an element of the tested module</span>
<div class="viewcode-block" id="TestElements.test_dir">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_dir">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ALL_RLO_CASES&#39;</span><span class="p">,</span> <span class="s1">&#39;ALL_STAR_STATES&#39;</span><span class="p">,</span> <span class="s1">&#39;BURNING_STATES&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;CEE_parameters_from_core_abundance_thresholds&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;COMPACT_OBJECTS&#39;</span><span class="p">,</span> <span class="s1">&#39;CO_radius&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;DEFAULT_CE_OPTION_FOR_LAMBDA&#39;</span><span class="p">,</span> <span class="s1">&#39;He_MS_lifetime&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;LG_MTRANSFER_RATE_THRESHOLD&#39;</span><span class="p">,</span> <span class="s1">&#39;LOG10_BURNING_THRESHOLD&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;MT_CASE_A&#39;</span><span class="p">,</span> <span class="s1">&#39;MT_CASE_B&#39;</span><span class="p">,</span> <span class="s1">&#39;MT_CASE_BA&#39;</span><span class="p">,</span> <span class="s1">&#39;MT_CASE_BB&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;MT_CASE_BC&#39;</span><span class="p">,</span> <span class="s1">&#39;MT_CASE_C&#39;</span><span class="p">,</span> <span class="s1">&#39;MT_CASE_NONBURNING&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;MT_CASE_NO_RLO&#39;</span><span class="p">,</span> <span class="s1">&#39;MT_CASE_TO_STR&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;MT_CASE_UNDETERMINED&#39;</span><span class="p">,</span> <span class="s1">&#39;MT_STR_TO_CASE&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;Pwarn&#39;</span><span class="p">,</span> <span class="s1">&#39;REL_LOG10_BURNING_THRESHOLD&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;RICHNESS_STATES&#39;</span><span class="p">,</span> <span class="s1">&#39;RL_RELATIVE_OVERFLOW_THRESHOLD&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;STATE_NS_STARMASS_LOWER_LIMIT&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;STATE_NS_STARMASS_UPPER_LIMIT&#39;</span><span class="p">,</span> <span class="s1">&#39;STATE_UNDETERMINED&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;STATE_WD_STARMASS_UPPER_LIMIT&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;Schwarzschild_Radius&#39;</span><span class="p">,</span> <span class="s1">&#39;THRESHOLD_CENTRAL_ABUNDANCE&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;THRESHOLD_HE_NAKED_ABUNDANCE&#39;</span><span class="p">,</span> <span class="s1">&#39;__authors__&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;__builtins__&#39;</span><span class="p">,</span> <span class="s1">&#39;__cached__&#39;</span><span class="p">,</span> <span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s1">&#39;__file__&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;__loader__&#39;</span><span class="p">,</span> <span class="s1">&#39;__name__&#39;</span><span class="p">,</span> <span class="s1">&#39;__package__&#39;</span><span class="p">,</span> <span class="s1">&#39;__spec__&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;beaming&#39;</span><span class="p">,</span> <span class="s1">&#39;bondi_hoyle&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;calculate_H2recombination_energy&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;calculate_Mejected_for_integrated_binding_energy&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;calculate_Patton20_values_at_He_depl&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;calculate_binding_energy&#39;</span><span class="p">,</span> <span class="s1">&#39;calculate_core_boundary&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;calculate_lambda_from_profile&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;calculate_recombination_energy&#39;</span><span class="p">,</span> <span class="s1">&#39;check_state_of_star&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;check_state_of_star_history_array&#39;</span><span class="p">,</span> <span class="s1">&#39;const&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;convert_metallicity_to_string&#39;</span><span class="p">,</span> <span class="s1">&#39;copy&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;cumulative_mass_transfer_flag&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;cumulative_mass_transfer_numeric&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;cumulative_mass_transfer_string&#39;</span><span class="p">,</span> <span class="s1">&#39;eddington_limit&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;flip_stars&#39;</span><span class="p">,</span> <span class="s1">&#39;get_binary_state_and_event_and_mt_case&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;get_binary_state_and_event_and_mt_case_array&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;get_i_He_depl&#39;</span><span class="p">,</span> <span class="s1">&#39;get_internal_energy_from_profile&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;get_mass_radius_dm_from_profile&#39;</span><span class="p">,</span> <span class="s1">&#39;histogram_sampler&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;infer_mass_transfer_case&#39;</span><span class="p">,</span> <span class="s1">&#39;infer_star_state&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;initialize_empty_array&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;inspiral_timescale_from_orbital_period&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;inspiral_timescale_from_separation&#39;</span><span class="p">,</span> <span class="s1">&#39;interp1d&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;inverse_sampler&#39;</span><span class="p">,</span> <span class="s1">&#39;is_number&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;linear_interpolation_between_two_cells&#39;</span><span class="p">,</span> <span class="s1">&#39;newton&#39;</span><span class="p">,</span> <span class="s1">&#39;np&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;orbital_period_from_separation&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;orbital_separation_from_period&#39;</span><span class="p">,</span> <span class="s1">&#39;os&#39;</span><span class="p">,</span> <span class="s1">&#39;pd&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;period_change_stable_MT&#39;</span><span class="p">,</span> <span class="s1">&#39;period_evol_wind_loss&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;profile_recomb_energy&#39;</span><span class="p">,</span> <span class="s1">&#39;quad&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;read_histogram_from_file&#39;</span><span class="p">,</span> <span class="s1">&#39;rejection_sampler&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;roche_lobe_radius&#39;</span><span class="p">,</span> <span class="s1">&#39;rotate&#39;</span><span class="p">,</span> <span class="s1">&#39;rzams&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;separation_evol_wind_loss&#39;</span><span class="p">,</span> <span class="s1">&#39;set_binary_to_failed&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;spin_stable_mass_transfer&#39;</span><span class="p">,</span> <span class="s1">&#39;stefan_boltzmann_law&#39;</span><span class="p">}</span>
        <span class="n">totest_elements</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">totest</span><span class="p">))</span>
        <span class="n">missing_in_test</span> <span class="o">=</span> <span class="n">elements</span> <span class="o">-</span> <span class="n">totest_elements</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_in_test</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;There are missing objects in &quot;</span>\
                                          <span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">totest</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: &quot;</span>\
                                          <span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">missing_in_test</span><span class="si">}</span><span class="s2">. Please &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;check, whether they have been &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;removed on purpose and update &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;this unit test.&quot;</span>
        <span class="n">new_in_test</span> <span class="o">=</span> <span class="n">totest_elements</span> <span class="o">-</span> <span class="n">elements</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_in_test</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;There are new objects in &quot;</span>\
                                      <span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">totest</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">new_in_test</span><span class="si">}</span><span class="s2">. &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;Please check, whether they have been &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;added on purpose and update this &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;unit test.&quot;</span></div>


<div class="viewcode-block" id="TestElements.test_instance_STATE_UNDETERMINED">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_STATE_UNDETERMINED">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_STATE_UNDETERMINED</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">STATE_UNDETERMINED</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_BURNING_STATES">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_BURNING_STATES">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_BURNING_STATES</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">BURNING_STATES</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_RICHNESS_STATES">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_RICHNESS_STATES">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_RICHNESS_STATES</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">RICHNESS_STATES</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_COMPACT_OBJECTS">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_COMPACT_OBJECTS">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_COMPACT_OBJECTS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">COMPACT_OBJECTS</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_ALL_STAR_STATES">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_ALL_STAR_STATES">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_ALL_STAR_STATES</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">ALL_STAR_STATES</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_NO_RLO">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_NO_RLO">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_NO_RLO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_A">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_A">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_A</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_B">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_B">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_B</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_C">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_C">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_C</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_C</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_BA">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_BA">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_BA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BA</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_BB">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_BB">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_BB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BB</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_BC">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_BC">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_BC</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BC</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_NONBURNING">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_NONBURNING">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_NONBURNING</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NONBURNING</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_UNDETERMINED">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_UNDETERMINED">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_UNDETERMINED</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_ALL_RLO_CASES">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_ALL_RLO_CASES">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_ALL_RLO_CASES</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">ALL_RLO_CASES</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_CASE_TO_STR">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_CASE_TO_STR">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_CASE_TO_STR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_TO_STR</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_MT_STR_TO_CASE">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_MT_STR_TO_CASE">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_MT_STR_TO_CASE</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_STR_TO_CASE</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_DEFAULT_CE_OPTION_FOR_LAMBDA">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_DEFAULT_CE_OPTION_FOR_LAMBDA">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_DEFAULT_CE_OPTION_FOR_LAMBDA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">DEFAULT_CE_OPTION_FOR_LAMBDA</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_is_number">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_is_number">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_is_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">is_number</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_stefan_boltzmann_law">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_stefan_boltzmann_law">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_stefan_boltzmann_law</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">stefan_boltzmann_law</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_rzams">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_rzams">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_rzams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rzams</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_roche_lobe_radius">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_roche_lobe_radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_roche_lobe_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_orbital_separation_from_period">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_orbital_separation_from_period">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_orbital_separation_from_period</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">orbital_separation_from_period</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_orbital_period_from_separation">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_orbital_period_from_separation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_orbital_period_from_separation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">orbital_period_from_separation</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_eddington_limit">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_eddington_limit">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_eddington_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">eddington_limit</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_beaming">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_beaming">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_beaming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">beaming</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_bondi_hoyle">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_bondi_hoyle">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_bondi_hoyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_rejection_sampler">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_rejection_sampler">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_rejection_sampler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_inverse_sampler">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_inverse_sampler">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_inverse_sampler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">inverse_sampler</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_histogram_sampler">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_histogram_sampler">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_histogram_sampler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">histogram_sampler</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_read_histogram_from_file">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_read_histogram_from_file">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_read_histogram_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">read_histogram_from_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_inspiral_timescale_from_separation">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_inspiral_timescale_from_separation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_inspiral_timescale_from_separation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_separation</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_inspiral_timescale_from_orbital_period">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_inspiral_timescale_from_orbital_period">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_inspiral_timescale_from_orbital_period</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_orbital_period</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_spin_stable_mass_transfer">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_spin_stable_mass_transfer">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_spin_stable_mass_transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">spin_stable_mass_transfer</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_check_state_of_star">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_check_state_of_star">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_check_state_of_star</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_check_state_of_star_history_array">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_check_state_of_star_history_array">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_check_state_of_star_history_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star_history_array</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_get_binary_state_and_event_and_mt_case">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_get_binary_state_and_event_and_mt_case">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_get_binary_state_and_event_and_mt_case_array">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_get_binary_state_and_event_and_mt_case_array">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_get_binary_state_and_event_and_mt_case_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case_array</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_CO_radius">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_CO_radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_CO_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">CO_radius</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_He_MS_lifetime">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_He_MS_lifetime">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_He_MS_lifetime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">He_MS_lifetime</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_Schwarzschild_Radius">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_Schwarzschild_Radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_Schwarzschild_Radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">Schwarzschild_Radius</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_flip_stars">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_flip_stars">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_flip_stars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">flip_stars</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_set_binary_to_failed">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_set_binary_to_failed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_set_binary_to_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">set_binary_to_failed</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_infer_star_state">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_infer_star_state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_infer_star_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">infer_star_state</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_infer_mass_transfer_case">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_infer_mass_transfer_case">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_infer_mass_transfer_case</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_cumulative_mass_transfer_numeric">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_cumulative_mass_transfer_numeric">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_cumulative_mass_transfer_numeric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_cumulative_mass_transfer_string">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_cumulative_mass_transfer_string">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_cumulative_mass_transfer_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_string</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_cumulative_mass_transfer_flag">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_cumulative_mass_transfer_flag">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_cumulative_mass_transfer_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_flag</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_get_i_He_depl">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_get_i_He_depl">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_get_i_He_depl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">get_i_He_depl</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_calculate_Patton20_values_at_He_depl">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_calculate_Patton20_values_at_He_depl">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_calculate_Patton20_values_at_He_depl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">calculate_Patton20_values_at_He_depl</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_CEE_parameters_from_core_abundance_thresholds">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_CEE_parameters_from_core_abundance_thresholds">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_CEE_parameters_from_core_abundance_thresholds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">CEE_parameters_from_core_abundance_thresholds</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_initialize_empty_array">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_initialize_empty_array">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_initialize_empty_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">initialize_empty_array</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_calculate_core_boundary">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_calculate_core_boundary">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_calculate_core_boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_period_evol_wind_loss">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_period_evol_wind_loss">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_period_evol_wind_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">period_evol_wind_loss</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_separation_evol_wind_loss">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_separation_evol_wind_loss">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_separation_evol_wind_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">separation_evol_wind_loss</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_period_change_stable_MT">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_period_change_stable_MT">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_period_change_stable_MT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">period_change_stable_MT</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_linear_interpolation_between_two_cells">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_linear_interpolation_between_two_cells">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_linear_interpolation_between_two_cells</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_calculate_lambda_from_profile">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_calculate_lambda_from_profile">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_calculate_lambda_from_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_get_mass_radius_dm_from_profile">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_get_mass_radius_dm_from_profile">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_get_mass_radius_dm_from_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">get_mass_radius_dm_from_profile</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_get_internal_energy_from_profile">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_get_internal_energy_from_profile">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_get_internal_energy_from_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">get_internal_energy_from_profile</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_calculate_H2recombination_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_calculate_H2recombination_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_calculate_H2recombination_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">calculate_H2recombination_energy</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_calculate_recombination_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_calculate_recombination_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_calculate_recombination_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">calculate_recombination_energy</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_profile_recomb_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_profile_recomb_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_profile_recomb_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">profile_recomb_energy</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_calculate_binding_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_calculate_binding_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_calculate_binding_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">calculate_binding_energy</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_calculate_Mejected_for_integrated_binding_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_calculate_Mejected_for_integrated_binding_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_calculate_Mejected_for_integrated_binding_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span>\
                         <span class="n">calculate_Mejected_for_integrated_binding_energy</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_convert_metallicity_to_string">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_convert_metallicity_to_string">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_convert_metallicity_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">convert_metallicity_to_string</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestElements.test_instance_rotate">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestElements.test_instance_rotate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_instance_rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">isroutine</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TestValues">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestValues</span><span class="p">:</span>
    <span class="c1"># check that the values fit</span>
<div class="viewcode-block" id="TestValues.test_value_STATE_UNDETERMINED">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_STATE_UNDETERMINED">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_STATE_UNDETERMINED</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">STATE_UNDETERMINED</span> <span class="o">==</span> <span class="s2">&quot;undetermined_evolutionary_state&quot;</span></div>


<div class="viewcode-block" id="TestValues.test_value_BURNING_STATES">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_BURNING_STATES">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_BURNING_STATES</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Core_H_burning&quot;</span><span class="p">,</span> <span class="s2">&quot;Core_He_burning&quot;</span><span class="p">,</span> <span class="s2">&quot;Shell_H_burning&quot;</span><span class="p">,</span>\
                  <span class="s2">&quot;Central_He_depleted&quot;</span><span class="p">,</span> <span class="s2">&quot;Central_C_depletion&quot;</span><span class="p">]:</span>
            <span class="c1"># check required values</span>
            <span class="k">assert</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">BURNING_STATES</span><span class="p">,</span> <span class="s2">&quot;missing entry&quot;</span></div>


<div class="viewcode-block" id="TestValues.test_value_RICHNESS_STATES">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_RICHNESS_STATES">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_RICHNESS_STATES</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;H-rich&quot;</span><span class="p">,</span> <span class="s2">&quot;stripped_He&quot;</span><span class="p">,</span> <span class="s2">&quot;accreted_He&quot;</span><span class="p">]:</span>
            <span class="c1"># check required values</span>
            <span class="k">assert</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">RICHNESS_STATES</span><span class="p">,</span> <span class="s2">&quot;missing entry&quot;</span></div>


<div class="viewcode-block" id="TestValues.test_value_COMPACT_OBJECTS">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_COMPACT_OBJECTS">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_COMPACT_OBJECTS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WD&quot;</span><span class="p">,</span> <span class="s2">&quot;NS&quot;</span><span class="p">,</span> <span class="s2">&quot;BH&quot;</span><span class="p">,</span> <span class="s2">&quot;massless_remnant&quot;</span><span class="p">]:</span>
            <span class="c1"># check required values</span>
            <span class="k">assert</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">COMPACT_OBJECTS</span><span class="p">,</span> <span class="s2">&quot;missing entry&quot;</span></div>


<div class="viewcode-block" id="TestValues.test_value_ALL_STAR_STATES">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_ALL_STAR_STATES">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_ALL_STAR_STATES</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">COMPACT_OBJECTS</span><span class="p">:</span>
            <span class="c1"># check required values of COMPACT_OBJECTS</span>
            <span class="k">assert</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">ALL_STAR_STATES</span><span class="p">,</span> <span class="s2">&quot;missing entry&quot;</span>
        <span class="c1"># check required STATE_UNDETERMINED</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">STATE_UNDETERMINED</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">ALL_STAR_STATES</span><span class="p">,</span>\
               <span class="s2">&quot;missing entry&quot;</span>
        <span class="k">for</span> <span class="n">v1</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">RICHNESS_STATES</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v2</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">BURNING_STATES</span><span class="p">:</span>
                <span class="c1"># check required values of combinatios of RICHNESS_STATES and</span>
                <span class="c1"># BURNING_STATES</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v1</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">v2</span>
                <span class="k">assert</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">ALL_STAR_STATES</span><span class="p">,</span> <span class="s2">&quot;missing entry&quot;</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_NO_RLO">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_NO_RLO">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_NO_RLO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span> <span class="o">==</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_A">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_A">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_A</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span> <span class="o">==</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_B">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_B">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_B</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span> <span class="o">==</span> <span class="mi">2</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_C">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_C">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_C</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_C</span> <span class="o">==</span> <span class="mi">3</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_BA">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_BA">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_BA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BA</span> <span class="o">==</span> <span class="mi">4</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_BB">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_BB">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_BB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BB</span> <span class="o">==</span> <span class="mi">5</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_BC">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_BC">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_BC</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BC</span> <span class="o">==</span> <span class="mi">6</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_NONBURNING">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_NONBURNING">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_NONBURNING</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NONBURNING</span> <span class="o">==</span> <span class="mi">8</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_UNDETERMINED">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_UNDETERMINED">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_UNDETERMINED</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span> <span class="o">==</span> <span class="mi">9</span></div>


<div class="viewcode-block" id="TestValues.test_value_ALL_RLO_CASES">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_ALL_RLO_CASES">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_ALL_RLO_CASES</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_C</span><span class="p">,</span>\
                  <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BA</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BB</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BC</span><span class="p">,</span>\
                  <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NONBURNING</span><span class="p">]:</span>
            <span class="c1"># check required values</span>
            <span class="k">assert</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">ALL_RLO_CASES</span><span class="p">,</span> <span class="s2">&quot;missing entry&quot;</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_CASE_TO_STR">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_CASE_TO_STR">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_CASE_TO_STR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">,</span>\
                  <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_C</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BA</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BB</span><span class="p">,</span>\
                  <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BC</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NONBURNING</span><span class="p">,</span>\
                  <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">]:</span>
            <span class="c1"># check required values</span>
            <span class="k">assert</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_TO_STR</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="s2">&quot;missing entry&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_TO_STR</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestValues.test_value_MT_STR_TO_CASE">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_MT_STR_TO_CASE">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_MT_STR_TO_CASE</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_STR_TO_CASE</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># check required items</span>
            <span class="k">assert</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_TO_STR</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>


<div class="viewcode-block" id="TestValues.test_value_DEFAULT_CE_OPTION_FOR_LAMBDA">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestValues.test_value_DEFAULT_CE_OPTION_FOR_LAMBDA">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_value_DEFAULT_CE_OPTION_FOR_LAMBDA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">DEFAULT_CE_OPTION_FOR_LAMBDA</span> <span class="o">==</span> <span class="s2">&quot;lambda_from_profile_&quot;</span>\
               <span class="o">+</span> <span class="s2">&quot;gravitational_plus_internal_minus_recombination&quot;</span></div>
</div>



<div class="viewcode-block" id="TestFunctions">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestFunctions</span><span class="p">:</span>
<div class="viewcode-block" id="TestFunctions.csv_path_failing_3_data_lines">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.csv_path_failing_3_data_lines">[docs]</a>
    <span class="nd">@fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">csv_path_failing_3_data_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp_path</span><span class="p">):</span>
        <span class="c1"># a temporary path to csv file for testing</span>
        <span class="c1"># it contains 4 lines, where three having data in there</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="s2">&quot;hist_fail.csv&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">test_file</span><span class="p">:</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0.0,1.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;1.0,1.0</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;2.0,1.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="TestFunctions.csv_path_failing_empty_line">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.csv_path_failing_empty_line">[docs]</a>
    <span class="nd">@fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">csv_path_failing_empty_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp_path</span><span class="p">):</span>
        <span class="c1"># a temporary path to csv file for testing</span>
        <span class="c1"># it only contains an empty line</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="s2">&quot;hist_fail2.csv&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">test_file</span><span class="p">:</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="TestFunctions.csv_path_failing_element_counts">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.csv_path_failing_element_counts">[docs]</a>
    <span class="nd">@fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">csv_path_failing_element_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp_path</span><span class="p">):</span>
        <span class="c1"># a temporary path to csv file for testing</span>
        <span class="c1"># it contains an commented line and two data lines with the same number</span>
        <span class="c1"># of elements</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="s2">&quot;hist_fail3.csv&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">test_file</span><span class="p">:</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;#0.0,1.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0.0,1.0,2.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;1.0,1.0,1.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="TestFunctions.csv_path_failing_element_types">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.csv_path_failing_element_types">[docs]</a>
    <span class="nd">@fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">csv_path_failing_element_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp_path</span><span class="p">):</span>
        <span class="c1"># a temporary path to csv file for testing</span>
        <span class="c1"># it contains 2 data lines, where the elements of the second one are</span>
        <span class="c1"># not interpretable as floats</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="s2">&quot;hist_fail4.csv&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">test_file</span><span class="p">:</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0.0,1.0,2.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Unit,Test</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="TestFunctions.csv_path_ex1">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.csv_path_ex1">[docs]</a>
    <span class="nd">@fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">csv_path_ex1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp_path</span><span class="p">):</span>
        <span class="c1"># a temporary path to csv file for testing</span>
        <span class="c1"># correct data with a comment line</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="s2">&quot;hist.csv&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">test_file</span><span class="p">:</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;#0.1,1.1</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0.1,1.1,2.1</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;1.0,1.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span></div>


<div class="viewcode-block" id="TestFunctions.csv_path_ex2">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.csv_path_ex2">[docs]</a>
    <span class="nd">@fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">csv_path_ex2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp_path</span><span class="p">):</span>
        <span class="c1"># a temporary path to csv file for testing</span>
        <span class="c1"># correct data with an empty line</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="s2">&quot;hist2.csv&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">test_file</span><span class="p">:</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;0.2,1.2,2.2</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">test_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;2.0,2.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span></div>


    <span class="c1"># test functions</span>
<div class="viewcode-block" id="TestFunctions.test_is_number">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_is_number">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_is_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional argument&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">is_number</span><span class="p">()</span>
        <span class="c1"># try a string of a float</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">is_number</span><span class="p">(</span><span class="s2">&quot;1.2e-3&quot;</span><span class="p">)</span>
        <span class="c1"># try a non-float string</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">is_number</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="TestFunctions.test_stefan_boltzmann_law">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_stefan_boltzmann_law">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_stefan_boltzmann_law</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 2 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;L&#39; and &#39;R&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">stefan_boltzmann_law</span><span class="p">()</span>
        <span class="c1"># examples</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">5.77603658298e+3</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-9</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">6.86890380099e+3</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-9</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">4.08427463621e+3</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-9</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">stefan_boltzmann_law</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="o">==</span> <span class="n">T</span></div>


<div class="viewcode-block" id="TestFunctions.test_rzams">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_rzams">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_rzams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;m&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rzams</span><span class="p">()</span>
        <span class="c1"># examples</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.88824945030</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.61021038543</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">rzams</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">rzams</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.85822941705</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">rzams</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Zsun</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.84963691291</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestFunctions.test_roche_lobe_radius">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_roche_lobe_radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_roche_lobe_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capsys</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 2 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;m1&#39; and &#39;m2&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">])]:</span>
            <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">EvolutionWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Trying to compute RL radius &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;for binary with invalid &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;separation&quot;</span><span class="p">):</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">a_orb</span><span class="o">=</span><span class="n">a</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])]:</span>
            <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">EvolutionWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Trying to compute RL radius &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;for nonexistent object&quot;</span><span class="p">):</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])]:</span>
            <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">EvolutionWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Trying to compute RL radius &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;for nonexistent companion&quot;</span><span class="p">):</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
        <span class="c1"># examples</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.37892051838</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.44000423753</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.32078812033</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.75784103676</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">a_orb</span><span class="o">=</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span>
        <span class="n">m1s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m1</span> <span class="k">for</span> <span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">])</span>
        <span class="n">m2s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m2</span> <span class="k">for</span> <span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">])</span>
        <span class="n">a_orbs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">])</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">(</span><span class="n">m1s</span><span class="p">,</span> <span class="n">m2s</span><span class="p">,</span> <span class="n">a_orb</span><span class="o">=</span><span class="n">a_orbs</span><span class="p">),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">expected</span> <span class="k">for</span> <span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">]))</span>
        <span class="c1"># check that roche lobe sum never exceeds orbital separation</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0e+1</span><span class="p">,</span> <span class="mf">1.0e+2</span><span class="p">,</span> <span class="mf">1.0e+3</span><span class="p">,</span> <span class="mf">1.0e+4</span><span class="p">,</span> <span class="mf">1.0e+5</span><span class="p">,</span> <span class="mf">1.0e+6</span><span class="p">,</span> <span class="mf">1.0e+7</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>\
                   <span class="o">+</span> <span class="n">totest</span><span class="o">.</span><span class="n">roche_lobe_radius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0</span></div>


<div class="viewcode-block" id="TestFunctions.test_orbital_separation_from_period">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_orbital_separation_from_period">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_orbital_separation_from_period</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 3 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;period_days&#39;, &#39;m1_solar&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;and &#39;m2_solar&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">orbital_separation_from_period</span><span class="p">()</span>
        <span class="c1"># examples</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">14.9643417735</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-11</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">23.7544118733</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-11</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">16.4703892879</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-11</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">17.7421890201</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-11</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">orbital_separation_from_period</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_orbital_period_from_separation">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_orbital_period_from_separation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_orbital_period_from_separation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 3 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;separation&#39;, &#39;m1&#39;, and &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;m2&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">orbital_period_from_separation</span><span class="p">()</span>
        <span class="c1"># examples</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.72773763511e-2</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-14</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">4.88677999159e-2</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-14</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.49626468308e-2</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-14</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.33829981748e-2</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-14</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">orbital_period_from_separation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_eddington_limit">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_eddington_limit">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_eddington_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;binary&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">eddington_limit</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Eddington limit is being calculated &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;for a non-CO&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">eddington_limit</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;index 2 is out of bounds&quot;</span><span class="p">):</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;WD&#39;</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">eddington_limit</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># examples: 1Msun accretor is star1</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;WD&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">4.01681147088e-17</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-29</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">6.40623627946e+7</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-5</span><span class="p">))),</span>\
                 <span class="p">(</span><span class="s1">&#39;NS&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">2.17747384546e-8</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-20</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">0.11817658993</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">))),</span>\
                 <span class="p">(</span><span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">4.49942509871e-8</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-20</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">5.71909584179e-2</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-14</span><span class="p">)))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">CO</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">CO</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">eddington_limit</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># examples: 1.2Msun accretor is star2, while donor has X_surf=0.1</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">1.2</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;WD&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">5.89502616630e-17</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-29</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">8.16917025429e+7</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-5</span><span class="p">))),</span>\
                 <span class="p">(</span><span class="s1">&#39;NS&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">3.39586943808e-8</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-20</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">0.14181190792</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">))),</span>\
                 <span class="p">(</span><span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">8.42046955292e-8</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-20</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">5.71909584179e-2</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-14</span><span class="p">)))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">CO</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">CO</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">surface_h1</span> <span class="o">=</span> <span class="mf">0.1</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">eddington_limit</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span>
        <span class="c1"># examples: 1.3Msun accretor is star1 with history</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;BH&#39;</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">mass_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">])</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s1">&#39;COtype must be &quot;BH&quot;, &quot;NS&quot;, or &quot;WD&quot;&#39;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">eddington_limit</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;WD&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">3.68044499210e-17</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-29</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">9.08923688740e+7</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-5</span><span class="p">))),</span>\
                 <span class="p">(</span><span class="s1">&#39;NS&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">2.17747384546e-8</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-20</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">0.15362956691</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">))),</span>\
                 <span class="p">(</span><span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">5.84925262833e-8</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-20</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">5.71909584179e-2</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-14</span><span class="p">)))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">CO</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="n">CO</span><span class="p">])</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">eddington_limit</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_beaming">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_beaming">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_beaming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;binary&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">beaming</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Eddington limit is being calculated &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;for a non-CO&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">beaming</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
        <span class="c1"># examples: 1Msun accretor is star1 with no mass-transfer rate</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;WD&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;NS&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">CO</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">CO</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">beaming</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span>
        <span class="c1"># examples: 1.2Msun accretor is star1</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">1.2</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">lg_mtransfer_rate</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.5</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;WD&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">7.80787388850</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">),</span>\
                         <span class="n">approx</span><span class="p">(</span><span class="mf">1.04303350643e-16</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-28</span><span class="p">))),</span>\
                 <span class="p">(</span><span class="s1">&#39;NS&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">2.98994840792e-8</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-20</span><span class="p">),</span> <span class="mi">1</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">approx</span><span class="p">(</span><span class="mf">3.16227766017e-8</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-20</span><span class="p">),</span> <span class="mi">1</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">CO</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">CO</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">beaming</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_bondi_hoyle">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_bondi_hoyle">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_bondi_hoyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_rand</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_rand2</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 3 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;binary&#39;, &#39;accretor&#39;, and &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;donor&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">RuntimeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Failed to converge after 100 &quot;</span>\
                                        <span class="o">+</span><span class="s2">&quot;iterations&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">separation</span> <span class="o">=</span> <span class="mf">1.0</span>            <span class="c1">#a semi-major axis of 1Rsun</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">eccentricity</span> <span class="o">=</span> <span class="mf">0.1</span>          <span class="c1">#a small eccentricity</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">1.1</span>           <span class="c1">#accretor&#39;s mass is 1.1Msun</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;WD&#39;</span>         <span class="c1">#accretor is WD</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">1.2</span>           <span class="c1">#donor&#39;s mass is 1.2Msun</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">lg_wind_mdot</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span> <span class="c1">#donor&#39;s wind is 10^{-10}Msun/yr</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">he_core_radius</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#donor&#39;s he-core rad. is 0.2Rsun</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">log_R</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>         <span class="c1">#donor&#39;s radius is 10^{-0.5}Rsun</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">surface_h1</span> <span class="o">=</span> <span class="mf">0.7</span>     <span class="c1">#donor&#39;s X_surf=0.7</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">log_L</span> <span class="o">=</span> <span class="mf">0.3</span>          <span class="c1">#donor&#39;s lum. is 10^{0.3}Lsun</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">UnboundLocalError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;cannot access local variable &quot;</span>\
                                             <span class="o">+</span><span class="s2">&quot;&#39;f_m&#39; where it is not &quot;</span>\
                                             <span class="o">+</span><span class="s2">&quot;associated with a value&quot;</span><span class="p">):</span>
            <span class="c1"># undefined scheme</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="p">,</span> <span class="s2">&quot;rand&quot;</span><span class="p">,</span> <span class="n">mock_rand</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">approx</span><span class="p">(</span><span class="mf">3.92668160462e-17</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-29</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">,</span>\
                                  <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Kudritzki+2000&#39;</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">approx</span><span class="p">(</span><span class="mf">3.92668160462e-17</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-29</span><span class="p">)</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">log_R</span> <span class="o">=</span> <span class="mf">1.5</span>          <span class="c1">#donor&#39;s radius is 10^{1.5}Rsun</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">,</span>\
                                  <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Kudritzki+2000&#39;</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">approx</span><span class="p">(</span><span class="mf">3.92668160462e-17</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-29</span><span class="p">)</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">log_R</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>         <span class="c1">#donor&#39;s radius is 10^{-1.5}Rsun</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">,</span>\
                                  <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Kudritzki+2000&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1e-99</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">surface_h1</span> <span class="o">=</span> <span class="mf">0.25</span>    <span class="c1">#donor&#39;s X_surf=0.25</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">)</span> <span class="o">==</span>\
               <span class="mf">1e-99</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">lg_wind_mdot</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.0</span>  <span class="c1">#donor&#39;s wind is 10^{-4}Msun/yr</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">)</span> <span class="o">==</span>\
               <span class="mf">1e-99</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">,</span>\
                                  <span class="n">wind_disk_criteria</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">approx</span><span class="p">(</span><span class="mf">5.34028698228e-17</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-29</span><span class="p">)</span> <span class="c1"># form always a disk</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="p">,</span> <span class="s2">&quot;rand&quot;</span><span class="p">,</span> <span class="n">mock_rand2</span><span class="p">)</span> <span class="c1"># other angle</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;BH&#39;</span>         <span class="c1">#accretor is BH</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">bondi_hoyle</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">,</span>\
                                  <span class="n">wind_disk_criteria</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">approx</span><span class="p">(</span><span class="mf">5.13970075150e-8</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-20</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestFunctions.test_rejection_sampler">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_rejection_sampler">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_rejection_sampler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="k">return</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;x and y PDF values must be specified&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot; if no PDF function is provided for&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot; rejection sampling&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;x and y PDF values must be specified&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot; if no PDF function is provided for&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot; rejection sampling&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;x and y PDF values must be specified&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot; if no PDF function is provided for&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot; rejection sampling&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>\
                                     <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]))</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;x and y PDF values must be specified&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot; if no PDF function is provided for&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot; rejection sampling&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">(</span><span class="n">x_lim</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;x_lim must be specified for passed PDF&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot; function in rejection sampling&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">(</span><span class="n">pdf</span><span class="o">=</span><span class="n">mock_pdf</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="p">,</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="n">mock_uniform</span><span class="p">)</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">totest</span><span class="p">,</span> <span class="s2">&quot;interp1d&quot;</span><span class="p">,</span> <span class="n">mock_interp1d</span><span class="p">)</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span>\
                  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])),</span>\
                 <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]),</span> <span class="mi">5</span><span class="p">,</span>\
                  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])),</span>\
                 <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]),</span> <span class="mi">6</span><span class="p">,</span>\
                  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">s</span><span class="p">),</span>\
                                  <span class="n">r</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">(</span><span class="n">x_lim</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span>\
                                                                       <span class="mf">1.0</span><span class="p">]),</span>\
                                                       <span class="n">pdf</span><span class="o">=</span><span class="n">mock_pdf</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>\
                              <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rejection_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>\
                                                       <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]),</span>\
                                                       <span class="n">x_lim</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span>\
                                                                       <span class="mf">1.0</span><span class="p">]),</span>\
                                                       <span class="n">pdf</span><span class="o">=</span><span class="n">mock_pdf</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>\
                              <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]))</span></div>


<div class="viewcode-block" id="TestFunctions.test_inverse_sampler">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_inverse_sampler">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_inverse_sampler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 2 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;x&#39; and &#39;y&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inverse_sampler</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;diff requires input that is at least &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;one dimensional&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inverse_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inverse_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>\
                                   <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]))</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inverse_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>\
                                   <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]))</span>
        <span class="c1"># examples:</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="p">,</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="n">mock_uniform</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">inverse_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>\
                                                  <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]),</span>\
                                                  <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.29128785</span><span class="p">,</span> <span class="mf">0.54950976</span><span class="p">,</span> <span class="mf">0.78388218</span><span class="p">,</span>\
                                     <span class="mf">1.0</span><span class="p">]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">inverse_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>\
                                                  <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]),</span>\
                                                  <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2919872</span><span class="p">,</span> <span class="mf">0.61952386</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="ne">RuntimeWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;invalid value encountered in &quot;</span>\
                                         <span class="o">+</span><span class="s2">&quot;divide&quot;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">inverse_sampler</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>\
                                                      <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]),</span>\
                                                      <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>\
                               <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span></div>


<div class="viewcode-block" id="TestFunctions.test_histogram_sampler">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_histogram_sampler">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_histogram_sampler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_choice</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">sample</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
                <span class="n">sample</span> <span class="o">+=</span> <span class="nb">round</span><span class="p">(</span><span class="n">size</span><span class="o">*</span><span class="n">q</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
                <span class="n">sample</span> <span class="o">+=</span> <span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span> <span class="o">*</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sample</span><span class="p">[:</span><span class="n">size</span><span class="p">])</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 2 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;x_edges&#39; and &#39;y&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">histogram_sampler</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;&gt;=&#39; not supported between instances &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;of &#39;NoneType&#39; and &#39;float&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">histogram_sampler</span><span class="p">(</span><span class="n">x_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">histogram_sampler</span><span class="p">(</span><span class="n">x_edges</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>\
                                     <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]))</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">histogram_sampler</span><span class="p">(</span><span class="n">x_edges</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>\
                                     <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]))</span>
        <span class="c1"># examples:</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="p">,</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="n">mock_uniform</span><span class="p">)</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="p">,</span> <span class="s2">&quot;choice&quot;</span><span class="p">,</span> <span class="n">mock_choice</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">histogram_sampler</span><span class="p">(</span><span class="n">x_edges</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span>\
                                                                      <span class="mf">0.5</span><span class="p">,</span>\
                                                                      <span class="mf">1.0</span><span class="p">]),</span>\
                                                    <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]),</span>\
                                                    <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.66666667</span><span class="p">,</span> <span class="mf">0.83333333</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">histogram_sampler</span><span class="p">(</span><span class="n">x_edges</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span>\
                                                                         <span class="mf">0.5</span><span class="p">,</span>\
                                                                         <span class="mf">1.0</span><span class="p">]</span>\
                                                       <span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span>\
                                                                      <span class="mf">0.8</span><span class="p">]),</span>\
                                                       <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>\
                              <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span></div>


<div class="viewcode-block" id="TestFunctions.test_read_histogram_from_file">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_read_histogram_from_file">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_read_histogram_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csv_path_failing_3_data_lines</span><span class="p">,</span>\
                                      <span class="n">csv_path_failing_empty_line</span><span class="p">,</span>\
                                      <span class="n">csv_path_failing_element_counts</span><span class="p">,</span>\
                                      <span class="n">csv_path_failing_element_types</span><span class="p">,</span>\
                                      <span class="n">csv_path_ex1</span><span class="p">,</span> <span class="n">csv_path_ex2</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;path&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">read_histogram_from_file</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;expected str, bytes or os.PathLike &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;object, not NoneType&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">read_histogram_from_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;More than two lines found in the &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;histogram document.&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">read_histogram_from_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">csv_path_failing_3_data_lines</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Less than two lines found in the &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;histogram document.&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">read_histogram_from_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">csv_path_failing_empty_line</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;The number of elements in the second &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;data line is not one less than the &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;number in the first data line.&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">read_histogram_from_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span>\
                                            <span class="n">csv_path_failing_element_counts</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;The number of elements in the second &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;data line is not one less than the &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;number in the first data line.&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">read_histogram_from_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">csv_path_failing_element_types</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">arrays</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">read_histogram_from_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">csv_path_ex1</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
        <span class="n">arrays</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">read_histogram_from_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">csv_path_ex2</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]))</span></div>


<div class="viewcode-block" id="TestFunctions.test_inspiral_timescale_from_separation">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_inspiral_timescale_from_separation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_inspiral_timescale_from_separation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 4 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;star1_mass&#39;, &#39;star2_mass&#39;,&quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot; &#39;separation&#39;, and &#39;eccentricity&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_separation</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_separation</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unsupported operand type(s) for &quot;</span>\
                                           <span class="o">+</span> <span class="s2">&quot;*: &#39;NoneType&#39; and &#39;float&#39;&quot;</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Mass of star 1 is &lt;= 0, which is not &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;a physical value.&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_separation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Mass of star 2 is &lt;= 0, which is not &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;a physical value.&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_separation</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Separation is &lt;= 0, which is not a &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;physical value.&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_separation</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Eccentricity is &lt; 0, which is not a &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;physical value.&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_separation</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Eccentricity is &gt;= 1, which is not a &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;physical value.&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_separation</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">13.44121924697</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span> <span class="mf">2.24020320783</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span> <span class="mf">2.24020320783</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span> <span class="mf">1.08873875900e+3</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-9</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">37.56647511040</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0e-5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">37.56647487803</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="mf">1.0e-5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">2.41297178064e-15</span><span class="p">,</span>\
                                                    <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-27</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_separation</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_inspiral_timescale_from_orbital_period">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_inspiral_timescale_from_orbital_period">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_inspiral_timescale_from_orbital_period</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 4 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;star1_mass&#39;, &#39;star2_mass&#39;,&quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot; &#39;orbital_period&#39;, and &#39;eccentricity&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_orbital_period</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_orbital_period</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unsupported operand type(s) for &quot;</span>\
                                           <span class="o">+</span> <span class="s2">&quot;*: &#39;NoneType&#39; and &#39;float&#39;&quot;</span>
<span class="c1">#        with raises(ValueError, match=&quot;Mass of star 1 is &lt;= 0, which is not &quot;\</span>
<span class="c1">#                                      +&quot;a physical value.&quot;):</span>
<span class="c1">#            totest.inspiral_timescale_from_orbital_period(0.0, 0.5, 0.5, 0.5)</span>
<span class="c1">#        with raises(ValueError, match=&quot;Mass of star 2 is &lt;= 0, which is not &quot;\</span>
<span class="c1">#                                      +&quot;a physical value.&quot;):</span>
<span class="c1">#            totest.inspiral_timescale_from_orbital_period(0.5, 0.0, 0.5, 0.5)</span>
<span class="c1">#        with raises(ValueError, match=&quot;Separation is &lt;= 0, which is not a &quot;\</span>
<span class="c1">#                                      +&quot;physical value.&quot;):</span>
<span class="c1">#            totest.inspiral_timescale_from_orbital_period(0.5, 0.5, 0.0, 0.5)</span>
<span class="c1">#        with raises(ValueError, match=&quot;Eccentricity is &lt; 0, which is not a &quot;\</span>
<span class="c1">#                                      +&quot;physical value.&quot;):</span>
<span class="c1">#            totest.inspiral_timescale_from_orbital_period(0.5, 0.5, 0.5, -0.5)</span>
<span class="c1">#        with raises(ValueError, match=&quot;Eccentricity is &gt;= 1, which is not a &quot;\</span>
<span class="c1">#                                      +&quot;physical value.&quot;):</span>
<span class="c1">#            totest.inspiral_timescale_from_orbital_period(0.5, 0.5, 0.5, 1.5)</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.06110684309e+4</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-8</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">4.45636949266e+3</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-9</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">4.45636949266e+3</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-9</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.98647206096e+5</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-7</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">2.96565684095e+4</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-8</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0e-5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">2.96565682261e+4</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-8</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="mf">1.0e-5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.90490224255e-12</span><span class="p">,</span>\
                                                    <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-24</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">inspiral_timescale_from_orbital_period</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>\
                   <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_spin_stable_mass_transfer">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_spin_stable_mass_transfer">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_spin_stable_mass_transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 3 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;spin_i&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;star_mass_preMT&#39;, and &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;star_mass_postMT&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">spin_stable_mass_transfer</span><span class="p">()</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">mf</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">spin_stable_mass_transfer</span><span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">mf</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">spin_stable_mass_transfer</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">approx</span><span class="p">(</span><span class="mf">0.69217452285</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">spin_stable_mass_transfer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">spin_stable_mass_transfer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0</span></div>


<div class="viewcode-block" id="TestFunctions.test_check_state_of_star">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_check_state_of_star">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_check_state_of_star</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;star&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;mass&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star</span><span class="p">(</span><span class="n">star</span><span class="p">)</span> <span class="o">==</span>\
               <span class="s2">&quot;undetermined_evolutionary_state&quot;</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span>\
               <span class="s2">&quot;undetermined_evolutionary_state&quot;</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;WD&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;NS&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">CO</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">star</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">m</span>
            <span class="n">star</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">CO</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">star_CO</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">star</span><span class="o">.</span><span class="n">state</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tests</span><span class="p">)</span>
        <span class="n">star</span><span class="o">.</span><span class="n">mass_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">mass_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">surface_h1_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">surface_h1_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">center_h1_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">center_h1_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">center_he4_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">center_he4_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">center_c12_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">center_c12_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">log_LH_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">log_LH_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">log_LHe_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">log_LHe_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">log_Lnuc_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">log_Lnuc_history</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span>\
                   <span class="s2">&quot;undetermined_evolutionary_state&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">star</span><span class="o">.</span><span class="n">mass_history</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tests</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">star</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;BH&#39;</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">star_CO</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span>\
                   <span class="n">totest</span><span class="o">.</span><span class="n">infer_star_state</span><span class="p">(</span><span class="n">star_mass</span><span class="o">=</span><span class="n">tests</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">star_CO</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">star</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;WD&#39;</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">star_CO</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;WD&#39;</span></div>


<div class="viewcode-block" id="TestFunctions.test_check_state_of_star_history_array">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_check_state_of_star_history_array">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_check_state_of_star_history_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;star&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star_history_array</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;bad operand type for unary -: &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;NoneType&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star_history_array</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;list index out of range&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star_history_array</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star_history_array</span><span class="p">(</span><span class="n">star</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">[</span><span class="s2">&quot;undetermined_evolutionary_state&quot;</span><span class="p">]</span>
        <span class="n">masses</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">masses</span><span class="p">)</span>
        <span class="n">star</span><span class="o">.</span><span class="n">mass_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">mass_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">surface_h1_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">surface_h1_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">center_h1_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">center_h1_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">center_he4_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">center_he4_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">center_c12_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">center_c12_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">log_LH_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">log_LH_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">log_LHe_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">log_LHe_history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">log_Lnuc_history</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">log_Lnuc_history</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star_history_array</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span>\
                   <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="s2">&quot;undetermined_evolutionary_state&quot;</span><span class="p">]</span>
        <span class="n">COs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">masses</span><span class="p">):</span>
            <span class="n">star</span><span class="o">.</span><span class="n">mass_history</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span>
            <span class="n">COs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">infer_star_state</span><span class="p">(</span><span class="n">star_mass</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">star_CO</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">star</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;BH&#39;</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star_history_array</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>\
                   <span class="n">star_CO</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">COs</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">star</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;WD&#39;</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">check_state_of_star_history_array</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>\
                   <span class="n">star_CO</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;WD&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="TestFunctions.test_get_binary_state_and_event_and_mt_case">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_get_binary_state_and_event_and_mt_case">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_infer_mass_transfer_case</span><span class="p">(</span><span class="n">rl_relative_overflow</span><span class="p">,</span>\
                                          <span class="n">lg_mtransfer_rate</span><span class="p">,</span> <span class="n">donor_state</span><span class="p">,</span>\
                                          <span class="n">dominating_star</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">rl_relative_overflow</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rl_relative_overflow</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;binary&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;argument of type &#39;NoneType&#39; is not &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;iterable&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
        <span class="c1"># examples: no binary</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># examples: not converged</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
               <span class="n">interpolation_class</span><span class="o">=</span><span class="s1">&#39;not_converged&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># examples: initial MT</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
               <span class="n">interpolation_class</span><span class="o">=</span><span class="s1">&#39;initial_MT&#39;</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">[</span><span class="s1">&#39;initial_RLOF&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># examples: detached</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;test_state&quot;</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;test_state&quot;</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">[</span><span class="s1">&#39;detached&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state_history</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;test_state&quot;</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">state_history</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;test_state&quot;</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">[</span><span class="s1">&#39;detached&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;list index out of range&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># examples: mass transfer</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">totest</span><span class="p">,</span> <span class="s2">&quot;infer_mass_transfer_case&quot;</span><span class="p">,</span>\
                            <span class="n">mock_infer_mass_transfer_case</span><span class="p">)</span>
        <span class="c1">## donor is star 1</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">rl_relative_overflow_1</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;unstable_MT&#39;</span><span class="p">,</span> <span class="s1">&#39;oCE1&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">IC</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
                   <span class="n">interpolation_class</span><span class="o">=</span><span class="n">IC</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;RLO1&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="s1">&#39;case_A1&#39;</span><span class="p">]</span>
        <span class="c1">## both stars overfill RL leading to double CE initiated by star 1</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">rl_relative_overflow_2</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;unstable_MT&#39;</span><span class="p">,</span> <span class="s1">&#39;oDoubleCE1&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">IC</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
                   <span class="n">interpolation_class</span><span class="o">=</span><span class="n">IC</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;contact&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1">## classical CE initiated by star 1</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;BH&quot;</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
               <span class="n">interpolation_class</span><span class="o">=</span><span class="s1">&#39;unstable_MT&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;contact&#39;</span><span class="p">,</span> <span class="s1">&#39;oCE1&#39;</span><span class="p">,</span>\
                                                      <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;test_state&quot;</span>
        <span class="c1">## both stars overfill RL leading to double CE initiated by star 2</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">rl_relative_overflow_2</span> <span class="o">=</span> <span class="mf">2.0</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;unstable_MT&#39;</span><span class="p">,</span> <span class="s1">&#39;oDoubleCE2&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">IC</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
                   <span class="n">interpolation_class</span><span class="o">=</span><span class="n">IC</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;contact&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1">## classical CE initiated by star 2</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;BH&quot;</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
               <span class="n">interpolation_class</span><span class="o">=</span><span class="s1">&#39;unstable_MT&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;contact&#39;</span><span class="p">,</span> <span class="s1">&#39;oCE2&#39;</span><span class="p">,</span>\
                                                      <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;test_state&quot;</span>
        <span class="c1">## donor is star 2</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">rl_relative_overflow_1</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;unstable_MT&#39;</span><span class="p">,</span> <span class="s1">&#39;oCE2&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">IC</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
                   <span class="n">interpolation_class</span><span class="o">=</span><span class="n">IC</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;RLO2&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="s1">&#39;case_A2&#39;</span><span class="p">]</span>
        <span class="c1"># examples: undefined</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">rl_relative_overflow_2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">[</span><span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># examples: star 2 becomes WD</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">center_gamma</span> <span class="o">=</span> <span class="mf">10.0</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">[</span><span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="s1">&#39;CC2&#39;</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># examples: star 1 becomes WD</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">center_gamma</span> <span class="o">=</span> <span class="mf">10.0</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">[</span><span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="s1">&#39;CC1&#39;</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># examples: no center_gamma_history</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">center_gamma_history</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">center_gamma_history</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">[</span><span class="s1">&#39;detached&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># both stars overfill RL leading to double CE while WD condition is</span>
        <span class="c1"># fulfilled as well</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;oDoubleCE1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;oDoubleCE2&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">ro1</span><span class="p">,</span> <span class="n">ro2</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">rl_relative_overflow_1</span> <span class="o">=</span> <span class="n">ro1</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">rl_relative_overflow_2</span> <span class="o">=</span> <span class="n">ro2</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
                   <span class="n">interpolation_class</span><span class="o">=</span><span class="s1">&#39;unstable_MT&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;contact&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># stable contact leading to WD formation</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
               <span class="n">interpolation_class</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;contact&#39;</span><span class="p">,</span> <span class="s1">&#39;CC1&#39;</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="TestFunctions.test_get_binary_state_and_event_and_mt_case_array">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_get_binary_state_and_event_and_mt_case_array">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_get_binary_state_and_event_and_mt_case_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary</span><span class="p">,</span>\
                                                          <span class="n">monkeypatch</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
            <span class="n">interpolation_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Unit&#39;</span><span class="p">,</span> <span class="s1">&#39;Test&#39;</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;binary&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case_array</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;argument of type &#39;NoneType&#39; is not &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;iterable&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case_array</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;list index out of range&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case_array</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="c1"># examples: no binary</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case_array</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">)</span>
        <span class="c1"># examples: detached</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;test_state&quot;</span>
        <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;test_state&quot;</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case_array</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">(</span><span class="s1">&#39;detached&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;None&#39;</span><span class="p">)</span>
        <span class="c1"># examples: several mocked entries</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">totest</span><span class="p">,</span> <span class="s2">&quot;get_binary_state_and_event_and_mt_case&quot;</span><span class="p">,</span>\
                            <span class="n">mock_get_binary_state_and_event_and_mt_case</span><span class="p">)</span>
        <span class="n">mock_return</span> <span class="o">=</span> <span class="n">mock_get_binary_state_and_event_and_mt_case</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case_array</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
                                                                       <span class="n">N</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span>\
                   <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="p">[</span><span class="n">mock_return</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">i</span><span class="o">*</span><span class="p">[</span><span class="n">mock_return</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">i</span><span class="o">*</span><span class="p">[</span><span class="n">mock_return</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_binary_state_and_event_and_mt_case_array</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span>\
                                                                   <span class="n">N</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span>\
               <span class="p">([],</span> <span class="p">[],</span> <span class="p">[])</span></div>


<div class="viewcode-block" id="TestFunctions.test_CO_radius">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_CO_radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_CO_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 2 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;M&#39; and &#39;COtype&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">CO_radius</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Compact object mass must be a &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;positive value&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">CO_radius</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;BH&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;COtype not in the list of valid &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;options&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">CO_radius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;TEST&#39;</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;WD&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">5.24982189818e-3</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-15</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="s1">&#39;WD&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">4.16678640191e-3</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-15</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="s1">&#39;NS&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.79602862151e-5</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-17</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="s1">&#39;NS&#39;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.79602862151e-5</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-17</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">Schwarzschild_Radius</span><span class="p">(</span><span class="mf">7.0</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">Schwarzschild_Radius</span><span class="p">(</span><span class="mf">9.0</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">CO</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">CO_radius</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">CO</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_He_MS_lifetime">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_He_MS_lifetime">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_He_MS_lifetime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;mass&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">He_MS_lifetime</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;&lt;=&#39; not supported between instances &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;of &#39;NoneType&#39; and &#39;float&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">He_MS_lifetime</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Too low mass: 0.0&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">He_MS_lifetime</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0e+8</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">3.47136114375e+7</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-5</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">6.95883527992e+5</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-7</span><span class="p">)),</span> <span class="p">(</span><span class="mf">300.0</span><span class="p">,</span> <span class="mf">3.0e+5</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">He_MS_lifetime</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="n">t</span></div>


<div class="viewcode-block" id="TestFunctions.test_Schwarzschild_Radius">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_Schwarzschild_Radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_Schwarzschild_Radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;M&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">Schwarzschild_Radius</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">Schwarzschild_Radius</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unsupported operand type(s) for &quot;</span>\
                                           <span class="o">+</span> <span class="s2">&quot;*: &#39;float&#39; and &#39;NoneType&#39;&quot;</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">2.97147953078e-5</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-17</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">2.97147953078e-4</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-16</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">Schwarzschild_Radius</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_flip_stars">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_flip_stars">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_flip_stars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;binary&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">flip_stars</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;star_1&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">flip_stars</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># examples: set stars and check swap</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">totest</span><span class="o">.</span><span class="n">flip_stars</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">star_1</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">binary</span><span class="o">.</span><span class="n">star_2</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="c1"># examples: binary states</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;RLO1&#39;</span><span class="p">,</span> <span class="s1">&#39;RLO2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;RLO2&#39;</span><span class="p">,</span> <span class="s1">&#39;RLO1&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">s</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">state_history</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">flip_stars</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">binary</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">n</span>
            <span class="k">assert</span> <span class="n">binary</span><span class="o">.</span><span class="n">state_history</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">n</span>
        <span class="c1"># examples: binary events</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;oRLO1&#39;</span><span class="p">,</span> <span class="s1">&#39;oRLO2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;oRLO2&#39;</span><span class="p">,</span> <span class="s1">&#39;oRLO1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;oCE1&#39;</span><span class="p">,</span> <span class="s1">&#39;oCE2&#39;</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s1">&#39;oCE2&#39;</span><span class="p">,</span> <span class="s1">&#39;oCE1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CC1&#39;</span><span class="p">,</span> <span class="s1">&#39;CC2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;CC2&#39;</span><span class="p">,</span> <span class="s1">&#39;CC1&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">event</span> <span class="o">=</span> <span class="n">e</span>
            <span class="n">binary</span><span class="o">.</span><span class="n">event_history</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">flip_stars</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">binary</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="n">n</span>
            <span class="k">assert</span> <span class="n">binary</span><span class="o">.</span><span class="n">event_history</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">n</span>
        <span class="c1"># examples: set binary values and check swap</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">binary</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">totest</span><span class="o">.</span><span class="n">flip_stars</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">binary</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="TestFunctions.test_set_binary_to_failed">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_set_binary_to_failed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_set_binary_to_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;binary&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">set_binary_to_failed</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;state&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">set_binary_to_failed</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">totest</span><span class="o">.</span><span class="n">set_binary_to_failed</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">binary</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;ERR&quot;</span>
        <span class="k">assert</span> <span class="n">binary</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s2">&quot;FAILED&quot;</span></div>


<div class="viewcode-block" id="TestFunctions.test_infer_star_state">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_infer_star_state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_infer_star_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># examples: undetermined</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_star_state</span><span class="p">()</span> <span class="o">==</span> <span class="n">totest</span><span class="o">.</span><span class="n">STATE_UNDETERMINED</span>
        <span class="c1"># examples: compact objects</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;massless_remnant&quot;</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;massless_remnant&quot;</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;massless_remnant&quot;</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">STATE_NS_STARMASS_LOWER_LIMIT</span><span class="p">,</span>\
                          <span class="n">totest</span><span class="o">.</span><span class="n">STATE_WD_STARMASS_UPPER_LIMIT</span><span class="p">),</span> <span class="s2">&quot;WD&quot;</span><span class="p">),</span>\
                 <span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">STATE_NS_STARMASS_LOWER_LIMIT</span><span class="p">,</span> <span class="s2">&quot;NS&quot;</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">STATE_NS_STARMASS_LOWER_LIMIT</span>
                       <span class="o">+</span><span class="n">totest</span><span class="o">.</span><span class="n">STATE_NS_STARMASS_UPPER_LIMIT</span><span class="p">),</span> <span class="s2">&quot;NS&quot;</span><span class="p">),</span>\
                 <span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">STATE_NS_STARMASS_UPPER_LIMIT</span><span class="p">,</span> <span class="s2">&quot;NS&quot;</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">totest</span><span class="o">.</span><span class="n">STATE_NS_STARMASS_UPPER_LIMIT</span><span class="p">,</span> <span class="s2">&quot;BH&quot;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">CO</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_star_state</span><span class="p">(</span><span class="n">star_mass</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">star_CO</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">CO</span>
        <span class="c1"># examples: WDs</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">STATE_WD_STARMASS_UPPER_LIMIT</span>
        <span class="k">for</span> <span class="n">sH1</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">cH1</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">cHe4</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">cC12</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="p">(((</span><span class="n">sH1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sH1</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">))</span> <span class="ow">and</span>\
                            <span class="p">((</span><span class="n">cH1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cH1</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">))</span> <span class="ow">and</span>
                            <span class="p">((</span><span class="n">cHe4</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cHe4</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">))</span> <span class="ow">and</span>
                            <span class="p">((</span><span class="n">cC12</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cC12</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">))):</span>
                            <span class="n">CO</span> <span class="o">=</span> <span class="s2">&quot;NS&quot;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">CO</span> <span class="o">=</span> <span class="s2">&quot;WD&quot;</span>
                        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_star_state</span><span class="p">(</span><span class="n">star_mass</span><span class="o">=</span><span class="n">m</span><span class="p">,</span>\
                                                       <span class="n">surface_h1</span><span class="o">=</span><span class="n">sH1</span><span class="p">,</span>\
                                                       <span class="n">center_h1</span><span class="o">=</span><span class="n">cH1</span><span class="p">,</span>\
                                                       <span class="n">center_he4</span><span class="o">=</span><span class="n">cHe4</span><span class="p">,</span>\
                                                       <span class="n">center_c12</span><span class="o">=</span><span class="n">cC12</span><span class="p">,</span>\
                                                       <span class="n">star_CO</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">CO</span>
        <span class="c1"># examples: loop over all cases</span>
        <span class="n">THNA</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">THRESHOLD_HE_NAKED_ABUNDANCE</span>
        <span class="n">TCA</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">THRESHOLD_CENTRAL_ABUNDANCE</span>
        <span class="n">LBT</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">LOG10_BURNING_THRESHOLD</span>
        <span class="k">for</span> <span class="n">sH1</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">*</span><span class="n">THNA</span><span class="p">,</span> <span class="n">THNA</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">THNA</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">cH1</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">*</span><span class="n">TCA</span><span class="p">,</span> <span class="n">TCA</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">TCA</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">cHe4</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">*</span><span class="n">TCA</span><span class="p">,</span> <span class="n">TCA</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">TCA</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">cC12</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">*</span><span class="n">TCA</span><span class="p">,</span> <span class="n">TCA</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">TCA</span><span class="p">]:</span>
                        <span class="k">for</span> <span class="n">lgLH</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">*</span><span class="n">LBT</span><span class="p">,</span> <span class="n">LBT</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">LBT</span><span class="p">]:</span>
                            <span class="k">for</span> <span class="n">lgLHe</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">*</span><span class="n">LBT</span><span class="p">,</span> <span class="n">LBT</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">LBT</span><span class="p">]:</span>
                                <span class="k">if</span> <span class="n">sH1</span> <span class="o">&gt;</span> <span class="n">THNA</span><span class="p">:</span>
                                    <span class="n">rich</span> <span class="o">=</span> <span class="s2">&quot;H-rich&quot;</span>
                                <span class="k">elif</span> <span class="n">sH1</span> <span class="o">&lt;</span> <span class="n">cH1</span><span class="p">:</span>
                                    <span class="n">rich</span> <span class="o">=</span> <span class="s2">&quot;accreted_He&quot;</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">rich</span> <span class="o">=</span> <span class="s2">&quot;stripped_He&quot;</span>
                                <span class="k">if</span> <span class="p">((</span><span class="n">cH1</span><span class="o">&lt;=</span><span class="n">TCA</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cHe4</span><span class="o">&lt;=</span><span class="n">TCA</span><span class="p">)</span> <span class="ow">and</span>\
                                    <span class="p">(</span><span class="n">cC12</span><span class="o">&lt;=</span><span class="n">TCA</span><span class="p">)):</span>
                                    <span class="n">burn</span> <span class="o">=</span> <span class="s2">&quot;Central_C_depletion&quot;</span>
                                <span class="k">elif</span> <span class="p">((</span><span class="n">cH1</span><span class="o">&lt;=</span><span class="n">TCA</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cHe4</span><span class="o">&lt;=</span><span class="n">TCA</span><span class="p">)</span> <span class="ow">and</span>\
                                      <span class="p">(</span><span class="n">cC12</span><span class="o">&gt;</span><span class="n">TCA</span><span class="p">)):</span>
                                    <span class="n">burn</span> <span class="o">=</span> <span class="s2">&quot;Central_He_depleted&quot;</span>
                                <span class="k">elif</span> <span class="p">((</span><span class="n">cH1</span><span class="o">&gt;</span><span class="n">TCA</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">lgLH</span><span class="o">&gt;</span><span class="n">LBT</span><span class="p">)):</span>
                                    <span class="n">burn</span> <span class="o">=</span> <span class="s2">&quot;Core_H_burning&quot;</span>
                                <span class="k">elif</span> <span class="p">((</span><span class="n">cH1</span><span class="o">&gt;</span><span class="n">TCA</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">lgLH</span><span class="o">&lt;=</span><span class="n">LBT</span><span class="p">)):</span>
                                    <span class="n">burn</span> <span class="o">=</span> <span class="s2">&quot;non_burning&quot;</span>
                                <span class="k">elif</span> <span class="n">lgLHe</span> <span class="o">&gt;</span> <span class="n">LBT</span><span class="p">:</span>
                                    <span class="n">burn</span> <span class="o">=</span> <span class="s2">&quot;Core_He_burning&quot;</span>
                                <span class="k">elif</span> <span class="n">lgLH</span> <span class="o">&gt;</span> <span class="n">LBT</span><span class="p">:</span>
                                    <span class="n">burn</span> <span class="o">=</span> <span class="s2">&quot;Shell_H_burning&quot;</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">burn</span> <span class="o">=</span> <span class="s2">&quot;non_burning&quot;</span>
                                <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_star_state</span><span class="p">(</span><span class="n">surface_h1</span><span class="o">=</span><span class="n">sH1</span><span class="p">,</span>\
                                                               <span class="n">center_h1</span><span class="o">=</span><span class="n">cH1</span><span class="p">,</span>\
                                                               <span class="n">center_he4</span><span class="o">=</span>\
                                                               <span class="n">cHe4</span><span class="p">,</span>\
                                                               <span class="n">center_c12</span><span class="o">=</span>\
                                                               <span class="n">cC12</span><span class="p">,</span>\
                                                               <span class="n">log_LH</span><span class="o">=</span><span class="n">lgLH</span><span class="p">,</span>\
                                                               <span class="n">log_LHe</span><span class="o">=</span><span class="n">lgLHe</span><span class="p">,</span>\
                                                               <span class="n">log_Lnuc</span><span class="o">=</span><span class="n">lgLH</span>\
                                                                        <span class="o">+</span><span class="n">lgLHe</span>\
                                                              <span class="p">)</span> <span class="o">==</span> <span class="n">rich</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span>\
                                                                   <span class="o">+</span> <span class="n">burn</span></div>


<div class="viewcode-block" id="TestFunctions.test_infer_mass_transfer_case">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_infer_mass_transfer_case">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_infer_mass_transfer_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capsys</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 3 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;rl_relative_overflow&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;lg_mtransfer_rate&#39;, and &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;donor_state&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">()</span>
        <span class="c1"># examples: no RLO</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span>
        <span class="n">RROT</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">RL_RELATIVE_OVERFLOW_THRESHOLD</span>
        <span class="n">LMRT</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">LG_MTRANSFER_RATE_THRESHOLD</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">RROT</span><span class="p">),</span> <span class="n">LMRT</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span>\
               <span class="o">==</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">RROT</span><span class="p">),</span> <span class="n">LMRT</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>\
               <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span>
        <span class="k">assert</span> <span class="s2">&quot;checking rl_relative_overflow / lg_mtransfer_rate&quot;</span> <span class="ow">in</span>\
               <span class="n">capsys</span><span class="o">.</span><span class="n">readouterr</span><span class="p">()</span><span class="o">.</span><span class="n">out</span>
        <span class="c1"># examples: MT cases</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;test_non_burning&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NONBURNING</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;H-rich_Core_H_burning&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;H-rich_Core_He_burning&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;H-rich_Shell_H_burning&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;H-rich_Central_He_depleted&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_C</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;H-rich_Central_C_depletion&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_C</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;H-rich_undetermined&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;stripped_He_Core_He_burning&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BA</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;stripped_He_Central_He_depleted&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BB</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;stripped_He_Central_C_depletion&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_BB</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;stripped_He_undetermined&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;test_undetermined&quot;</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="n">RROT</span><span class="o">+</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">LMRT</span><span class="o">+</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="n">RROT</span><span class="o">+</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">LMRT</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="n">RROT</span><span class="o">+</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">LMRT</span><span class="o">+</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span>\
                                                   <span class="n">dominating_star</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="n">RROT</span><span class="o">+</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">LMRT</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span>\
                                                   <span class="n">dominating_star</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="n">RROT</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">LMRT</span><span class="o">+</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="n">RROT</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">LMRT</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>\
                   <span class="o">==</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="n">RROT</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">LMRT</span><span class="o">+</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span>\
                                                   <span class="n">dominating_star</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                   <span class="o">==</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">infer_mass_transfer_case</span><span class="p">(</span><span class="n">RROT</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">LMRT</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span>\
                                                   <span class="n">dominating_star</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                   <span class="o">==</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span></div>


<div class="viewcode-block" id="TestFunctions.test_cumulative_mass_transfer_numeric">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_cumulative_mass_transfer_numeric">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_cumulative_mass_transfer_numeric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;MT_cases&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;object of type &#39;NoneType&#39; has no len()&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># examples: no cases, undetermined, and no RLO</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[([],</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">]),</span>\
                 <span class="p">([</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">],</span>\
                  <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">]),</span>\
                 <span class="p">([</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">],</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">])]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">MT</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">(</span><span class="n">MT</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span>
        <span class="c1"># examples: cut out undetermined</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">],</span>\
                 <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">preA</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">preB</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">postB</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">preA</span> <span class="o">+</span> <span class="n">preB</span> <span class="o">+</span> <span class="n">postB</span> <span class="o">==</span> <span class="p">[]:</span> <span class="c1"># at least one undetermined</span>
                        <span class="k">continue</span>
                    <span class="n">mt</span> <span class="o">=</span> <span class="n">preA</span> <span class="o">+</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">]</span> <span class="o">+</span> <span class="n">preB</span> <span class="o">+</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">]</span>\
                         <span class="o">+</span> <span class="n">postB</span>
                    <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span> <span class="o">==</span>\
                           <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span>\
                           <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">]</span>
        <span class="c1"># examples: cut out no RLO</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">],</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">,</span>\
                  <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">preA</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">preB</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">postB</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
                    <span class="n">mt</span> <span class="o">=</span> <span class="n">preA</span> <span class="o">+</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">]</span> <span class="o">+</span> <span class="n">preB</span> <span class="o">+</span> <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">]</span>\
                         <span class="o">+</span> <span class="n">postB</span>
                    <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span> <span class="o">==</span>\
                           <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">]</span>
        <span class="c1"># examples: undetermined and no RLO</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">(</span>\
               <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">])</span> <span class="o">==</span>\
               <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">(</span>\
               <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">])</span> <span class="o">==</span>\
               <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">]</span>
        <span class="c1"># examples: cut out duplicates</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">mt</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">]</span>\
                 <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span> <span class="o">==</span>\
                   <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">]</span>
        <span class="c1"># examples: from strings</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_numeric</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;no_RLO&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>\
                                                        <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">])</span> <span class="o">==</span>\
               <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">,</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">]</span></div>


<div class="viewcode-block" id="TestFunctions.test_cumulative_mass_transfer_string">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_cumulative_mass_transfer_string">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_cumulative_mass_transfer_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;cumulative_integers&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_string</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;object of type &#39;NoneType&#39; has no len()&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_string</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">InappropriateValueWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Unknown MT case:&quot;</span><span class="p">):</span>
            <span class="c1"># unknown case</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_string</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># examples: no cases</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_string</span><span class="p">([])</span> <span class="o">==</span> <span class="s2">&quot;?&quot;</span>
        <span class="c1"># examples: undetermined</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_string</span><span class="p">(</span>\
               <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_UNDETERMINED</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;?&quot;</span>
        <span class="c1"># examples: no RLO</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_string</span><span class="p">(</span>\
               <span class="p">[</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_NO_RLO</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;no_RLO&quot;</span>
        <span class="c1"># examples: cases for both stars</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">totest</span><span class="o">.</span><span class="n">ALL_RLO_CASES</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_string</span><span class="p">([</span><span class="n">c</span><span class="p">,</span> <span class="mi">10</span><span class="o">+</span><span class="n">c</span><span class="p">])</span> <span class="o">==</span>\
                   <span class="s2">&quot;case_&quot;</span> <span class="o">+</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_TO_STR</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;1/&quot;</span>\
                   <span class="o">+</span> <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_TO_STR</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;2&quot;</span></div>


<div class="viewcode-block" id="TestFunctions.test_cumulative_mass_transfer_flag">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_cumulative_mass_transfer_flag">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_cumulative_mass_transfer_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;MT_cases&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_flag</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;copy&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_flag</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">EvolutionWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;MT case with unknown donor:&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">InappropriateValueWarning</span><span class="p">):</span>
                <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_flag</span><span class="p">([</span><span class="mi">30</span><span class="p">],</span> <span class="n">shift_cases</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_flag</span><span class="p">([</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span>\
                                                     <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">,</span>\
                                                     <span class="mi">10</span><span class="o">+</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span>\
                                                     <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span>\
                                                     <span class="mi">10</span><span class="o">+</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">,</span>\
                                                     <span class="mi">10</span><span class="o">+</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">])</span> <span class="o">==</span>\
               <span class="s1">&#39;case_A1/B1/A2/A1/B2/A2&#39;</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">cumulative_mass_transfer_flag</span><span class="p">([</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span>\
                                                     <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">,</span>\
                                                     <span class="mi">10</span><span class="o">+</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span>\
                                                     <span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">,</span>\
                                                     <span class="mi">10</span><span class="o">+</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_B</span><span class="p">,</span>\
                                                     <span class="mi">10</span><span class="o">+</span><span class="n">totest</span><span class="o">.</span><span class="n">MT_CASE_A</span><span class="p">],</span>\
                                                    <span class="n">shift_cases</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span>\
               <span class="s1">&#39;case_A1/B1/A2/B1/B2&#39;</span></div>


<div class="viewcode-block" id="TestFunctions.test_get_i_He_depl">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_get_i_He_depl">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_get_i_He_depl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;history&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_i_He_depl</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;dtype&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_i_He_depl</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;argument of type &#39;NoneType&#39; is not &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;iterable&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_i_He_depl</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
        <span class="c1"># examples: incomplete history to search through</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_i_He_depl</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]],</span> <span class="n">dtype</span><span class="o">=</span><span class="p">([(</span><span class="s1">&#39;surface_h1&#39;</span><span class="p">,</span>\
                                                            <span class="s1">&#39;f8&#39;</span><span class="p">)])))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="c1"># examples: no he depletion</span>
        <span class="n">test_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>\
                                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>\
                                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)],</span>\
                                <span class="n">dtype</span><span class="o">=</span><span class="p">([(</span><span class="s1">&#39;surface_h1&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;center_h1&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;center_he4&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;center_c12&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;log_LH&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;log_LHe&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;log_Lnuc&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">)]))</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_i_He_depl</span><span class="p">(</span><span class="n">test_history</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="c1"># examples: he depletion at 1</span>
        <span class="n">test_history</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>\
                                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>\
                                 <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)],</span>\
                                <span class="n">dtype</span><span class="o">=</span><span class="p">([(</span><span class="s1">&#39;surface_h1&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;center_h1&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;center_he4&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;center_c12&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;log_LH&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;log_LHe&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span>\
                                        <span class="p">(</span><span class="s1">&#39;log_Lnuc&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">)]))</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">get_i_He_depl</span><span class="p">(</span><span class="n">test_history</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="TestFunctions.test_calculate_Patton20_values_at_He_depl">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_calculate_Patton20_values_at_He_depl">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_calculate_Patton20_values_at_He_depl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;star&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_Patton20_values_at_He_depl</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;state_history&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_Patton20_values_at_He_depl</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># examples: no history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">co_core_mass_at_He_depletion</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">star</span><span class="o">.</span><span class="n">avg_c_in_c_core_at_He_depletion</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">star</span><span class="o">.</span><span class="n">state_history</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">totest</span><span class="o">.</span><span class="n">calculate_Patton20_values_at_He_depl</span><span class="p">(</span><span class="n">star</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">star</span><span class="o">.</span><span class="n">co_core_mass_at_He_depletion</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">star</span><span class="o">.</span><span class="n">avg_c_in_c_core_at_He_depletion</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="c1"># examples: no He_depleted in history</span>
        <span class="n">star</span><span class="o">.</span><span class="n">co_core_mass_at_He_depletion</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">star</span><span class="o">.</span><span class="n">avg_c_in_c_core_at_He_depletion</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;H-rich_Core_H_burning&quot;</span><span class="p">,</span> <span class="s2">&quot;H-rich_Core_He_burning&quot;</span><span class="p">,</span>\
                  <span class="s2">&quot;H-rich_Shell_H_burning&quot;</span><span class="p">,</span> <span class="s2">&quot;H-rich_Central_C_depletion&quot;</span><span class="p">,</span>\
                  <span class="s2">&quot;H-rich_undetermined&quot;</span><span class="p">,</span> <span class="s2">&quot;stripped_He_Core_He_burning&quot;</span><span class="p">,</span>\
                  <span class="s2">&quot;stripped_He_Central_C_depletion&quot;</span><span class="p">,</span>\
                  <span class="s2">&quot;stripped_He_undetermined&quot;</span><span class="p">]:</span>
            <span class="n">star</span><span class="o">.</span><span class="n">state_history</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_Patton20_values_at_He_depl</span><span class="p">(</span><span class="n">star</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">star</span><span class="o">.</span><span class="n">co_core_mass_at_He_depletion</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">assert</span> <span class="n">star</span><span class="o">.</span><span class="n">avg_c_in_c_core_at_He_depletion</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="c1"># examples: loop through star types with He depletion</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;H-rich_Central_He_depleted&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>\
                 <span class="p">(</span><span class="s2">&quot;stripped_He_Central_He_depleted&quot;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">star</span><span class="o">.</span><span class="n">state_history</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span>
            <span class="n">star</span><span class="o">.</span><span class="n">co_core_mass_history</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
            <span class="n">star</span><span class="o">.</span><span class="n">avg_c_in_c_core_history</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_Patton20_values_at_He_depl</span><span class="p">(</span><span class="n">star</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">star</span><span class="o">.</span><span class="n">co_core_mass_at_He_depletion</span> <span class="o">==</span> <span class="n">v</span>
            <span class="k">assert</span> <span class="n">star</span><span class="o">.</span><span class="n">avg_c_in_c_core_at_He_depletion</span> <span class="o">==</span> <span class="n">v</span></div>


<div class="viewcode-block" id="TestFunctions.test_CEE_parameters_from_core_abundance_thresholds">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_CEE_parameters_from_core_abundance_thresholds">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_CEE_parameters_from_core_abundance_thresholds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">,</span>\
                                                           <span class="n">capsys</span><span class="p">,</span> <span class="n">star</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_calculate_core_boundary</span><span class="p">(</span><span class="n">donor_mass</span><span class="p">,</span> <span class="n">donor_star_state</span><span class="p">,</span>\
                                         <span class="n">profile</span><span class="p">,</span> <span class="n">mc1_i</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                                         <span class="n">core_element_fraction_definition</span><span class="o">=</span>\
                                         <span class="kc">None</span><span class="p">,</span> <span class="n">CO_core_in_Hrich_star</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">core_element_fraction_definition</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_calculate_lambda_from_profile</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">donor_star_state</span><span class="p">,</span>\
                                               <span class="n">m1_i</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">radius1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>\
                                               <span class="n">common_envelope_option_for_lambda</span>\
                                               <span class="o">=</span><span class="n">totest</span><span class="o">.</span>\
                                               <span class="n">DEFAULT_CE_OPTION_FOR_LAMBDA</span><span class="p">,</span>\
                                               <span class="n">core_element_fraction_definition</span>\
                                               <span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ind_core</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                                               <span class="n">common_envelope_alpha_thermal</span><span class="o">=</span>\
                                               <span class="mf">1.0</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>\
                                               <span class="n">CO_core_in_Hrich_star</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>\
                                               <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">core_element_fraction_definition</span><span class="p">,</span>\
                   <span class="n">core_element_fraction_definition</span><span class="p">,</span>\
                   <span class="n">core_element_fraction_definition</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;star&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">CEE_parameters_from_core_abundance_thresholds</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;mass&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">CEE_parameters_from_core_abundance_thresholds</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">CEE_parameters_from_core_abundance_thresholds</span><span class="p">(</span><span class="n">star</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unsupported operand type(s) for &quot;</span>\
                                           <span class="o">+</span> <span class="s2">&quot;** or pow(): &#39;float&#39; and &quot;</span>\
                                           <span class="o">+</span> <span class="s2">&quot;&#39;NoneType&#39;&quot;</span>
        <span class="n">star</span><span class="o">.</span><span class="n">log_R</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">star</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">)],</span>\
                                <span class="n">dtype</span><span class="o">=</span><span class="p">([(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">)]))</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;argument of type &#39;NoneType&#39; is not &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;iterable&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">CEE_parameters_from_core_abundance_thresholds</span><span class="p">(</span><span class="n">star</span><span class="p">)</span>
        <span class="c1"># examples: missing state with profile and verbose</span>
        <span class="n">star</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;test_state&quot;</span>
        <span class="n">totest</span><span class="o">.</span><span class="n">CEE_parameters_from_core_abundance_thresholds</span><span class="p">(</span><span class="n">star</span><span class="p">,</span>\
                                                             <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">captured_out</span> <span class="o">=</span> <span class="n">capsys</span><span class="o">.</span><span class="n">readouterr</span><span class="p">()</span><span class="o">.</span><span class="n">out</span>
        <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;is not what expected during the &quot;</span>\
                    <span class="o">+</span><span class="s2">&quot;CEE_parameters_from_core_abundance_thresholds.&quot;</span><span class="p">,</span>\
                    <span class="s2">&quot;star_state&quot;</span><span class="p">,</span> <span class="s2">&quot;m_core_CE_1cent,m_core_CE_10cent,&quot;</span>\
                    <span class="o">+</span><span class="s2">&quot;m_core_CE_30cent,m_core_CE_pure_He_star_10cent&quot;</span><span class="p">,</span>\
                    <span class="s2">&quot;r_core_CE_1cent,r_core_CE_10cent,r_core_CE_30cent,&quot;</span>\
                    <span class="o">+</span><span class="s2">&quot;r_core_CE_pure_He_star_10cent&quot;</span><span class="p">,</span>\
                    <span class="s2">&quot;lambda_CE_1cent,lambda_CE_10cent,lambda_CE_30cent,&quot;</span>\
                    <span class="o">+</span><span class="s2">&quot;lambda_CE_pure_He_star_10cent&quot;</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">captured_out</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;m_core_CE_1cent&#39;</span><span class="p">,</span> <span class="s1">&#39;m_core_CE_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;m_core_CE_30cent&#39;</span><span class="p">,</span> <span class="s1">&#39;m_core_CE_pure_He_star_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;r_core_CE_1cent&#39;</span><span class="p">,</span> <span class="s1">&#39;r_core_CE_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;r_core_CE_30cent&#39;</span><span class="p">,</span> <span class="s1">&#39;r_core_CE_pure_He_star_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;lambda_CE_1cent&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda_CE_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;lambda_CE_30cent&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda_CE_pure_He_star_10cent&#39;</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">totest</span><span class="p">,</span> <span class="s2">&quot;calculate_core_boundary&quot;</span><span class="p">,</span>\
                            <span class="n">mock_calculate_core_boundary</span><span class="p">)</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">totest</span><span class="p">,</span> <span class="s2">&quot;calculate_lambda_from_profile&quot;</span><span class="p">,</span>\
                            <span class="n">mock_calculate_lambda_from_profile</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;test_state&quot;</span><span class="p">,</span> <span class="s2">&quot;H-rich_test&quot;</span><span class="p">,</span> <span class="s2">&quot;stripped_He_test&quot;</span><span class="p">]:</span>
            <span class="n">star</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">s</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">CEE_parameters_from_core_abundance_thresholds</span><span class="p">(</span><span class="n">star</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">capsys</span><span class="o">.</span><span class="n">readouterr</span><span class="p">()</span><span class="o">.</span><span class="n">out</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;m_core_CE_1cent&#39;</span><span class="p">,</span> <span class="s1">&#39;m_core_CE_10cent&#39;</span><span class="p">,</span>\
                         <span class="s1">&#39;m_core_CE_30cent&#39;</span><span class="p">,</span> <span class="s1">&#39;m_core_CE_pure_He_star_10cent&#39;</span><span class="p">,</span>\
                         <span class="s1">&#39;r_core_CE_1cent&#39;</span><span class="p">,</span> <span class="s1">&#39;r_core_CE_10cent&#39;</span><span class="p">,</span>\
                         <span class="s1">&#39;r_core_CE_30cent&#39;</span><span class="p">,</span> <span class="s1">&#39;r_core_CE_pure_He_star_10cent&#39;</span><span class="p">,</span>\
                         <span class="s1">&#39;lambda_CE_1cent&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda_CE_10cent&#39;</span><span class="p">,</span>\
                         <span class="s1">&#39;lambda_CE_30cent&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda_CE_pure_He_star_10cent&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;test_state&quot;</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
                <span class="k">elif</span> <span class="p">((</span><span class="s2">&quot;stripped_He&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;pure_He&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">)</span> <span class="ow">and</span>\
                      <span class="p">(</span><span class="s2">&quot;m_core&quot;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">)):</span>
                    <span class="k">assert</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="n">star</span><span class="o">.</span><span class="n">mass</span>
                <span class="k">elif</span> <span class="p">((</span><span class="s2">&quot;stripped_He&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;pure_He&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">)</span> <span class="ow">and</span>\
                      <span class="p">(</span><span class="s2">&quot;r_core&quot;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">)):</span>
                    <span class="k">assert</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">star</span><span class="o">.</span><span class="n">log_R</span>
                <span class="k">elif</span> <span class="p">((</span><span class="s2">&quot;stripped_He&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;pure_He&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">)</span> <span class="ow">and</span>\
                      <span class="p">(</span><span class="s2">&quot;lambda&quot;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">)):</span>
                    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
                <span class="k">elif</span> <span class="s2">&quot;1cent&quot;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.01</span>
                <span class="k">elif</span> <span class="s2">&quot;10cent&quot;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.1</span>
                <span class="k">elif</span> <span class="s2">&quot;30cent&quot;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.3</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
                <span class="c1"># reset attributes set by the tested function</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1"># examples: no profile</span>
        <span class="n">star</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">totest</span><span class="o">.</span><span class="n">CEE_parameters_from_core_abundance_thresholds</span><span class="p">(</span><span class="n">star</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;m_core_CE_1cent&#39;</span><span class="p">,</span> <span class="s1">&#39;m_core_CE_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;m_core_CE_30cent&#39;</span><span class="p">,</span> <span class="s1">&#39;m_core_CE_pure_He_star_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;r_core_CE_1cent&#39;</span><span class="p">,</span> <span class="s1">&#39;r_core_CE_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;r_core_CE_30cent&#39;</span><span class="p">,</span> <span class="s1">&#39;r_core_CE_pure_He_star_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;lambda_CE_1cent&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda_CE_10cent&#39;</span><span class="p">,</span>\
                     <span class="s1">&#39;lambda_CE_30cent&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda_CE_pure_He_star_10cent&#39;</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span></div>


<div class="viewcode-block" id="TestFunctions.test_initialize_empty_array">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_initialize_empty_array">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_initialize_empty_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;arr&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">initialize_empty_array</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;copy&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">initialize_empty_array</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">test_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">)],</span>\
                              <span class="n">dtype</span><span class="o">=</span><span class="p">([(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;U8&#39;</span><span class="p">)]))</span>
        <span class="n">empty_array</span> <span class="o">=</span> <span class="n">totest</span><span class="o">.</span><span class="n">initialize_empty_array</span><span class="p">(</span><span class="n">test_array</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">empty_array</span><span class="p">)):</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">empty_array</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>        <span class="c1"># nan float</span>
            <span class="k">assert</span> <span class="n">empty_array</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nan&#39;</span>        <span class="c1"># nan str</span></div>


<div class="viewcode-block" id="TestFunctions.test_calculate_core_boundary">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_calculate_core_boundary">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_calculate_core_boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 3 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;donor_mass&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;donor_star_state&#39;, and &#39;profile&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Not possible to calculate the core &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;boundary of the donor in CE&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">ApproximationWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Stellar profile columns were &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;not enough to calculate the &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;core-envelope boundaries for&quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot; CE, entire star is now &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;considered an envelope&quot;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>\
                                                  <span class="n">core_element_fraction_definition</span>\
                                                  <span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;dtype&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;H-rich_Core_H_burning&quot;</span><span class="p">,</span>\
                                           <span class="kc">None</span><span class="p">,</span>\
                                           <span class="n">core_element_fraction_definition</span><span class="o">=</span>\
                                           <span class="mf">0.1</span><span class="p">)</span>
        <span class="c1"># examples: get He core in H rich star</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;H-rich_Core_H_burning&quot;</span><span class="p">,</span>\
                                              <span class="n">star_profile</span><span class="p">,</span>\
                                              <span class="n">core_element_fraction_definition</span>\
                                              <span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="c1"># examples: get CO core in H rich star</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;H-rich_Core_H_burning&quot;</span><span class="p">,</span>\
                                              <span class="n">star_profile</span><span class="p">,</span>\
                                              <span class="n">core_element_fraction_definition</span>\
                                              <span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">CO_core_in_Hrich_star</span><span class="o">=</span><span class="kc">True</span>\
               <span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
        <span class="c1"># examples: get CO core in H rich star without CO core</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;H-rich_Core_H_burning&quot;</span><span class="p">,</span>\
                                              <span class="n">star_profile</span><span class="p">,</span>\
                                              <span class="n">core_element_fraction_definition</span>\
                                              <span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">CO_core_in_Hrich_star</span><span class="o">=</span><span class="kc">True</span>\
               <span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="c1"># examples: get CO core in He star without a match</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>\
                                              <span class="s2">&quot;stripped_He_Core_He_burning&quot;</span><span class="p">,</span>\
                                              <span class="n">star_profile</span><span class="p">,</span>\
                                              <span class="n">core_element_fraction_definition</span>\
                                              <span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="c1"># examples: given core mass</span>
        <span class="n">test_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">(</span><span class="n">test_mass</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>\
                                              <span class="n">mc1_i</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
        <span class="c1"># examples: both given: ignores core mass</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_core_boundary</span><span class="p">(</span><span class="n">test_mass</span><span class="p">,</span>\
                                              <span class="s2">&quot;stripped_He_Core_He_burning&quot;</span><span class="p">,</span>\
                                              <span class="n">star_profile</span><span class="p">,</span>\
                                              <span class="n">core_element_fraction_definition</span>\
                                              <span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">mc1_i</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span></div>


<div class="viewcode-block" id="TestFunctions.test_period_evol_wind_loss">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_period_evol_wind_loss">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_period_evol_wind_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 4 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;M_current&#39;, &#39;M_init&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;Mcomp&#39;, and &#39;P_init&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">period_evol_wind_loss</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">period_evol_wind_loss</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unsupported operand type(s) for &quot;</span>\
                                           <span class="o">+</span> <span class="s2">&quot;+: &#39;NoneType&#39; and &#39;NoneType&#39;&quot;</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">Mi</span><span class="p">,</span> <span class="n">M2</span><span class="p">,</span> <span class="n">Pi</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">period_evol_wind_loss</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">Mi</span><span class="p">,</span> <span class="n">M2</span><span class="p">,</span> <span class="n">Pi</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_separation_evol_wind_loss">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_separation_evol_wind_loss">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_separation_evol_wind_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 4 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;M_current&#39;, &#39;M_init&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;Mcomp&#39;, and &#39;A_init&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">separation_evol_wind_loss</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">separation_evol_wind_loss</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unsupported operand type(s) for &quot;</span>\
                                           <span class="o">+</span> <span class="s2">&quot;+: &#39;NoneType&#39; and &#39;NoneType&#39;&quot;</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">Mi</span><span class="p">,</span> <span class="n">M2</span><span class="p">,</span> <span class="n">ai</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">separation_evol_wind_loss</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">Mi</span><span class="p">,</span> <span class="n">M2</span><span class="p">,</span> <span class="n">ai</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_period_change_stable_MT">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_period_change_stable_MT">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_period_change_stable_MT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 4 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;period_i&#39;, &#39;Mdon_i&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;Mdon_f&#39;, and &#39;Macc_i&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">period_change_stable_MT</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">period_change_stable_MT</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unsupported operand type(s) for &quot;</span>\
                                           <span class="o">+</span> <span class="s2">&quot;-: &#39;NoneType&#39; and &#39;NoneType&#39;&quot;</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
                <span class="n">totest</span><span class="o">.</span><span class="n">period_change_stable_MT</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>\
                                              <span class="n">beta</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;In period_change_stable_MT, &quot;</span>\
                                               <span class="o">+</span> <span class="s2">&quot;mass transfer efficiencies,&quot;</span>\
                                               <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; alpha, beta: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> &quot;</span>\
                                               <span class="o">+</span> <span class="s2">&quot;are not in the [0-1] range.&quot;</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Donor gains mass from 0.5 to 1.5&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">period_change_stable_MT</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">1.18518518519</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">0.57735026919</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">0.94573367371</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.375</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">1.36956865306</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">0.58390782780</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">1.05670344636</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">0.13385261754</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">1.58670336106</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Pi</span><span class="p">,</span> <span class="n">Mdi</span><span class="p">,</span> <span class="n">Mdf</span><span class="p">,</span> <span class="n">Mai</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">period_change_stable_MT</span><span class="p">(</span><span class="n">Pi</span><span class="p">,</span> <span class="n">Mdi</span><span class="p">,</span> <span class="n">Mdf</span><span class="p">,</span> <span class="n">Mai</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>\
                                                 <span class="n">beta</span><span class="o">=</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_linear_interpolation_between_two_cells">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_linear_interpolation_between_two_cells">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_linear_interpolation_between_two_cells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capsys</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 3 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;array_y&#39;, &#39;array_x&#39;, and &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;x_target&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;&gt;=&#39; not supported between instances &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;of &#39;NoneType&#39; and &#39;NoneType&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># examples: automatic interpolation</span>
        <span class="n">test_array_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
        <span class="n">test_array_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">(</span><span class="n">test_array_y</span><span class="p">,</span>\
                                                             <span class="n">test_array_x</span><span class="p">,</span>\
                                                             <span class="mf">0.1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.7</span>
        <span class="c1"># examples: interpolation over multiple cells with verbose</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">(</span><span class="n">test_array_y</span><span class="p">,</span>\
                                                             <span class="n">test_array_x</span><span class="p">,</span>\
                                                             <span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>\
                                                             <span class="n">bot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>\
                                                             <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span>\
               <span class="mf">0.9</span>
        <span class="n">captured_out</span> <span class="o">=</span> <span class="n">capsys</span><span class="o">.</span><span class="n">readouterr</span><span class="p">()</span><span class="o">.</span><span class="n">out</span>
        <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;linear interpolation&quot;</span><span class="p">,</span>\
                    <span class="s2">&quot;x_target, top, bot, len(array_x)&quot;</span><span class="p">,</span>\
                    <span class="s2">&quot;x_top, x_bot, y_top, y_bot, y_target&quot;</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">captured_out</span>
        <span class="c1"># examples: extrapolation</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">(</span><span class="n">test_array_y</span><span class="p">,</span>\
                                                             <span class="n">test_array_x</span><span class="p">,</span>\
                                                             <span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span>\
               <span class="mf">0.45</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">(</span><span class="n">test_array_y</span><span class="p">,</span>\
                                                             <span class="n">test_array_x</span><span class="p">,</span>\
                                                             <span class="mf">0.1</span><span class="p">,</span> <span class="n">bot</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span>\
               <span class="mf">0.45</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">ReplaceValueWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;top=3 is too large, use last &quot;</span>\
                                              <span class="o">+</span><span class="s2">&quot;element in array_y&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">InterpolationWarning</span><span class="p">):</span>
                <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">(</span>\
                       <span class="n">test_array_y</span><span class="p">,</span> <span class="n">test_array_x</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">ReplaceValueWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;bot=-1 is too small, use &quot;</span>\
                                              <span class="o">+</span><span class="s2">&quot;first element&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">InterpolationWarning</span><span class="p">):</span>
                <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">(</span>\
                       <span class="n">test_array_y</span><span class="p">,</span> <span class="n">test_array_x</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">InterpolationWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;bot=2 is too large: use y at &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;top=1&quot;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">(</span><span class="n">test_array_y</span><span class="p">,</span>\
                                                                 <span class="n">test_array_x</span><span class="p">,</span>\
                                                                 <span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>\
                                                                 <span class="n">bot</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.4</span>
        <span class="n">test_array_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">InterpolationWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;array_x too short, use y at &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;top=3&quot;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">linear_interpolation_between_two_cells</span><span class="p">(</span><span class="n">test_array_y</span><span class="p">,</span>\
                                                                 <span class="n">test_array_x</span><span class="p">,</span>\
                                                                 <span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>\
                   <span class="o">==</span> <span class="o">-</span><span class="mf">1.0</span></div>


<div class="viewcode-block" id="TestFunctions.test_calculate_lambda_from_profile">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_calculate_lambda_from_profile">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_calculate_lambda_from_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">,</span> <span class="n">capsys</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 2 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;profile&#39; and &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;donor_star_state&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;dtype&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;state test not supported in CEE&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>\
                                                 <span class="n">ind_core</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;lambda_CE has a negative value&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">EvolutionWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Ebind_i of the envelope is &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;positive&quot;</span><span class="p">):</span>
                <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">,</span>\
                                                     <span class="s2">&quot;H-rich_test&quot;</span><span class="p">,</span> <span class="n">ind_core</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># examples: get He core in H rich star</span>
        <span class="n">lambda_CE</span><span class="p">,</span> <span class="n">Mc</span><span class="p">,</span> <span class="n">Rc</span> <span class="o">=</span>\
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>\
                                                 <span class="n">common_envelope_alpha_thermal</span>\
                                                 <span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">lambda_CE</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="mf">3.16722966582e+33</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+21</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">Mc</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">Rc</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)</span>
        <span class="n">lambda_CE</span><span class="p">,</span> <span class="n">Mc</span><span class="p">,</span> <span class="n">Rc</span> <span class="o">=</span>\
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>\
                                                 <span class="n">ind_core</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>\
                                                 <span class="n">common_envelope_alpha_thermal</span>\
                                                 <span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">lambda_CE</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">Mc</span> <span class="o">==</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">Rc</span> <span class="o">==</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># examples: He core in H rich star</span>
        <span class="n">lambda_CE</span><span class="p">,</span> <span class="n">Mc</span><span class="p">,</span> <span class="n">Rc</span> <span class="o">=</span>\
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">,</span> <span class="s2">&quot;H-rich_test&quot;</span><span class="p">,</span>\
                                                 <span class="n">ind_core</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>\
                                                 <span class="n">common_envelope_alpha_thermal</span>\
                                                 <span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">lambda_CE</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="mf">3.35757244514e+33</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+21</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">Mc</span> <span class="o">==</span> <span class="mf">0.1</span>
        <span class="k">assert</span> <span class="n">Rc</span> <span class="o">==</span> <span class="mf">0.1</span>
        <span class="n">captured_out</span> <span class="o">=</span> <span class="n">capsys</span><span class="o">.</span><span class="n">readouterr</span><span class="p">()</span><span class="o">.</span><span class="n">out</span>
        <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lambda_CE_top, lambda_CE_bot&quot;</span><span class="p">,</span>\
                    <span class="s2">&quot;m1_i, radius1, len(profile) vs ind_core, mc1_i, rc1_i&quot;</span><span class="p">,</span>\
                    <span class="s2">&quot;Ebind_i from profile &quot;</span><span class="p">,</span> <span class="s2">&quot;lambda_CE &quot;</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">captured_out</span>
        <span class="c1"># examples: CO core in H rich star</span>
        <span class="n">lambda_CE</span><span class="p">,</span> <span class="n">Mc</span><span class="p">,</span> <span class="n">Rc</span> <span class="o">=</span>\
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">,</span> <span class="s2">&quot;H-rich_test&quot;</span><span class="p">,</span>\
                                                 <span class="n">ind_core</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>\
                                                 <span class="n">common_envelope_alpha_thermal</span>\
                                                 <span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>\
                                                 <span class="n">CO_core_in_Hrich_star</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">lambda_CE</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="mf">4.25658010995e+32</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+20</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">Mc</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.03333333333</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">Rc</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="mf">1.03333333333</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e-12</span><span class="p">)</span>
        <span class="c1"># examples: CO core in He rich star should be the same</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">,</span>\
                                                    <span class="s2">&quot;H-rich_test&quot;</span><span class="p">,</span> <span class="n">ind_core</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>\
                                                    <span class="n">common_envelope_alpha_thermal</span>\
                                                    <span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>\
                                                    <span class="n">CO_core_in_Hrich_star</span><span class="o">=</span><span class="kc">True</span>\
               <span class="p">)</span> <span class="o">==</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_lambda_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">,</span>\
                                                         <span class="s2">&quot;stripped_He_test&quot;</span><span class="p">,</span>\
                                                         <span class="n">ind_core</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>\
                                                         <span class="n">common_envelope_alpha_thermal</span>\
                                                         <span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestFunctions.test_get_mass_radius_dm_from_profile">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_get_mass_radius_dm_from_profile">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_get_mass_radius_dm_from_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;profile&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_mass_radius_dm_from_profile</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;dtype&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_mass_radius_dm_from_profile</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">star_profile</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;One or many of the mass and/or &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;radius needed columns in the &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;profile is not provided for the &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;CEE&quot;</span><span class="p">):</span>
                <span class="n">totest</span><span class="o">.</span><span class="n">get_mass_radius_dm_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">[[</span><span class="n">f</span><span class="p">]])</span>
        <span class="c1"># examples: profile with radius</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">ClassificationWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Donor mass from the binary &quot;</span>\
                                                <span class="o">+</span><span class="s2">&quot;class object and the &quot;</span>\
                                                <span class="o">+</span><span class="s2">&quot;profile do not agree&quot;</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">ClassificationWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Donor radius from the &quot;</span>\
                                                    <span class="o">+</span><span class="s2">&quot;binary class object &quot;</span>\
                                                    <span class="o">+</span><span class="s2">&quot;and the profile do not &quot;</span>\
                                                    <span class="o">+</span><span class="s2">&quot;agree&quot;</span><span class="p">):</span>
                <span class="n">test_profile</span> <span class="o">=</span> <span class="n">star_profile</span><span class="p">[[</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;radius&#39;</span><span class="p">]]</span>
                <span class="n">d_mass</span><span class="p">,</span> <span class="n">d_radius</span><span class="p">,</span> <span class="n">d_dm</span> <span class="o">=</span>\
                    <span class="n">totest</span><span class="o">.</span><span class="n">get_mass_radius_dm_from_profile</span><span class="p">(</span><span class="n">test_profile</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_mass</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">])</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_radius</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">])</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_dm</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;dm&#39;</span><span class="p">])</span>
        <span class="c1"># get total mass and radius</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="c1"># examples: profile with log_R</span>
        <span class="n">d_mass</span><span class="p">,</span> <span class="n">d_radius</span><span class="p">,</span> <span class="n">d_dm</span> <span class="o">=</span>\
            <span class="n">totest</span><span class="o">.</span><span class="n">get_mass_radius_dm_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">[[</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span>\
                                                                 <span class="s1">&#39;log_R&#39;</span><span class="p">]],</span>\
                                                   <span class="n">m1_i</span> <span class="o">=</span> <span class="n">M</span><span class="p">,</span> <span class="n">radius1</span> <span class="o">=</span> <span class="n">R</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_mass</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">])</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_radius</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">])</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_dm</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;dm&#39;</span><span class="p">])</span>
        <span class="c1"># examples: profile with radius and dm (in grams)</span>
        <span class="n">d_mass</span><span class="p">,</span> <span class="n">d_radius</span><span class="p">,</span> <span class="n">d_dm</span> <span class="o">=</span>\
            <span class="n">totest</span><span class="o">.</span><span class="n">get_mass_radius_dm_from_profile</span><span class="p">(</span><span class="n">star_profile</span><span class="p">[[</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;dm&#39;</span><span class="p">,</span>\
                                                                 <span class="s1">&#39;radius&#39;</span><span class="p">]],</span>\
                                                   <span class="n">m1_i</span> <span class="o">=</span> <span class="n">M</span><span class="p">,</span> <span class="n">radius1</span> <span class="o">=</span> <span class="n">R</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_mass</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">])</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_radius</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">])</span>
        <span class="c1"># convert Msun to grams</span>
        <span class="n">d_dm</span> <span class="o">=</span> <span class="n">d_dm</span> <span class="o">*</span> <span class="n">totest</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">Msun</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_dm</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;dm&#39;</span><span class="p">])</span></div>


<div class="viewcode-block" id="TestFunctions.test_get_internal_energy_from_profile">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_get_internal_energy_from_profile">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_get_internal_energy_from_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_calculate_H2recombination_energy</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0e+99</span><span class="p">])</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">mock_calculate_recombination_energy</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0e+99</span><span class="p">])</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 2 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;common_envelope_option_for&quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;_lambda&#39; and &#39;profile&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_internal_energy_from_profile</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;dtype&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_internal_energy_from_profile</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;unsupported: common_envelope_option&quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;_for_lambda = test&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">get_internal_energy_from_profile</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>\
                                                    <span class="n">star_profile</span><span class="p">[[</span><span class="s1">&#39;energy&#39;</span><span class="p">]])</span>
        <span class="n">bad_profile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>\
                               <span class="n">dtype</span><span class="o">=</span><span class="p">([(</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">)]))</span>
        <span class="k">for</span> <span class="n">CEOFL</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lambda_from_profile_gravitational_plus_internal&quot;</span><span class="p">,</span>\
                      <span class="s2">&quot;lambda_from_profile_gravitational_plus_internal_minus&quot;</span>\
                      <span class="o">+</span><span class="s2">&quot;_recombination&quot;</span><span class="p">]:</span>
            <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;CEE problem calculating internal &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;energy, giving negative values.&quot;</span><span class="p">):</span>
                <span class="n">totest</span><span class="o">.</span><span class="n">get_internal_energy_from_profile</span><span class="p">(</span><span class="n">CEOFL</span><span class="p">,</span> <span class="n">bad_profile</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">monkeypatch</span><span class="o">.</span><span class="n">context</span><span class="p">()</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">totest</span><span class="p">,</span> <span class="s2">&quot;calculate_H2recombination_energy&quot;</span><span class="p">,</span>\
                          <span class="n">mock_calculate_H2recombination_energy</span><span class="p">)</span>
                <span class="n">m</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">totest</span><span class="p">,</span> <span class="s2">&quot;calculate_recombination_energy&quot;</span><span class="p">,</span>\
                          <span class="n">mock_calculate_recombination_energy</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
                    <span class="n">totest</span><span class="o">.</span><span class="n">get_internal_energy_from_profile</span><span class="p">(</span><span class="n">CEOFL</span><span class="p">,</span>\
                                                            <span class="n">star_profile</span><span class="p">[[</span>\
                                                            <span class="s1">&#39;energy&#39;</span><span class="p">]])</span>
                <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CEE problem calculating &quot;</span>\
                                                   <span class="o">+</span> <span class="s2">&quot;recombination (and H2 &quot;</span>\
                                                   <span class="o">+</span> <span class="s2">&quot;recombination) energy, &quot;</span>\
                                                   <span class="o">+</span> <span class="s2">&quot;remaining internal &quot;</span>\
                                                   <span class="o">+</span> <span class="s2">&quot;energy giving negative &quot;</span>\
                                                   <span class="o">+</span> <span class="s2">&quot;values.&quot;</span>
        <span class="c1"># examples: no internal energy</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>\
                              <span class="n">totest</span><span class="o">.</span><span class="n">get_internal_energy_from_profile</span><span class="p">(</span>\
                              <span class="s2">&quot;lambda_from_profile_gravitational&quot;</span><span class="p">,</span>\
                              <span class="n">star_profile</span><span class="p">[[</span><span class="s1">&#39;radius&#39;</span><span class="p">]]))</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">ApproximationWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Profile does not include &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;internal energy -- &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;proceeding with &#39;lambda_from&quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;_profile_gravitational&#39;&quot;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>\
                   <span class="n">totest</span><span class="o">.</span><span class="n">get_internal_energy_from_profile</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>\
                                                           <span class="n">star_profile</span><span class="p">[[</span>\
                                                           <span class="s1">&#39;radius&#39;</span><span class="p">]]))</span>
        <span class="c1"># examples: with internal energy</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">get_internal_energy_from_profile</span><span class="p">(</span>\
                           <span class="s2">&quot;lambda_from_profile_gravitational_plus_internal&quot;</span><span class="p">,</span>\
                           <span class="n">star_profile</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.99850443e+15</span><span class="p">,</span>\
                                                    <span class="mf">4.99893173e+15</span><span class="p">,</span>\
                                                    <span class="mf">9.99786347e+14</span><span class="p">,</span>\
                                                    <span class="mf">9.99786347e+12</span><span class="p">]))</span></div>


<div class="viewcode-block" id="TestFunctions.test_calculate_H2recombination_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_calculate_H2recombination_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_calculate_H2recombination_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;profile&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_H2recombination_energy</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;dtype&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_H2recombination_energy</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;CEE problem calculating H2 &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;recombination energy, giving &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;negative values&quot;</span><span class="p">):</span>
            <span class="n">bad_profile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>\
                                   <span class="n">dtype</span><span class="o">=</span><span class="p">([(</span><span class="s1">&#39;x_mass_fraction_H&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">)]))</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_H2recombination_energy</span><span class="p">(</span><span class="n">bad_profile</span><span class="p">)</span>
        <span class="c1"># examples: profile with Hydrogen mass fraction</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.49557421e+12</span><span class="p">,</span> <span class="mf">1.06826729e+12</span><span class="p">,</span>\
                                     <span class="mf">2.13653458e+11</span><span class="p">,</span> <span class="mf">2.13653458e+09</span><span class="p">]),</span>\
                           <span class="n">totest</span><span class="o">.</span><span class="n">calculate_H2recombination_energy</span><span class="p">(</span>\
                           <span class="n">star_profile</span><span class="p">[[</span><span class="s1">&#39;x_mass_fraction_H&#39;</span><span class="p">]]))</span>
        <span class="c1"># examples: profile without Hydrogen mass fraction</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">ApproximationWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Profile does not include &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;Hydrogen mass fraction &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;calculate H2 recombination &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;energy -- H2 recombination &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;energy is assumed 0&quot;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>\
                                  <span class="n">totest</span><span class="o">.</span><span class="n">calculate_H2recombination_energy</span><span class="p">(</span>\
                                  <span class="n">star_profile</span><span class="p">[[</span><span class="s1">&#39;radius&#39;</span><span class="p">]]))</span></div>


<div class="viewcode-block" id="TestFunctions.test_calculate_recombination_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_calculate_recombination_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_calculate_recombination_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;profile&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_recombination_energy</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;dtype&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_recombination_energy</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;CEE problem calculating &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;recombination energy, giving &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;negative values&quot;</span><span class="p">):</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x_mass_fraction_H&#39;</span><span class="p">,</span> <span class="s1">&#39;y_mass_fraction_He&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;neutral_fraction_H&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral_fraction_He&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;avg_charge_He&#39;</span><span class="p">]</span>
            <span class="n">bad_profile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">])</span>
            <span class="n">bad_profile</span><span class="p">[</span><span class="s1">&#39;x_mass_fraction_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
            <span class="n">bad_profile</span><span class="p">[</span><span class="s1">&#39;y_mass_fraction_He&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
            <span class="n">bad_profile</span><span class="p">[</span><span class="s1">&#39;neutral_fraction_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
            <span class="n">bad_profile</span><span class="p">[</span><span class="s1">&#39;neutral_fraction_He&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
            <span class="n">bad_profile</span><span class="p">[</span><span class="s1">&#39;avg_charge_He&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_recombination_energy</span><span class="p">(</span><span class="n">bad_profile</span><span class="p">)</span>
        <span class="c1"># examples: profile with mass fraction and ionization information</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.00000000e+00</span><span class="p">,</span> <span class="mf">4.73639308e+12</span><span class="p">,</span>\
                                     <span class="mf">7.53791976e+12</span><span class="p">,</span> <span class="mf">3.29724895e+12</span><span class="p">]),</span>\
                           <span class="n">totest</span><span class="o">.</span><span class="n">calculate_recombination_energy</span><span class="p">(</span>\
                           <span class="n">star_profile</span><span class="p">[</span><span class="n">cols</span><span class="p">]))</span>
        <span class="c1"># examples: profile without mass fraction and ionization information</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">ApproximationWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Profile does not include &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;mass fractions and &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;ionizations of elements to &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;calculate recombination &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;energy -- recombination &quot;</span>\
                                               <span class="o">+</span><span class="s2">&quot;energy is assumed 0&quot;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>\
                                  <span class="n">totest</span><span class="o">.</span><span class="n">calculate_recombination_energy</span><span class="p">(</span>\
                                  <span class="n">star_profile</span><span class="p">[[</span><span class="s1">&#39;radius&#39;</span><span class="p">]]))</span></div>


<div class="viewcode-block" id="TestFunctions.test_profile_recomb_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_profile_recomb_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_profile_recomb_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 5 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;x_mass_fraction_H&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;y_mass_fraction_He&#39;, &#39;frac_HII&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;frac_HeII&#39;, and &#39;frac_HeIII&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">profile_recomb_energy</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error_info</span><span class="p">:</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">profile_recomb_energy</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">error_info</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;unsupported operand type(s) for &quot;</span>\
                                           <span class="o">+</span> <span class="s2">&quot;*: &#39;float&#39; and &#39;NoneType&#39;&quot;</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">9.49756867371e+12</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+0</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">6.89384394360e+12</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+0</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">4.50323846485e+12</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+0</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">6.89384394360e+12</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+0</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">8.31217893947e+12</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+0</span><span class="p">)),</span>\
                 <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span>\
                  <span class="n">approx</span><span class="p">(</span><span class="mf">5.68862819909e+12</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+0</span><span class="p">))]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">fHII</span><span class="p">,</span> <span class="n">fHeII</span><span class="p">,</span> <span class="n">fHeIII</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">profile_recomb_energy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">fHII</span><span class="p">,</span> <span class="n">fHeII</span><span class="p">,</span> <span class="n">fHeIII</span><span class="p">)</span> <span class="o">==</span> <span class="n">r</span></div>


<div class="viewcode-block" id="TestFunctions.test_calculate_binding_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_calculate_binding_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_calculate_binding_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">star_profile</span><span class="p">,</span> <span class="n">capsys</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 7 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;donor_mass&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;donor_radius&#39;, &#39;donor_dm&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;specific_internal_energy&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;ind_core&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;factor_internal_energy&#39;, and &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;verbose&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_binding_energy</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object cannot be &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;interpreted as an integer&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_binding_energy</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>\
                                            <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;CEE problem calculating &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;gravitational energy, giving &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;positive values&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_binding_energy</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span>\
                                            <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span>\
                                            <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;dm&#39;</span><span class="p">],</span>\
                                            <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span>\
                                            <span class="kc">False</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">EvolutionWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Ebind_i of the envelope is &quot;</span>\
                                           <span class="o">+</span><span class="s2">&quot;positive&quot;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_binding_energy</span><span class="p">(</span><span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span>\
                                                   <span class="o">-</span><span class="mf">1.0e+60</span>\
                                                   <span class="o">*</span><span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span>\
                                                   <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;dm&#39;</span><span class="p">],</span>\
                                                   <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span>\
                                                   <span class="mf">0.5</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="mf">4.973e+48</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_binding_energy</span><span class="p">(</span><span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span>\
                                                   <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span>\
                                                   <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;dm&#39;</span><span class="p">],</span>\
                                                   <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span>\
                                                   <span class="mf">0.5</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="o">==</span>\
                   <span class="n">approx</span><span class="p">(</span><span class="mf">3.547071313426e+48</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+36</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_binding_energy</span><span class="p">(</span><span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span>\
                                               <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span>\
                                               <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;dm&#39;</span><span class="p">],</span>\
                                               <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span>\
                                               <span class="kc">True</span><span class="p">)</span> <span class="o">==</span>\
               <span class="n">approx</span><span class="p">(</span><span class="o">-</span><span class="mf">9.02693714763e+47</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">6e+35</span><span class="p">)</span>
        <span class="n">captured_out</span> <span class="o">=</span> <span class="n">capsys</span><span class="o">.</span><span class="n">readouterr</span><span class="p">()</span><span class="o">.</span><span class="n">out</span>
        <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;integration of gravitational energy surface to core &quot;</span>\
                    <span class="o">+</span><span class="s2">&quot;[Grav_energy], integration of internal energy surface &quot;</span>\
                    <span class="o">+</span><span class="s2">&quot;to core [U_i] (0 if not taken into account)&quot;</span><span class="p">,</span>\
                    <span class="s2">&quot;Ebind = Grav_energy + factor_internal_energy*U_i  :  &quot;</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">captured_out</span></div>


<div class="viewcode-block" id="TestFunctions.test_calculate_Mejected_for_integrated_binding_energy">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_calculate_Mejected_for_integrated_binding_energy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_calculate_Mejected_for_integrated_binding_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>\
                                                              <span class="n">star_profile</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 4 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;profile&#39;, &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;Ebind_threshold&#39;, &#39;mc1_i&#39;, and &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;&#39;rc1_i&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_Mejected_for_integrated_binding_energy</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;&#39;NoneType&#39; object has no &quot;</span>\
                                          <span class="o">+</span><span class="s2">&quot;attribute &#39;dtype&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">calculate_Mejected_for_integrated_binding_energy</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>\
                                                                    <span class="kc">None</span><span class="p">,</span>\
                                                                    <span class="kc">None</span><span class="p">,</span>\
                                                                    <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="c1"># get total mass and radius</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">star_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_Mejected_for_integrated_binding_energy</span><span class="p">(</span>\
               <span class="n">star_profile</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">m1_i</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">radius1</span><span class="o">=</span><span class="n">R</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span>
        <span class="k">with</span> <span class="n">warns</span><span class="p">(</span><span class="n">EvolutionWarning</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;partial mass ejected is greater &quot;</span>\
                                           <span class="o">+</span><span class="s2">&quot;than the envelope mass&quot;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">calculate_Mejected_for_integrated_binding_energy</span><span class="p">(</span>\
                   <span class="n">star_profile</span><span class="p">,</span> <span class="mf">1.0e+50</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">m1_i</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">radius1</span><span class="o">=</span><span class="n">R</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="TestFunctions.test_convert_metallicity_to_string">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_convert_metallicity_to_string">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_convert_metallicity_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 1 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;argument: &#39;Z&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">convert_metallicity_to_string</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Metallicity None not supported! &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;Available metallicities in POSYDON &quot;</span>\
                                      <span class="o">+</span><span class="s2">&quot;v2 are&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">convert_metallicity_to_string</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="n">tests</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">2e+00</span><span class="p">,</span> <span class="s1">&#39;2e+00&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">1e+00</span><span class="p">,</span> <span class="s1">&#39;1e+00&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">4.5e-01</span><span class="p">,</span> <span class="s1">&#39;4.5e-01&#39;</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">2e-01</span><span class="p">,</span> <span class="s1">&#39;2e-01&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">1e-01</span><span class="p">,</span> <span class="s1">&#39;1e-01&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">1e-02</span><span class="p">,</span> <span class="s1">&#39;1e-02&#39;</span><span class="p">),</span>\
                 <span class="p">(</span><span class="mf">1e-03</span><span class="p">,</span> <span class="s1">&#39;1e-03&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">1e-04</span><span class="p">,</span> <span class="s1">&#39;1e-04&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">totest</span><span class="o">.</span><span class="n">convert_metallicity_to_string</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="o">==</span> <span class="n">s</span></div>


<div class="viewcode-block" id="TestFunctions.test_rotate">
<a class="viewcode-back" href="../../../../api_reference/posydon.unit_tests.utils.html#posydon.unit_tests.utils.test_common_functions.TestFunctions.test_rotate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># missing argument</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;missing 2 required positional &quot;</span>\
                                     <span class="o">+</span><span class="s2">&quot;arguments: &#39;axis&#39; and &#39;angle&#39;&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">()</span>
        <span class="c1"># bad input</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;object of type &#39;NoneType&#39; has no len()&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;axis should be of dimension 3&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;axis is a point&quot;</span><span class="p">):</span>
            <span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="c1"># examples:</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">((</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">z</span><span class="o">!=</span><span class="mi">0</span><span class="p">)):</span>
                        <span class="c1"># angle=0 -&gt; no rotation</span>
                        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>\
                               <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]),</span> <span class="mf">0.0</span><span class="p">),</span>\
                               <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]))</span>
                        <span class="c1"># inverse rotation around inverted axis</span>
                        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>\
                               <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">z</span><span class="p">]),</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>\
                               <span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]),</span> <span class="mf">1.0</span><span class="p">))</span>
        <span class="c1"># examples: angle=1.0</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mf">1.0</span><span class="p">),</span>\
                              <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">]]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mf">1.0</span><span class="p">),</span>\
                              <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="p">]]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mf">1.0</span><span class="p">),</span>\
                              <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mf">1.0</span><span class="p">),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.77015115</span><span class="p">,</span> <span class="mf">0.22984885</span><span class="p">,</span> <span class="mf">0.59500984</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="mf">0.22984885</span><span class="p">,</span> <span class="mf">0.77015115</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59500984</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="o">-</span><span class="mf">0.59500984</span><span class="p">,</span> <span class="mf">0.59500984</span><span class="p">,</span> <span class="mf">0.54030231</span><span class="p">]]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mf">1.0</span><span class="p">),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.77015115</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59500984</span><span class="p">,</span> <span class="mf">0.22984885</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="mf">0.59500984</span><span class="p">,</span> <span class="mf">0.54030231</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59500984</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="mf">0.22984885</span><span class="p">,</span> <span class="mf">0.59500984</span><span class="p">,</span> <span class="mf">0.77015115</span><span class="p">]]))</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">totest</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mf">1.0</span><span class="p">),</span>\
                           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.54030231</span><span class="p">,</span><span class="o">-</span><span class="mf">0.59500984</span><span class="p">,</span> <span class="mf">0.59500984</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="mf">0.59500984</span><span class="p">,</span> <span class="mf">0.77015115</span><span class="p">,</span> <span class="mf">0.22984885</span><span class="p">],</span>\
                                     <span class="p">[</span><span class="o">-</span><span class="mf">0.59500984</span><span class="p">,</span> <span class="mf">0.22984885</span><span class="p">,</span> <span class="mf">0.77015115</span><span class="p">]]))</span></div>
</div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Tassos Fragos.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      Version: dev
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        
        <dl>
            <dt> v1 versions</dt>
            
            <dd><a href="https://posydon.org/POSYDON/v1.0.0/index.html">1.0.0</a></dd>
            
            <dd><a href="https://posydon.org/POSYDON/v1.0.4/index.html">1.0.4</a></dd>
            
            <dd><a href="https://posydon.org/POSYDON/v1.0.5/index.html">1.0.5</a></dd>
            
        </dL>
        
        
        <dl>
            <dt> v2 versions</dt>
            
            <dd><a href="https://posydon.org/POSYDON/v2.0.0-pre1/index.html">2.0.0-pre1</a></dd>
            
            <dd><a href="https://posydon.org/POSYDON/v2.0.0-pre2/index.html">2.0.0-pre2</a></dd>
            
            <dd><a href="https://posydon.org/POSYDON/development/index.html">dev</a></dd>
            
        </dL>
        
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>