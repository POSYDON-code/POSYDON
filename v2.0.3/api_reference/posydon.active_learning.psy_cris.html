

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>posydon.active_learning.psy_cris &mdash; posydon 2.0.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=d66fa8e6" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=664ffad9"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="posydon.active_learning.psy_cris.run_params" href="posydon.active_learning.psy_cris.run_params.html" />
    <link rel="prev" title="posydon.active_learning" href="posydon.active_learning.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/posydon_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction-acknowledgements/intro.html">Introduction, Objectives, and Scope</a></li>
<li class="toctree-l1"><a class="reference external" href="https://posydon.org/team.html">Collaborative Team</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ui.adsabs.harvard.edu/public-libraries/ZZsD9bzLTzWnLV3hwyJxbA">Publications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/installation-guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/first-grids.html">Quick Start: Examining the MESA Grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/first-population.html">Quick Start: Your First Population</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials and Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-examples/population-synthesis/binary-pop-syn.html">Binary-Star Population Synthesis with POSYDON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-examples/generating-datasets/generating-datasets.html">Crafting the Core Datasets for POSYDON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-examples/MESA-grids/running-grids.html">Architecting MESA Simulation Grids with POSYDON</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">In-Depth Components Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../components-overview/mesa-grids.html">MESA Grids API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components-overview/processing-pipeline.html">Processing Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components-overview/machine-learning-components.html">Machine Learning Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components-overview/stellar-binary-simulation.html">Stellar &amp; Binary-star Simulation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="posydon.html">posydon</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="posydon.active_learning.html">posydon.active_learning</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">posydon.active_learning.psy_cris</a><ul>
<li class="toctree-l4"><a class="reference internal" href="posydon.active_learning.psy_cris.run_params.html">posydon.active_learning.psy_cris.run_params</a></li>
<li class="toctree-l4"><a class="reference internal" href="posydon.active_learning.psy_cris.synthetic_data.html">posydon.active_learning.psy_cris.synthetic_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-posydon.active_learning.psy_cris.classify">posydon.active_learning.psy_cris.classify</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-posydon.active_learning.psy_cris.data">posydon.active_learning.psy_cris.data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-posydon.active_learning.psy_cris.regress">posydon.active_learning.psy_cris.regress</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-posydon.active_learning.psy_cris.sample">posydon.active_learning.psy_cris.sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-posydon.active_learning.psy_cris.utils">posydon.active_learning.psy_cris.utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="posydon.binary_evol.html">posydon.binary_evol</a></li>
<li class="toctree-l2"><a class="reference internal" href="posydon.grids.html">posydon.grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="posydon.interpolation.html">posydon.interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="posydon.popsyn.html">posydon.popsyn</a></li>
<li class="toctree-l2"><a class="reference internal" href="posydon.user_modules.html">posydon.user_modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="posydon.utils.html">posydon.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="posydon.visualization.html">posydon.visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bin.html">executables</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Releases and Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/POSYDON-code/POSYDON/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://zenodo.org/communities/posydon/">Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support and Contact</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contact-support/contact-information.html">Contact Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting-faqs/installation-issues.html">Common Installation Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting-faqs/code-questions.html">Code Usage Questions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/POSYDON-code/POSYDON/issues/new/choose">Report an Issue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/how-to-contribute.html">How To Contribute</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">posydon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="posydon.html">posydon</a></li>
          <li class="breadcrumb-item"><a href="posydon.active_learning.html">posydon.active_learning</a></li>
      <li class="breadcrumb-item active">posydon.active_learning.psy_cris</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api_reference/posydon.active_learning.psy_cris.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-posydon.active_learning.psy_cris">
<span id="posydon-active-learning-psy-cris"></span><h1>posydon.active_learning.psy_cris<a class="headerlink" href="#module-posydon.active_learning.psy_cris" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="posydon.active_learning.psy_cris.run_params.html">posydon.active_learning.psy_cris.run_params</a></li>
<li class="toctree-l1"><a class="reference internal" href="posydon.active_learning.psy_cris.synthetic_data.html">posydon.active_learning.psy_cris.synthetic_data</a></li>
</ul>
</div>
<section id="module-posydon.active_learning.psy_cris.classify">
<span id="posydon-active-learning-psy-cris-classify"></span><h2>posydon.active_learning.psy_cris.classify<a class="headerlink" href="#module-posydon.active_learning.psy_cris.classify" title="Link to this heading"></a></h2>
<p>The PSY-CRIS classification module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.classify.</span></span><span class="sig-name descname"><span class="pre">Classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TableData_object</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Classifier class.</p>
<p>Perform one against all classification with a variety of different
classification algorithms (interpolators). Different classifcation
algorithms are trainined and stored for recall as instance variables
inside nested dictionaries.
This class also supports model validation through cross validation
using the holdout method.</p>
<p>Initialize the classifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TableData_object</strong> (<em>instance</em><em> of </em><em>&lt;class</em><em>, </em><em>TableData&gt;</em>) – An instance of the TableData class with training data.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.cross_validate">
<span class="sig-name descname"><span class="pre">cross_validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.cross_validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.cross_validate" title="Link to this definition"></a></dt>
<dd><p>Cross validate classifiers on data from TableData object.</p>
<p>For each iteration, the classifiers specified are all trained
and tested on the same random subset of data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier_names</strong> (<em>array</em>) – Names of classifiers to train.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Fraction of data set to use for training. (0.05 = 5% of data set)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print statements with more information while training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>percent_correct</strong> (<em>ndarray</em>) – Percent correct classification on (1-alpha)% of the data set.
Element order matches the order of classifier_names.</p></li>
<li><p><strong>time_to_train</strong> (<em>ndarray</em>) – Time to train classifiers on a data set. Element order matches
the order of classifier_names.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.fit_gaussian_process_classifier">
<span class="sig-name descname"><span class="pre">fit_gaussian_process_classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_restarts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.fit_gaussian_process_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.fit_gaussian_process_classifier" title="Link to this definition"></a></dt>
<dd><p>Fit a Gaussian Process classifier.</p>
<p>Implementation from: sklearn.gaussian_process
(<a class="reference external" href="https://scikit-learn.org/stable/modules/gaussian_process.html">https://scikit-learn.org/stable/modules/gaussian_process.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_interval</strong> (<em>array_int</em><em>, </em><em>optional</em>) – Array indicies of data used to train (training on a subset).
if None (default) train on whole data set</p></li>
<li><p><strong>my_kernel</strong> (<em>kernel</em>) – Set the kernel for the GPC.</p></li>
<li><p><strong>n_restarts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of restarts for the GPC.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print statements with more information while training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>binary_classifier_holder</strong> – Sorted by class, each key maps to a trained
GaussianProcessClassifier object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.fit_linear_ND_interpolator">
<span class="sig-name descname"><span class="pre">fit_linear_ND_interpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.fit_linear_ND_interpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.fit_linear_ND_interpolator" title="Link to this definition"></a></dt>
<dd><p>Fit linear ND interpolator - binary one-against-all classification.</p>
<p>Implementation from: scipy.interpolate.LinearNDInterpolator
(<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html">https://docs.scipy.org/doc/scipy/reference/interpolate.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_interval</strong> (<em>array_int</em><em>, </em><em>optional</em>) – Array indicies of data used to train (training on a subset).
if None (default) train on whole data set</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print statements with more information while training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>binary_classifier_holder</strong> – Sorted by class, each key maps to a trained linearNDinterpolator
object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.fit_rbf_interpolator">
<span class="sig-name descname"><span class="pre">fit_rbf_interpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.fit_rbf_interpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.fit_rbf_interpolator" title="Link to this definition"></a></dt>
<dd><p>Fit RBF interpolator - binary classification (one against all).</p>
<p>Implementation from: scipy.interpolate.Rbf
(<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html">https://docs.scipy.org/doc/scipy/reference/interpolate.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_interval</strong> (<em>array_int</em><em>, </em><em>optional</em>) – Array indicies of data used to train (training on a subset).
if None (default) train on whole data set</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print statements with more information while training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>binary_classifier_holder</strong> – Sorted by class, each key maps to a trained RBF object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.get_class_predictions">
<span class="sig-name descname"><span class="pre">get_class_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.get_class_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.get_class_predictions" title="Link to this definition"></a></dt>
<dd><p>Return the class predictions.</p>
<p>The predictions are in the form of class IDs or the original
classification key. This method also returns the probability
of the class that was predicted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of classification algorithm to use.</p></li>
<li><p><strong>test_input</strong> (<em>ndarray</em>) – Input values to predict. Same shape as input data.</p></li>
<li><p><strong>return_ids</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True (default), return class IDs.
Else, return the original classification keys.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pred_class_ids</strong> (<em>array</em>) – Predicted class IDs given test input.</p></li>
<li><p><strong>max_probs</strong> (<em>array</em>) – Probability the classifier gives for the chosen class.</p></li>
<li><p><strong>where_not_nan</strong> (<em>array</em>) – Inidices where there are no nans (from LinearNDInterpolator).
You may use this to pick out which input data gives a valid
classification.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.get_classifier_name_to_key">
<span class="sig-name descname"><span class="pre">get_classifier_name_to_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.get_classifier_name_to_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.get_classifier_name_to_key" title="Link to this definition"></a></dt>
<dd><p>Return the standard key (str) of a classifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>classifier_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of classification algorithm to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>key</strong> – Key to access trained classifier objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.get_cross_val_data">
<span class="sig-name descname"><span class="pre">get_cross_val_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.get_cross_val_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.get_cross_val_data" title="Link to this definition"></a></dt>
<dd><p>Randomly sample the data set and seperate training and test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Fraction of data set to use for training. (0.05 = 5% of data set)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sorted_rnd_int_vals</strong> (<em>array</em>) – Array indicies for data used to train interpolators.</p></li>
<li><p><strong>cv_test_input_data</strong> (<em>array</em>) – Input test data to perform cross validation.</p></li>
<li><p><strong>cv_test_output_data</strong> (<em>array</em>) – Output test data to perform cross validation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.get_rnd_test_inputs">
<span class="sig-name descname"><span class="pre">get_rnd_test_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">dict()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.get_rnd_test_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.get_rnd_test_inputs" title="Link to this definition"></a></dt>
<dd><p>Produce randomly sampled ‘test’ inputs inside domain of input_data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of test inputs to return.</p></li>
<li><p><strong>other_rng</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Change the range of random sampling in desired axis. By default,
the sampling is done in the range of the training data. The axis is
specified with an integer key in [0,N-1] mapping to a list
specifying the range. (e.g. {1:[my_min, my_max]})</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print diagnostic information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rnd_test_points</strong> – Test points randomly sampled in the range of the training data
in each axis unless otherwise specified in ‘other_rng’.
Has the same shape as input data from TableData.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.make_cv_plot_data">
<span class="sig-name descname"><span class="pre">make_cv_plot_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interp_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_iterations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cv_data/'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.make_cv_plot_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.make_cv_plot_data" title="Link to this definition"></a></dt>
<dd><p>Script for running many instances of the method <cite>cross_validate()</cite>.</p>
<p>Cross validation score and timing data produced are saved locally.</p>
<p>! Time to train GaussianProcessClassifier becomes large for num
training points &gt; 1000. !</p>
<p>Files saved every 5 iterations to prevent loss of data for large
N_iterations.
Known expection occurs in GP classifier for low alpha due to data set
with only one class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interp_type</strong> (<em>array_str</em>) – Names of classifiers to train.</p></li>
<li><p><strong>alphas</strong> (<em>array_floats</em>) – Fractions of data set to use for training. (0.05 = 5% of data set)
(ex. [0.01, 0.02, …])</p></li>
<li><p><strong>N_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of iterations to run cross validation at a given alpha.</p></li>
<li><p><strong>folder_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Folder path where to save cross validation and timing data
(“your_folder_path/”).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.make_max_cls_plot">
<span class="sig-name descname"><span class="pre">make_max_cls_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">dict()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.make_max_cls_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.make_max_cls_plot" title="Link to this definition"></a></dt>
<dd><p>Make the maximum classification probablity plot.</p>
<p>Not generalized yet to slice along redundant axes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.return_probs">
<span class="sig-name descname"><span class="pre">return_probs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.return_probs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.return_probs" title="Link to this definition"></a></dt>
<dd><p>Return probability that a given input corresponds to a class.</p>
<p>The probability is calculated using trained classifiers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of classifier to train.</p></li>
<li><p><strong>test_input</strong> (<em>ndarray</em>) – N dimensional inputs to be classified.
The shape should be N_points x N_dimensions.</p></li>
<li><p><strong>verbose</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Print useful information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>normalized_probs</strong> (<em>ndarray</em>) – Array holding the normalized probability for a point to be in any
of the possible classes. Shape is N_points x N_classes.</p></li>
<li><p><strong>where_not_nan</strong> (<em>ndarray</em>) – Indicies of the test inputs that did not result in nans.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">di</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.train" title="Link to this definition"></a></dt>
<dd><p>Train a classifier.</p>
<dl class="simple">
<dt>Implemented classifiers:</dt><dd><p>LinearNDInterpolator (‘linear’, …)
Radial Basis Function (‘rbf’, …)
GaussianProcessClassifier (‘gp’, …)</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cl</span> <span class="o">=</span> <span class="n">Classifier</span><span class="p">(</span> <span class="n">TableData_object</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cl</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">di</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ndatapoints</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of classifier to train.</p></li>
<li><p><strong>di</strong> (<em>array_int</em><em>, </em><em>optional</em>) – Array indicies of data used to train (training on a subset).
if None - train on whole data set</p></li>
<li><p><strong>train_cross_val</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – For storing regular trained interpolators and cross val
interpolators. Used in the cross_validate() method.
if False - save normal interpolators
if True  - save cross validation interpolators</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print statements with more information while training.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.Classifier.train_everything">
<span class="sig-name descname"><span class="pre">train_everything</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#Classifier.train_everything"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.Classifier.train_everything" title="Link to this definition"></a></dt>
<dd><p>Trains multiple classifiers at once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>classifier_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of strings specifying classification algorithms to use.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.classify.makehash">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.classify.</span></span><span class="sig-name descname"><span class="pre">makehash</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/classify.html#makehash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.classify.makehash" title="Link to this definition"></a></dt>
<dd><p>Manage nested dictionaries.</p>
</dd></dl>

</section>
<section id="module-posydon.active_learning.psy_cris.data">
<span id="posydon-active-learning-psy-cris-data"></span><h2>posydon.active_learning.psy_cris.data<a class="headerlink" href="#module-posydon.active_learning.psy_cris.data" title="Link to this heading"></a></h2>
<p>Module for handling data for PSY-CRIS.</p>
<dl class="py class">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.data.</span></span><span class="sig-name descname"><span class="pre">TableData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_col_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_DataFrame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omit_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omit_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">undefined_p_change_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_csv_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>For managing data sets used for classification and regression.</p>
<blockquote>
<div><p>Reads tables of simulation data where a single row represents one
simulation. Each column in a row represents different inputs
(initial conditions) and outputs (result, continuous variables).
If using multiple files, each file is assumed to have the same columns.
You may also directly load a pandas DataFrame instead of reading in
files.</p>
<p>Example data structure expected in files or pandas DataFrame:</p>
<p>0  input_1  input_2  outcome  output_1   output_2  output_3 …
1    1.5      2.6      “A”       100       0.19       -     …
2    1.5      3.0      “B”        -          -        -     …
3    2.0      2.6      “C”        -          -        6     …
…</p>
<p>The above table has dashes ‘-’ in output columns to indicate NaN
values. You may have a similar structure if different classes have
fundamentally different outputs.</p>
</div></blockquote>
<p>Initialize the TableData instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_paths</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of file paths to read in as data.
if None, a pandas DataFrame is used instead</p></li>
<li><p><strong>input_cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of names of the columns which will be considered ‘input’.</p></li>
<li><p><strong>output_cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of names of the columns which will be considered ‘output’.
This should include the class column name.</p></li>
<li><p><strong>class_col_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of column which contains classification data.</p></li>
<li><p><strong>my_DataFrame</strong> (<em>pandas DataFrame</em><em>, </em><em>optional</em>) – If given, use this instead of reading files.</p></li>
<li><p><strong>omit_vals</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – Numerical values that you wish to omit from the entire data set.
If a row contains the value, the entire row is removed.
(For example you may want to omit all rows if they contain “-1” or
“failed”.)</p></li>
<li><p><strong>omit_cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – Column names that you wish to omit from the data set.</p></li>
<li><p><strong>subset_interval</strong> (<em>array</em><em>, </em><em>optional</em>) – Use some subset of the data files being loaded in.
An array with integers indicating the rows that will be kept.</p></li>
<li><p><strong>my_colors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – Colors to use for classification plots.</p></li>
<li><p><strong>n_neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – List of integers that set the number of neighbors to use to
calculate average distances. (default None)</p></li>
<li><p><strong>neighbor</strong> (<em>instance</em><em> of </em><em>sklearn.neighbors.NearestNeighbors</em><em>, </em><em>optional</em>) – To use for average distances. See function ‘calc_avg_dist()’.</p></li>
<li><p><strong>undefined_p_change_val</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Sets the undefined value used when calculating percent change fails
due to zero values in the output data. Default uses nan.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print statements with extra info.</p></li>
<li><p><strong>read_csv_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Kwargs passed to the pandas function ‘read_csv()’.</p></li>
<li><p><strong>**kwargs</strong> – Extra kwargs</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData.find_n_neighbors">
<span class="sig-name descname"><span class="pre">find_n_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_avg_dists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData.find_n_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData.find_n_neighbors" title="Link to this definition"></a></dt>
<dd><p>Find the N nearest neighbors of a given set of arbitrary points.</p>
<p>Given a set of arbitrary input points, find the N nearest neighbors
to each point, not including themselves. Can also return average
distance from a point to its N nearest neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> (<em>ndarray</em><em>, </em><em>pandas DataFrame</em>) – Data points where their nearest neighbors will be found</p></li>
<li><p><strong>n_neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of integers with number of neighbors to calculate</p></li>
<li><p><strong>neighbor</strong> (<em>instance</em><em> of </em><em>NearestNeightbors class</em>) – For passing your own object.</p></li>
<li><p><strong>return_avg_dists</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, return the a dictionary with average distances between
the N nearest neighbors listed in ‘n_neighbors’.</p></li>
<li><p><strong>**kwargs</strong> – <dl class="simple">
<dt>class_key<span class="classifier">str</span></dt><dd><p>If a DataFrame is given, specifies class column name.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>where_nearest_neighbors</strong> (<em>dict</em>) – Dictionary containing the n nearest neighbors for every point
in the input data.</p></li>
<li><p><strong>avg_distances</strong> (<em>dict</em>) – Returned if return_avg_dists is True.
The average distances between the nearest neighbors.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData.get_binary_mapping_per_class">
<span class="sig-name descname"><span class="pre">get_binary_mapping_per_class</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData.get_binary_mapping_per_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData.get_binary_mapping_per_class" title="Link to this definition"></a></dt>
<dd><p>Get binary mapping (0 or 1) of the class data.</p>
<p>Get binary mapping (0 or 1) of the class data for each unique
classification. For each classification, a value of 1 is given
if the class data matches that classification. If they do not
match, then a value of 0 is given.</p>
<p>Example:
classifications -&gt; A, B, C
class data      -&gt; [ A, B, B, A, B, C ]
binary mapping  -&gt; [[1, 0, 0, 1, 0, 0]   (for class A)</p>
<blockquote>
<div><p>[0, 1, 1, 0, 1, 0]   (for class B)
[0, 0, 0, 0, 0, 1]]  (for class C)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>binary_class_data</strong> – N by M array where N is the number of classes and M is the
number of classifications in the data set.
Order is determined by ‘_unique_class_keys_’.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData.get_class_data">
<span class="sig-name descname"><span class="pre">get_class_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData.get_class_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData.get_class_data" title="Link to this definition"></a></dt>
<dd><p>Get data related to classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>what_data</strong> – <dl class="simple">
<dt>‘class_col’ (array)</dt><dd><ul>
<li><p>Original classification data.</p></li>
</ul>
</dd>
<dt>’unique_class_keys’ (array)</dt><dd><ul>
<li><p>Unique classes found in the classification data.</p></li>
</ul>
</dd>
<dt>’class_col_to_ids’ (array)</dt><dd><ul>
<li><p>Original classification data replaced with their
respective class IDs (integers).</p></li>
</ul>
</dd>
<dt>’class_id_mapping’ (dict)</dt><dd><ul>
<li><p>Mapping between a classification from the original
data set and its class ID.</p></li>
</ul>
</dd>
<dt>’binary_data’ (ndarray)</dt><dd><ul>
<li><p>Iterating over the unique classes, classification data
is turned into 1 or 0 if it matches the given class.
See method ‘get_binary_mapping_per_class()’.</p></li>
</ul>
</dd>
<dt>’full’ (tuple)</dt><dd><ul>
<li><p>All options listed above. (Default)</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>str</strong> – <dl class="simple">
<dt>‘class_col’ (array)</dt><dd><ul>
<li><p>Original classification data.</p></li>
</ul>
</dd>
<dt>’unique_class_keys’ (array)</dt><dd><ul>
<li><p>Unique classes found in the classification data.</p></li>
</ul>
</dd>
<dt>’class_col_to_ids’ (array)</dt><dd><ul>
<li><p>Original classification data replaced with their
respective class IDs (integers).</p></li>
</ul>
</dd>
<dt>’class_id_mapping’ (dict)</dt><dd><ul>
<li><p>Mapping between a classification from the original
data set and its class ID.</p></li>
</ul>
</dd>
<dt>’binary_data’ (ndarray)</dt><dd><ul>
<li><p>Iterating over the unique classes, classification data
is turned into 1 or 0 if it matches the given class.
See method ‘get_binary_mapping_per_class()’.</p></li>
</ul>
</dd>
<dt>’full’ (tuple)</dt><dd><ul>
<li><p>All options listed above. (Default)</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>list</strong> – <dl class="simple">
<dt>‘class_col’ (array)</dt><dd><ul>
<li><p>Original classification data.</p></li>
</ul>
</dd>
<dt>’unique_class_keys’ (array)</dt><dd><ul>
<li><p>Unique classes found in the classification data.</p></li>
</ul>
</dd>
<dt>’class_col_to_ids’ (array)</dt><dd><ul>
<li><p>Original classification data replaced with their
respective class IDs (integers).</p></li>
</ul>
</dd>
<dt>’class_id_mapping’ (dict)</dt><dd><ul>
<li><p>Mapping between a classification from the original
data set and its class ID.</p></li>
</ul>
</dd>
<dt>’binary_data’ (ndarray)</dt><dd><ul>
<li><p>Iterating over the unique classes, classification data
is turned into 1 or 0 if it matches the given class.
See method ‘get_binary_mapping_per_class()’.</p></li>
</ul>
</dd>
<dt>’full’ (tuple)</dt><dd><ul>
<li><p>All options listed above. (Default)</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>optional</strong> – <dl class="simple">
<dt>‘class_col’ (array)</dt><dd><ul>
<li><p>Original classification data.</p></li>
</ul>
</dd>
<dt>’unique_class_keys’ (array)</dt><dd><ul>
<li><p>Unique classes found in the classification data.</p></li>
</ul>
</dd>
<dt>’class_col_to_ids’ (array)</dt><dd><ul>
<li><p>Original classification data replaced with their
respective class IDs (integers).</p></li>
</ul>
</dd>
<dt>’class_id_mapping’ (dict)</dt><dd><ul>
<li><p>Mapping between a classification from the original
data set and its class ID.</p></li>
</ul>
</dd>
<dt>’binary_data’ (ndarray)</dt><dd><ul>
<li><p>Iterating over the unique classes, classification data
is turned into 1 or 0 if it matches the given class.
See method ‘get_binary_mapping_per_class()’.</p></li>
</ul>
</dd>
<dt>’full’ (tuple)</dt><dd><ul>
<li><p>All options listed above. (Default)</p></li>
</ul>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>class_data</strong> – An object containing the specified classification data.
Will return tuple of len(what_data) if a list is passed. Default: 5</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>, ndarray, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData.get_data" title="Link to this definition"></a></dt>
<dd><p>Get all data contained in TableData object.</p>
<p>The data is returned after omission of columns and rows containing
specified values (if given) and taking a subset (if given) of the
original data set read in as a csv or given directly as a pandas
DataFrame. (Before data processing for classification and regression.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>what_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – Default is ‘full’ with other options ‘input’, or ‘output’.
‘full’ - original data table (after omission and subsets)
‘input’ - only data identified as inputs from ‘full’ data set
‘output’ - only data identified as outputs from ‘full’ data set</p></li>
<li><p><strong>return_df</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, return a pandas DataFrame object.
If False (default), return a numpy array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Data before classification and regression data sorting is done.
Will return tuple of len(what_data) if a list is passed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>, ndarray or DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData.get_info">
<span class="sig-name descname"><span class="pre">get_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData.get_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData.get_info" title="Link to this definition"></a></dt>
<dd><p>Return what info is printed in the ‘info()’ method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>files</strong> (<em>list</em>) – File paths where data was loaded from.</p></li>
<li><p><strong>df_index_keys</strong> (<em>list</em>) – Index keys added to the DataFrame object once
multiple files are joined together such that one can
access data by file after they were joined.</p></li>
<li><p><strong>for_info</strong> (<em>list</em>) – Running list of print statements that include but
are not limited to what is shown if ‘verbose=True’.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData.get_regr_data">
<span class="sig-name descname"><span class="pre">get_regr_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData.get_regr_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData.get_regr_data" title="Link to this definition"></a></dt>
<dd><p>Get data related to regression all sorted by class in dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>what_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – ‘input’ - For each class, the input data with no cleaning.
‘raw_output’ - For each class, the output data with no cleaning.
‘output’ - For each class, the cleaned output data.
‘full’ - All options listed above in that respective order.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – An object containing the specified regression data.
Will return tuple of len(what_data) if a list is passed. Default: 3</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>, ndarray or DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData.info" title="Link to this definition"></a></dt>
<dd><p>Print info for the instance of TableData object.</p>
<p>For output descriptions see the method ‘get_info()’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData.make_class_data_plot">
<span class="sig-name descname"><span class="pre">make_class_data_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_slice_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_class_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_legend_handles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData.make_class_data_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData.make_class_data_plot" title="Link to this definition"></a></dt>
<dd><p>Plot classification data on a given axis and figure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>Matplotlib Figure object</em>) – Figure on which the plot will be made.</p></li>
<li><p><strong>ax</strong> (<em>Matplotlib Axis object</em>) – Axis on which a scatter plot will be drawn.</p></li>
<li><p><strong>axes_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List containing two names of input data columns to use as
horizontal and verital axes.</p></li>
<li><p><strong>my_slice_vals</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – List giving values on which to slice in the axes not being plotted.
Default (None) uses the first unique value found in each axis.
If instead of individual values, a range is desired (e.g. 10 +/- 1)
then a dict can be given with integer keys mapping to a tuple with
the lower and upper range. ( e.g. {0:(9,11)} )</p></li>
<li><p><strong>my_class_colors</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of colors used to represent different classes. Default (None)
uses the default class colors.</p></li>
<li><p><strong>return_legend_handles</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Returns a list of handles that connect classes to colors.</p></li>
<li><p><strong>verbose</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Print useful information during runtime.</p></li>
<li><p><strong>**kwargs</strong> (<em>optional</em>) – Kwargs for matplotlib.pyplot.scatter() .</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>Matplotlib Figure object</em>) – Figure object.</p></li>
<li><p><strong>ax</strong> (<em>Matplotlib Axis object</em>) – Updated axis after plotting.</p></li>
<li><p><strong>handles</strong> (<em>optional, list</em>) – List of legend handles connecting classes and their colors.
Returned if ‘return_legend_handles’ is True. Default is False.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.TableData.plot_3D_class_data">
<span class="sig-name descname"><span class="pre">plot_3D_class_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mark_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plt_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#TableData.plot_3D_class_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.TableData.plot_3D_class_data" title="Link to this definition"></a></dt>
<dd><p>Plot the 3D classification data in a 2D plot.</p>
<p>3 input axis with classification output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – <p>By default it will order the axes as [x,y,z] in the original order
the input axis were read in. To change the ordering, pass a list
with the column names.
Example:
The default orderd is col_1, col_2, col_3.
To change the horizontal axis from col_1 to col_2 you would use:</p>
<blockquote>
<div><p>’axes = [“col_2”, “col_1”, “col_3”]’</p>
</div></blockquote>
</p></li>
<li><p><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>optional</em><em>, </em><em>default =</em><em> (</em><em>4</em><em>,</em><em>5</em><em>)</em>) – Size of the figure. (Matplotlib figure kwarg ‘fig_size’)</p></li>
<li><p><strong>mark_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em><em>, </em><em>default = 12</em>) – Size of the scatter plot markers. (Matplotlib scatter kwarg ‘s’)</p></li>
<li><p><strong>which_val</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default = 0</em>) – Integer choosing what unique value to ‘slice’ on in the
3D data such that it can be plotted on 2D.
(If you had x,y,z data you need to choose a z value)</p></li>
<li><p><strong>save_fig</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default = False</em>) – Save the figure in the local directory.</p></li>
<li><p><strong>plt_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default = '0'</em>) – If you are saving multiple figures you can pass a string
which will be added to the end of the default:
“data_plot_{plt_str}.pdf”</p></li>
<li><p><strong>color_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>default = None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib figure</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.calc_avg_dist">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.data.</span></span><span class="sig-name descname"><span class="pre">calc_avg_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#calc_avg_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.calc_avg_dist" title="Link to this definition"></a></dt>
<dd><p>Get the average distance to the nearest neighbors in the data set.</p>
<p>(NearestNeighbors from sklearn.neighbors)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – Data to train the NearestNeighbors class on.</p></li>
<li><p><strong>n_neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of neighbors to use when finding average distance.</p></li>
<li><p><strong>neighbor</strong> (<em>instance</em><em> of </em><em>NearestNeightbors class</em>) – For passing your own object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>avg_dist</strong> (<em>array</em>) – The average distance between nearest neighbors.</p></li>
<li><p><strong>g_indi</strong> (<em>array</em>) – Indicies that correspond to the nearest neighbors.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.data.calc_avg_p_change">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.data.</span></span><span class="sig-name descname"><span class="pre">calc_avg_p_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where_nearest_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">undefined_p_change_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/data.html#calc_avg_p_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.data.calc_avg_p_change" title="Link to this definition"></a></dt>
<dd><p>Calculate the average fractional change in a given data set.</p>
<p>The method uses the N nearest neighbors (calculated beforehand).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – Data set to calculate percent change.</p></li>
<li><p><strong>where_nearest_neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Indicies in data for the n nearest neighbors in input space.</p></li>
<li><p><strong>undefined_p_change_val</strong> (<em>optional</em>) – For output with an undefined percent change (zero value), this kwarg
defines what is put in its place. Defaults to nan.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>avg_p_change_holder</strong> – Each element conatins the average percent change for a given number of
neighbors. If any output values are 0, then a nan is put in place of a
percent change.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-posydon.active_learning.psy_cris.regress">
<span id="posydon-active-learning-psy-cris-regress"></span><h2>posydon.active_learning.psy_cris.regress<a class="headerlink" href="#module-posydon.active_learning.psy_cris.regress" title="Link to this heading"></a></h2>
<p>The PSY-CRIS regression module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.regress.</span></span><span class="sig-name descname"><span class="pre">Regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TableData_object</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Perform regression/interpolation with different regression algorithms.</p>
<p>Regression algorithms are trained by class and by output column in the data
set and stored as instance variables in nested dictionaries.</p>
<p>This class inlcudes a ‘cross validation’ method that trains with the
holdout method but calculates differences instead of a single accuracy.</p>
<p>Initialize the Regressor instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TableData_object</strong> (<em>instance</em><em> of </em><em>&lt;class</em><em>, </em><em>TableData&gt;</em>) – An instance of the TableData class.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.cross_validate">
<span class="sig-name descname"><span class="pre">cross_validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regressor_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.cross_validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.cross_validate" title="Link to this definition"></a></dt>
<dd><p>Our method of cross validation for regression.</p>
<p>Train on a subset of the data and predict values for the rest.
Then calculate the difference between the true and predicted value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regressor_name</strong> – Regressor name to use for analysis.</p></li>
<li><p><strong>class_key</strong> – Class key to take differences.</p></li>
<li><p><strong>col_key</strong> – Column key to take differences.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Fraction of data set used to find differences.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print useful information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>percent_diffs</strong> (<em>array</em>) – Percent difference.</p></li>
<li><p><strong>diffs</strong> (<em>array</em>) – Absolute difference.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.fit_gaussian_process_regressor">
<span class="sig-name descname"><span class="pre">fit_gaussian_process_regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.fit_gaussian_process_regressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.fit_gaussian_process_regressor" title="Link to this definition"></a></dt>
<dd><p>Fit a Gaussian Process regressor.</p>
<p>Implementation from: sklearn.gaussian_process
(<a class="reference external" href="https://scikit-learn.org/stable/modules/gaussian_process.html">https://scikit-learn.org/stable/modules/gaussian_process.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_keys</strong> – List of classes to train on.</p></li>
<li><p><strong>col_keys</strong> – If multiple classes are given, it is assumed they all contain
the supplied columns.</p></li>
<li><p><strong>data_interval</strong> (<em>array</em><em>, </em><em>optional</em>) – Array indicies of data used to train (training on a subset).
if None (default) train on whole data set</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print statements with more information while training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>regressor_holder</strong> – Ordered by class specific data and then by column. Nested
dictionary maps to a trained GaussianProcessRegressor object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.fit_linear_ND_interpolator">
<span class="sig-name descname"><span class="pre">fit_linear_ND_interpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.fit_linear_ND_interpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.fit_linear_ND_interpolator" title="Link to this definition"></a></dt>
<dd><p>Fit linear ND interpolator.</p>
<p>Implementation from: scipy.interpolate.LinearNDInterpolator
(<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html">https://docs.scipy.org/doc/scipy/reference/interpolate.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of classes to train on.</p></li>
<li><p><strong>col_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of columns in the class to train on.
If multiple classes are given, it is assumed they all contain
the supplied columns.</p></li>
<li><p><strong>data_interval</strong> (<em>array</em><em>, </em><em>optional</em>) – Array indicies of data used to train (training on a subset).
If None (default) train on whole data set</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print statements with more information while training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>regressor_holder</strong> – Ordered by class specific data and then by column. Nested
dictionary maps to a trained linearNDinterpolator object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.fit_rbf_interpolator">
<span class="sig-name descname"><span class="pre">fit_rbf_interpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.fit_rbf_interpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.fit_rbf_interpolator" title="Link to this definition"></a></dt>
<dd><p>Fit RBF interpolator - binary classification (one against all).</p>
<p>Implementation from: scipy.interpolate.Rbf
(<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html">https://docs.scipy.org/doc/scipy/reference/interpolate.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_keys</strong> – List of classes to train on.</p></li>
<li><p><strong>col_keys</strong> – If multiple classes are given, it is assumed they all contain
the supplied columns.</p></li>
<li><p><strong>data_interval</strong> (<em>array</em><em>, </em><em>optional</em>) – Array indicies of data used to train (training on a subset).
if None (default) train on whole data set</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print statements with more information while training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>regressor_holder</strong> – Ordered by class specific data and then by column. Nested
dictionary maps to a trained RBF object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.get_cross_val_data">
<span class="sig-name descname"><span class="pre">get_cross_val_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.get_cross_val_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.get_cross_val_data" title="Link to this definition"></a></dt>
<dd><p>Randomly sample the data set and seperate training and test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>class_dtype</em><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>other</em><em>)</em>) – Class key specifying the class to get data from.</p></li>
<li><p><strong>col_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Column key specifying the output column to get data.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Fraction of data set to use for training. (0.05 = 5% of data set)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cross_val_test_input_data</strong> (<em>ndarray</em>) – Input data used to test after training on a subset.</p></li>
<li><p><strong>cross_val_test_output_data</strong> (<em>ndarray</em>) – Output data used to test after training on a subset.</p></li>
<li><p><strong>sorted_rnd_int_vals</strong> (<em>array</em>) – Indicies of original data that were used as training points.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.get_max_APC_val">
<span class="sig-name descname"><span class="pre">get_max_APC_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regressor_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.get_max_APC_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.get_max_APC_val" title="Link to this definition"></a></dt>
<dd><p>Return the maximum interpolated average percent change for a class.</p>
<p>For a given class, and regression method. Return the maximum
interpolated average percent change value across all APC columns in
the class sorted data set. Helper method for constructing target
distributions for the Sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regressor_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of regression algorithm to use.</p></li>
<li><p><strong>class_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Class key to use for data.</p></li>
<li><p><strong>args</strong> (<em>array</em>) – Locations for the APC value to be predicted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>max_APC</strong> (<em>float</em>) – Maximum average percent change (APC) value.</p></li>
<li><p><strong>which_col_max</strong> (<em>int</em>) – Index of which column had the maximum APC.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regressor_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.get_predictions" title="Link to this definition"></a></dt>
<dd><p>Get predictions from trained regressors for a set of inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regressor_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of regressor algorithm names to use to predict.</p></li>
<li><p><strong>class_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of classes to get predictions for.</p></li>
<li><p><strong>col_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of columns to get predictions for.</p></li>
<li><p><strong>test_input</strong> (<em>ndarray</em>) – Array of input points for which predictions will be found.</p></li>
<li><p><strong>return_std</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Return the STD is when using GaussianProcessRegressor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – Dictionary ordered by algorithm, class, and output column mapping
to an array of predictions for the test input points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.get_regressor_name_to_key">
<span class="sig-name descname"><span class="pre">get_regressor_name_to_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.get_regressor_name_to_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.get_regressor_name_to_key" title="Link to this definition"></a></dt>
<dd><p>Return the standard key (str) of a classifier.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.get_rnd_test_inputs">
<span class="sig-name descname"><span class="pre">get_rnd_test_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.get_rnd_test_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.get_rnd_test_inputs" title="Link to this definition"></a></dt>
<dd><p>Produce randomly sampled ‘test’ inputs inside domain of input_data.</p>
<p>Input data is seperated by class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Class name to specify which input data you want to look at.</p></li>
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of test inputs to return.</p></li>
<li><p><strong>other_rng</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Change the range of random sampling in desired axis. By default,
the sampling is done in the range of the training data.
The axis is specified with an integer key and the value
is a list specifying the range. {1:[min, max]}</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print diagnostic information. (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rnd_test_points</strong> – Test points randomly sampled in the range of the training data
in each axis unless otherwise specified in ‘other_rng’.
Has the same shape as input data from TableData.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.mult_diffs">
<span class="sig-name descname"><span class="pre">mult_diffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regressor_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.mult_diffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.mult_diffs" title="Link to this definition"></a></dt>
<dd><p>For multiple calls to cross_validate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regressor_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of regression algorithm to use.</p></li>
<li><p><strong>class_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>class_dtype</em><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>other</em><em>)</em>) – Name of class data to use.</p></li>
<li><p><strong>col_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Column keys to cross validate on.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Fraction of data set to cross validate on.</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Sets the cutoff percentage at which to calculate
the fraction of the data set above or below.</p></li>
<li><p><strong>vebose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print useful diagnostic information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>p_diffs_holder</strong> (<em>ndarray</em>) – Percent differencs per column.</p></li>
<li><p><strong>attr_holder</strong> (<em>ndarray</em>) – Contains the number of points outside the cutoff, mean,
and standard deviation of the percent difference calculations.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.plot_regr_data">
<span class="sig-name descname"><span class="pre">plot_regr_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.plot_regr_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.plot_regr_data" title="Link to this definition"></a></dt>
<dd><p>Plot all regression data from the chosen class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>class_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Specify what class data will plotted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Plots with all regression data for a given class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.show_structure">
<span class="sig-name descname"><span class="pre">show_structure</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.show_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.show_structure" title="Link to this definition"></a></dt>
<dd><p>Show (print) the structure of the regression data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regressor_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">di</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.train" title="Link to this definition"></a></dt>
<dd><p>Train a regression algorithm.</p>
<dl class="simple">
<dt>Implemented regressors:</dt><dd><p>LinearNDInterpolator (‘linear’, …)
Radial Basis Function (‘rbf’, …)
GaussianProcessRegressor (‘gp’, …)</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span> <span class="o">=</span> <span class="n">Regressor</span><span class="p">(</span> <span class="n">TableData_object</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">di</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ndatapoints</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Trained regressor objects are uniquely defined by the algorithm used to
train, the data set used to train (grouped by class), and finally the
output column (there could be more than one). This motivates the data
structure for storing the regressor objects as follows:</p>
<blockquote>
<div><p>Algorithm -&gt; Class -&gt; Output Column -&gt; Object</p>
</div></blockquote>
<dl class="simple">
<dt>Here is more realistic example of what it could look like:</dt><dd><p>{RBF: {“class_1”: {“output_1”: {instance of scipy.interpolate.rbf}}}}</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regressor_name</strong> (<em>string</em>) – Name of regressor to train.</p></li>
<li><p><strong>class_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of class(es) to train on.</p></li>
<li><p><strong>col_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><em>None</em>) – For a given class, what columns to train on.
If None, it trains on all columns in one class.</p></li>
<li><p><strong>di</strong> (<em>optional</em><em>, </em><em>array</em>) – Array indicies of data used to train (training on a subset).
If None (default) - train on whole data set</p></li>
<li><p><strong>verbose</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Print statements with more information while training.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Note: You can train mutliple classes at once as long as they have the
same columns specified in col_keys.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.Regressor.train_everything">
<span class="sig-name descname"><span class="pre">train_everything</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regressor_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#Regressor.train_everything"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.Regressor.train_everything" title="Link to this definition"></a></dt>
<dd><p>Train all classes and columns with the specified list of regressors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regressor_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of strings specifying all the regressors to train.</p></li>
<li><p><strong>verbose</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Print useful information.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.regress.makehash">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.regress.</span></span><span class="sig-name descname"><span class="pre">makehash</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/regress.html#makehash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.regress.makehash" title="Link to this definition"></a></dt>
<dd><p>Manage nested dictionaries.</p>
</dd></dl>

</section>
<section id="module-posydon.active_learning.psy_cris.sample">
<span id="posydon-active-learning-psy-cris-sample"></span><h2>posydon.active_learning.psy_cris.sample<a class="headerlink" href="#module-posydon.active_learning.psy_cris.sample" title="Link to this heading"></a></h2>
<p>The definition of the <cite>Sampler</cite> class in PSY-CRIS.</p>
<dl class="py class">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.sample.</span></span><span class="sig-name descname"><span class="pre">Sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regressor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class implementing PTMCMC and MCMC for PSY-CRIS algorith.</p>
<p>Modular implementation of PTMCMC and MCMC designed to
implement the PSY-CRIS algorithm of sampling points
in a target distribution constructed with a Classifier
and Regressor. After a posterior is generated, methods
in this class are also used to downsample.</p>
<p>Initialize the sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier</strong> (<em>instance</em><em> of </em><em>&lt;class</em><em>, </em><em>Classifier&gt;</em>) – A trained classifier object.</p></li>
<li><p><strong>regressor</strong> (<em>instance</em><em> of </em><em>&lt;class</em><em>, </em><em>Regressor&gt;</em><em>, </em><em>optional</em>) – A trained regressor object.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.TD_2d_analytic">
<span class="sig-name descname"><span class="pre">TD_2d_analytic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.TD_2d_analytic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.TD_2d_analytic" title="Link to this definition"></a></dt>
<dd><p>2-dimensional analytic target distribution for testing MCMC/PTMCMC.</p>
<p>The function:
$frac{16}{3pi} left( expleft[-mu^2 - (9 + 4mu^2 + 8nu)^2right]
+ frac{1}{2} expleft[- 8 mu^2 - 8 (nu-2)^2right] right)$</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of algorithm to use. For this method None.</p></li>
<li><p><strong>args</strong> (<em>array</em>) – 2D location to get the value of the function.</p></li>
<li><p><strong>**kwargs</strong> – Kwargs for more complex target distributions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>array or <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.TD_classification">
<span class="sig-name descname"><span class="pre">TD_classification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.TD_classification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.TD_classification" title="Link to this definition"></a></dt>
<dd><p>Target distribution using classification.</p>
<p>$f(x) = 1 - max[P_{rm class}(x)]$</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – String to specify the trained classification algorithm to use.</p></li>
<li><p><strong>position</strong> (<em>array</em>) – Single location in parameter space for the target distribution to
be evaluated at.</p></li>
<li><p><strong>**kwargs</strong> – <dl class="simple">
<dt>TD_BETA<span class="classifier">float</span></dt><dd><p>Exponent of target distribution - $f(x)^{rm TD_BETA}$
Used for smoothing or sharpening.</p>
</dd>
<dt>TD_verbose<span class="classifier">bool</span></dt><dd><p>Extra print output every method call.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If classification probability is Nan: f(x) = 1E-16</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.TD_classification_regression">
<span class="sig-name descname"><span class="pre">TD_classification_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.TD_classification_regression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.TD_classification_regression" title="Link to this definition"></a></dt>
<dd><p>Target distribution using both classification &amp; regression.</p>
<p>Classification: $1 - max[P_{rm class}(x)]$
Regression: $ A_0 log( A_1* abs( max[APC_n [loc]]) + 1 )$</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> (<em>list like</em>) – Iterable containing the two strings specifying the classification
and regression algorithm to use.</p></li>
<li><p><strong>args</strong> (<em>array</em>) – Position in parameter space to evaluate the target distribution at.</p></li>
<li><p><strong>**kwargs</strong> – <dl class="simple">
<dt>TD_A1<span class="classifier">float, optional</span></dt><dd><p>Scaling factor inside the Log regression error term.
(Default = 0.5)</p>
</dd>
<dt>TD_TAU<span class="classifier">float, optional</span></dt><dd><p>Relative weight of classification to regression term.
(Default = 0.5)</p>
</dd>
<dt>TD_BETA<span class="classifier">float, optional</span></dt><dd><p>Exponent of the entire target distribution. Used
for smoothing or sharpening the distribution. Default is 1.</p>
</dd>
<dt>TD_verbose<span class="classifier">bool, optional</span></dt><dd><p>Print more diagnostic information.</p>
</dd>
</dl>
</p></li>
<li><p><strong>Rreturns</strong></p></li>
<li><p><strong>--------</strong></p></li>
<li><p><strong>array</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.do_density_logic">
<span class="sig-name descname"><span class="pre">do_density_logic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_mvns_together</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_acc_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.do_density_logic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.do_density_logic" title="Link to this definition"></a></dt>
<dd><p>Do the density based of the normal gaussian kernel on each point.</p>
<p>This method automatically takes out the first 5% of steps of the MCMC
so that the initial starting points are not chosen automatically
(if you start in a non-ideal region). Wait for the burn in.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_history</strong> (<em>ndarray</em>)</p></li>
<li><p><strong>N_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>Kappa</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>norm_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>var_mult</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>add_mvns_together</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>accepted_points</strong> (<em>ndarray</em>)</p></li>
<li><p><strong>rejected_points</strong> (<em>ndarray</em>)</p></li>
<li><p><strong>accepted_sigmas</strong> (<em>ndarray</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.do_simple_density_logic">
<span class="sig-name descname"><span class="pre">do_simple_density_logic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_mvns_together</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_training_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.do_simple_density_logic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.do_simple_density_logic" title="Link to this definition"></a></dt>
<dd><p>Perform multivariate normal density logic on a given step history.</p>
<p>This is a simplified version of the method ‘do_density_logic’.
It assumes that every accepted point will have the same exact MVN.</p>
<p>Each proposal distribution starts with the training set from TableData
which keeps training data from being proposed again.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_history</strong> (<em>ndarray</em>) – List of points from a PTMCMC or MCMC. (posterior)</p></li>
<li><p><strong>N_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of points desired to be drawn from the posterior but may not
actually be the number of points accepted. Contributes to the
length scale of the MVN distribution of accepted points
(along with kappa).</p></li>
<li><p><strong>Kappa</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Scaling factor that sets the initial size of the MVN for accepted
points. This should be proportional to the filling factor of the
area of iterest described by the target distribution used to
create the posterior.</p></li>
<li><p><strong>var_mult</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>ndarray</em><em>, </em><em>optional</em>) – Variance multiplier for the MVN of accepted points.</p></li>
<li><p><strong>add_mvns_together</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Add MVNs together when creating the accepted point distribution.</p></li>
<li><p><strong>include_training_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Include the trainind data in the target distribution before
sampling.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print useful diagnostic information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>accepted_points</strong> (<em>ndarray</em>) – Accepted points from the posterior to be labled by the user.
(query points)</p></li>
<li><p><strong>rejected_points</strong> (<em>ndarray</em>) – Rejected points from the posterior.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The accepted laguage here is indicative of query points for the oracle
to label in an active learning scheme. It is not accepted vs rejected
normally used for MCMC.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.get_TD_classification_data">
<span class="sig-name descname"><span class="pre">get_TD_classification_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.get_TD_classification_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.get_TD_classification_data" title="Link to this definition"></a></dt>
<dd><p>Get target-distribution classification data.</p>
<p>Calculate terms relevant for creating target distributions
with classification terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Trained classifier name to use for predictions.</p></li>
<li><p><strong>position</strong> (<em>array</em>) – Position in parameter space to eval</p></li>
<li><p><strong>**kwargs</strong> – <dl class="simple">
<dt>TD_verbose<span class="classifier">bool</span></dt><dd><p>Print useful output</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>max_probs</strong> (<em>array</em>) – Maximum probabilities at each query point</p></li>
<li><p><strong>position</strong> (<em>array</em>) – Position in parameter space being queried</p></li>
<li><p><strong>cls_key</strong> (<em>array</em>) – Classification key predicted for each query position</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.get_proposed_points">
<span class="sig-name descname"><span class="pre">get_proposed_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_mvns_together</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_training_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_repeats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.get_proposed_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.get_proposed_points" title="Link to this definition"></a></dt>
<dd><p>Get proposed points in parameter space given a MCMC step history.</p>
<p>The desnity logic is not deterministic, so multiple iterations
may be needed to converge on a desired number of proposed points.
This method performs multiple calls to do_density_logic while
changing Kappa in order to return the desired number of points. After
n_iters instances of the correct number of N_points, the distibution
with the largest average distance is chosen.</p>
<dl class="simple">
<dt>Warning: This algorithm has not been tested for large N data sets and</dt><dd><p>may struggle to converge.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_history</strong> (<em>ndarray</em>) – Posterior from which to sample new query points.</p></li>
<li><p><strong>N_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – N query points to converge to.</p></li>
<li><p><strong>Kappa</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Multiplies the length scale of MVNs and changes such that the
desired number of query points is found.</p></li>
<li><p><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Shuffle points in posterior in place before sampling.</p></li>
<li><p><strong>norm_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Normalize steps before sampling.</p></li>
<li><p><strong>add_mvns_together</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Add MVNs of accepted point distribution together.</p></li>
<li><p><strong>include_training_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Include training data in the accpeted point distribution before
sampling.</p></li>
<li><p><strong>var_mult</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Variance multiplier.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Random seed to use for random sampling.</p></li>
<li><p><strong>n_repeats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of times to converge to the correct number of points. Each
iteration may be a different realization of the posterior.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print useful information.</p></li>
<li><p><strong>**kwargs</strong> – show_plots : bool, optional
Show 2D plot of proposed points with step history &amp; training data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>acc_pts</strong> (<em>ndarray</em>) – Array of proposed points to be used as initial
conditions in new simulations.</p></li>
<li><p><strong>Kappa</strong> (<em>float</em>) – Scaling factor which reproduced the desired number
of accepted points.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Will automatically exit if it goes through max_iters iterations
without converging on the desired number of points.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.get_saved_chain_step_history">
<span class="sig-name descname"><span class="pre">get_saved_chain_step_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.get_saved_chain_step_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.get_saved_chain_step_history" title="Link to this definition"></a></dt>
<dd><p>Return the saved chain step history.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.make_prop_points_plots">
<span class="sig-name descname"><span class="pre">make_prop_points_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_hist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.make_prop_points_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.make_prop_points_plots" title="Link to this definition"></a></dt>
<dd><p>Plot the proposed / accepted points over the step history.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.make_trace_plot">
<span class="sig-name descname"><span class="pre">make_trace_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain_holder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.make_trace_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.make_trace_plot" title="Link to this definition"></a></dt>
<dd><p>Make a <cite>step number</cite> vs. <cite>position of a sampler in an axis</cite> plot.</p>
<p>This function makes titles assuming you are using the data
from the classifier.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.normalize_step_history">
<span class="sig-name descname"><span class="pre">normalize_step_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_history</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.normalize_step_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.normalize_step_history" title="Link to this definition"></a></dt>
<dd><p>Take steps and normalize [0,1] according to min/max in each axis.</p>
<p>The max and min are taken from the original data set from TableData.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.run_MCMC">
<span class="sig-name descname"><span class="pre">run_MCMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_trials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_limit_reject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e4</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">TD_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.run_MCMC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.run_MCMC" title="Link to this definition"></a></dt>
<dd><p>Run a Markov chain Monte Carlo given a target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_trials</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of proposals or trial steps to take before stopping.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Related to the step size of the MCMC walker.
Defines the standard deviation of a zero mean normal
from which the step is randomly drawn.</p></li>
<li><p><strong>step_history</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Initial starting location in parameter space.
Could contain an arbitrary number of previous steps
but a walker will start at the last step in the list.</p></li>
<li><p><strong>targe_dist</strong> (<em>callable</em>) – The target distribution to sample.
Must take arguments ( method_name, element_of_step_history )
(A 2D analytic function is provided - TD_2d_analytic)</p></li>
<li><p><strong>classifier_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of interpolation technique used in the target_dist.</p></li>
<li><p><strong>T</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Temperature of the MCMC.</p></li>
<li><p><strong>upper_limit_reject</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Sets the maximum number of rejected steps before the MCMC
stops walking. Avoiding a slowly converging walk with few
accepted points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>step_history</strong> (<em>array</em>) – An array containing all accepted steps of the MCMC.</p></li>
<li><p><strong>accept</strong> (<em>int</em>) – Total number of accepted steps.</p></li>
<li><p><strong>reject</strong> (<em>int</em>) – Total number of rejected steps.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Assumes uniform priors and a symetric jump proposal (gaussian).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.run_PTMCMC">
<span class="sig-name descname"><span class="pre">run_PTMCMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_tot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_draws_per_swap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_limit_reject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">TD_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.run_PTMCMC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.run_PTMCMC" title="Link to this definition"></a></dt>
<dd><p>Run a Paralel Tempered MCMC with user-specified target distribution.</p>
<p>Calls the method <cite>run_MCMC</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Sets the maximum temperature MCMC in the chain.</p></li>
<li><p><strong>N_tot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The total number of iterations for the PTMCMC.</p></li>
<li><p><strong>target_dist</strong> (<em>callable</em>) – The target distribution to sample.
Must take arguments (method_name, location_to_eval)
(A 2D analytic function is provided - analytic_target_dist)</p></li>
<li><p><strong>classifier_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – A single string or list of strings specifying the interpolator to
use for classification or classification &amp; regression respectively.</p></li>
<li><p><strong>init_pos</strong> (<em>array</em>) – Initial position of walkers in each axis. Default is the median of
the input data in TableData.</p></li>
<li><p><strong>N_draws_per_swap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of draws to perform for each MCMC before swap proposals.</p></li>
<li><p><strong>c_spacing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Sets the spacing of temperatures in each chain.
T_{i+1} = T_{i}^{1/c}, range: [T_max , T=1]</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Sets the standard deviation of steps taken by the walkers. Default
is 1/5 the range of training data from TableData.</p></li>
<li><p><strong>upper_limit_reject</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Sets the upper limit of rejected points.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Useful print statements during execution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>chain_step_history</strong> (<em>dict</em>) – Hold the step history for every chain. Keys are integers that range
from 0 (max T) to the total number of chains -1 (min T).</p></li>
<li><p><strong>T_list</strong> (<em>array</em>) – Array filled with the temperatures of each chain from max to min.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>There is a zero prior on the PTMCMC outside the range of training data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.save_chain_step_history">
<span class="sig-name descname"><span class="pre">save_chain_step_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_step_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.save_chain_step_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.save_chain_step_history" title="Link to this definition"></a></dt>
<dd><p>Save PTMCMC output chain_step_history inside the sampler object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.sample.Sampler.undo_normalize_step_history">
<span class="sig-name descname"><span class="pre">undo_normalize_step_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normed_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/sample.html#Sampler.undo_normalize_step_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.sample.Sampler.undo_normalize_step_history" title="Link to this definition"></a></dt>
<dd><p>Rescale step history.</p>
<p>Take normed steps from [0,1] and return their value
in the original range of the axes based off the range in TableData.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-posydon.active_learning.psy_cris.utils">
<span id="posydon-active-learning-psy-cris-utils"></span><h2>posydon.active_learning.psy_cris.utils<a class="headerlink" href="#module-posydon.active_learning.psy_cris.utils" title="Link to this heading"></a></h2>
<p>Module defining helper functions for PSY-CRIS.</p>
<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.calc_performance">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">calc_performance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfs_per_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rbf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#calc_performance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.calc_performance" title="Link to this definition"></a></dt>
<dd><p>Calculate accuracy and confusion matrix.</p>
<p>Given a list of pandas DataFrames, iterate over them and
calculate the accuracy and confusion matrix for synthetic data sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dfs_per_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of pandas DataFrames containing training data
to train an classifier on and then compare to the
true background distribution.</p></li>
<li><p><strong>cls_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Name of classifier to train.</p></li>
<li><p><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Density per axis of the grid used to oversample the true background.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print some helpful info.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>acc_per_iter</strong> (<em>array</em>) – Array conatining overall accuracy of interpolator
per iteration of training data.</p></li>
<li><p><strong>conf_matrix_per_iter</strong> (<em>list</em>) – List of confusion matricies per iteration. Calculated
using ‘get_confusion_matrix’.</p></li>
<li><p><strong>regr_acc_per_iter</strong> (<em>list</em>) – List of regression accuracy terms.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.calc_regression_accuracy">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">calc_regression_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_regr_abs_frac_diffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdf_cutoff_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#calc_regression_accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.calc_regression_accuracy" title="Link to this definition"></a></dt>
<dd><p>Calculate the the fractional change at which the cdf_cutoff is below.</p>
<p>For a given distribution of absolute fractional differences: calculate the
the fractional change at which the cdf_cutoff is below.</p>
<p>For 50% of the data set, the range of frac diffs is [0,?].</p>
<p>(What is not being asked: For a frac diff of 10% what fraction of the data
has a frac diff &lt;= that number. )</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.check_dist">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">check_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#check_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.check_dist" title="Link to this definition"></a></dt>
<dd><p>Check euclidean distance between the original and proposed points.</p>
<p>Proposed points a distance &gt;= threshold are accepted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original</strong> (<em>ndarray</em>) – Original points previously run.</p></li>
<li><p><strong>proposed</strong> (<em>ndarray</em>) – Proposed points for new simulations.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The theshold distance between acceptance and rejection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>proposed_above_thresh_for_all_original</strong> – True if the distance between the proposed point is &gt;= threshold.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>, array</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The purpose of this function is to not propose points that are some
threshold away from already accepted points.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.do_dynamic_sampling">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">do_dynamic_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_final_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_points_per_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_starting_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_scale_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_increase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">all_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#do_dynamic_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.do_dynamic_sampling" title="Link to this definition"></a></dt>
<dd><p>Run cris algorithm iteratively.</p>
<p>For a given number of starting and ending points, run the cris algorithm
iteratively in step sizes of new_points_per_iter. After each iteration,
query points are identified using the original 2D snythetic data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_starting_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of starting points to being cris iterations on a 2D grid
sampled from the original 2D synthetic data set.</p></li>
<li><p><strong>N_final_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of points to converge to after iterating with cris.</p></li>
<li><p><strong>new_points_per_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>array-like</em>) – For every iteration the number of new query points for cris to propose.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – New query points are ommited from the next iteration if their euclidean
distance to other data points is less than the threshold.</p></li>
<li><p><strong>jitter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Default False, for the starting grid jitter about the center randomly
in the range of +/- the 1/2 the bin width in each dimesnion.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Print useful things.</p></li>
<li><p><strong>show_plots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Show plots of proposed points and training points each iteration.</p></li>
<li><p><strong>all_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Dictionary of all_kwargs passed to get_new_query_points defining
how every part of the cris algorithm is implemented.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.do_small_class_proposal">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">do_small_class_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_new_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_scale_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#do_small_class_proposal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.do_small_class_proposal" title="Link to this definition"></a></dt>
<dd><p>Handle proposals where only one point in class and regression is needed.</p>
<p>Handles proposals where only one point exists for a class and regression is
requested. Otherwise the interpolators will fail. Drawn from a gaussian
around the point with length scale given by the average distance between
nearest neighbors (in each axis).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.get_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">get_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#get_confusion_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.get_confusion_matrix" title="Link to this definition"></a></dt>
<dd><p>Calculate a confusion matrix given lists of predicted and actual values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Predicted values from the classifier.</p></li>
<li><p><strong>actual</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – True values from the underlying distribution.</p></li>
<li><p><strong>all_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – A list of all unique classes.
Should be either np.unique(actual) or a subset thereof.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print our the line by line confusion matrix prefixed with the class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>confusion_matrix</strong> – Rows and columns of confusion matrix in order and number given in
<cite>all_classes</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.get_new_query_points">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">get_new_query_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_new_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TableData_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Classifier_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Regressor_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sampler_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Proposal_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_scale_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#get_new_query_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.get_new_query_points" title="Link to this definition"></a></dt>
<dd><p>Run the psy-cris algorithm to propose new query points to be labeled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_new_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of new query points desired.</p></li>
<li><p><strong>TableData_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Kwargs used for initializing TableData.</p></li>
<li><p><strong>Classifier_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Kwargs used for the Classifier method <cite>train_everything</cite>.</p></li>
<li><p><strong>Regressor_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Kwargs used the Regressor method <cite>train_everything</cite>.</p></li>
<li><p><strong>Sampler_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optinal</em>) – Kwargs used for choosing Sampler target distribution and the method
<cite>run_PTMCMC</cite>.</p></li>
<li><p><strong>Proposal_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Kwargs used in the Sampler method ‘get_proposed_points’ and the
Classifier method ‘get_class_predictions’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>proposed_points</strong> (<em>ndarray</em>) – Now query points.</p></li>
<li><p><strong>pred_class</strong> (<em>array</em>) – For all proposed points, the best prediction from the trained
classifier.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.get_prediction_diffs">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">get_prediction_diffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regressor_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#get_prediction_diffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.get_prediction_diffs" title="Link to this definition"></a></dt>
<dd><p>Train classifier and get predictions and actual classification.</p>
<p>From a DataFrame of training data, train a classifier and get both
the predictions and actual classification in the classification space
where the analytic function is defined. Also calculate the difference
between the true regression function and that infered from the trainined
regressor. Dimensionality is infered from ‘training_df’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>training_df</strong> (<em>pandas DataFrame</em>) – DataFrame of training data, a subset of the true distribution.</p></li>
<li><p><strong>classifier_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the classification algorithm to use.</p></li>
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Sets the (N**dim) resolution of points used to query the trained
classifier.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print more useful information.</p></li>
<li><p><strong>timer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print timing diagnostic information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pred_class</strong> (<em>array</em>) – 1D array of predictions from the trained classifier.</p></li>
<li><p><strong>true_class_result</strong> (<em>array</em>) – 1D array of the true classification for the corresponding points.</p></li>
<li><p><strong>all_regr_acc_per_class</strong> (<em>dict</em>) – Dict of lists with regression accuracy values per class and combined.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.get_random_grid_df">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">get_random_grid_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#get_random_grid_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.get_random_grid_df" title="Link to this definition"></a></dt>
<dd><p>Produce a randomly sampled grid.</p>
<p>Given N total points, produce a randomly sampled grid drawn
from the analytic data set (2D or 3D).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Total number of points to drawn from a 2D random data set</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality of synthetic data set. (2 or 3)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>random_df</strong> – DataFrame of true data drawn from the analytic classification
and regression functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.get_regular_grid_df">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">get_regular_grid_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_ppa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#get_regular_grid_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.get_regular_grid_df" title="Link to this definition"></a></dt>
<dd><p>Produce an even grid.</p>
<p>Given N total points, produce an even grid with
approximately the same number of evenly spaced points sampled
from the analytic data set (2D or 3D).</p>
<p>The number of returned grid points is N only if N is a perfect square.
Otherwise use N_ppa to define number of points per axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Total number of points to make into a 2D even grid</p></li>
<li><p><strong>jitter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Place the center of the grid randomly around (0,0) in the range of
+/- 1/2 bin width while keeping the span in each axis at 6.</p></li>
<li><p><strong>N_ppa</strong> (<em>array</em><em>, </em><em>optional</em>) – Numbers of points per axis. If provided, it overrides N.</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Dimensionality of synthetic data set. (2 or 3)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Print some diagnostics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>extra_points</strong> – DataFrame of true data drawn from the analytic classification
and regression functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.parse_inifile">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">parse_inifile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#parse_inifile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.parse_inifile" title="Link to this definition"></a></dt>
<dd><p>Parse an ini file to run psy-cris method ‘get_new_query_points’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to ini file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>all_kwargs_dict</strong> – Nested dictionary of parsed inifile kwargs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.plot_proposed_points_2D">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">plot_proposed_points_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">where_to_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loops</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_init_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where_good_bools</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#plot_proposed_points_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.plot_proposed_points_2D" title="Link to this definition"></a></dt>
<dd><p>Plot proposed points in 2-D space.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="posydon.active_learning.psy_cris.utils.plot_proposed_points_3D">
<span class="sig-prename descclassname"><span class="pre">posydon.active_learning.psy_cris.utils.</span></span><span class="sig-name descname"><span class="pre">plot_proposed_points_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">where_to_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loops</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_init_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">my_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where_good_bools</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/posydon/active_learning/psy_cris/utils.html#plot_proposed_points_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#posydon.active_learning.psy_cris.utils.plot_proposed_points_3D" title="Link to this definition"></a></dt>
<dd><p>Plot proposed points in 3-D space.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="posydon.active_learning.html" class="btn btn-neutral float-left" title="posydon.active_learning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="posydon.active_learning.psy_cris.run_params.html" class="btn btn-neutral float-right" title="posydon.active_learning.psy_cris.run_params" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Tassos Fragos.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      Version: 2.0.3
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        
        <dl>
            <dt> v2</dt>
            
            <dd><a href="https://posydon.org/POSYDON/v2.0.3/index.html">2.0</a></dd>
            
        </dl>
        
        <dl>
            <dt> v1</dt>
            
            <dd><a href="https://posydon.org/POSYDON/v1.0.5/index.html">1.0</a></dd>
            
        </dl>
        
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>