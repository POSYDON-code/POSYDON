<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Run a fixed MESA grid &mdash; posydon 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The PSyGrid Object" href="../../PSyGrid/PSyGrid.html" />
    <link rel="prev" title=".ini file documentation for POSYDON GRIDS" href="../inifile.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            posydon
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/data.html">Data Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Application Programming Interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Binary Star Grids</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../inifile.html">.ini file documentation for POSYDON GRIDS</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Run a fixed MESA grid</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#default-evolutionary-parameters">Default evolutionary parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#non-default-evolutionary-parameters">Non-default evolutionary parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../PSyGrid/PSyGrid.html">The PSyGrid Object</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Generating Populations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pop_synth/POSYDON_populations.html">Running populations using POSYDON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pop_synth/pop_synth.html">Running a POSYDON population synthesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pop_synth/custom_flow.html">Custom population synthesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SingleStar/SingleStar.html">The SingleStar object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BinaryStar/BinaryStar.html">The BinaryStar object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_pop_options/custom_hooks.html">Evolutionary Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_pop_options/debugging_binaries.html">Debugging Failed Binaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interpolation/IF-Interpolator/IFInterpolator.html">Initial-Final Interpolation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plotting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../visualization/plot1D/plot1D.html">1D plotting functionalities for POSYON GRIDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization/plot2D/plot2D.html">2D plotting functionalities for POSYON GRIDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization/VHD/VHD.html">Van den Heuvel diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interpolation/violinplot.html">Making the Violin Plot</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/licence.html">Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/attribution.html">Attribution</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">posydon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Run a fixed MESA grid</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/run_mesa_grids/fixed/fixed.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="run-a-fixed-mesa-grid">
<span id="fixed-grid"></span><h1>Run a fixed MESA grid<a class="headerlink" href="#run-a-fixed-mesa-grid" title="Permalink to this headline"></a></h1>
<section id="default-evolutionary-parameters">
<h2>Default evolutionary parameters<a class="headerlink" href="#default-evolutionary-parameters" title="Permalink to this headline"></a></h2>
<p>POSYDON makes it easy to run a fixed grid of binaries with MESA within a high
performance computing environment. Note that these instructions assume you
are using slurm as your job scheduler. We just need to start by setting a few
environmental variables. We recommend you add these to your <cite>.bashrc</cite> or
<cite>.bash_profile</cite> so they are included at login. The filepaths of these need to be
edited for your own installation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export MESA_DIR=&quot;/projects/b1119/mesa_sdk/mesa-r11701&quot;
export MESASDK_ROOT=&quot;/projects/b1119/mesa_sdk/mesasdk&quot;
source $MESASDK_ROOT/bin/mesasdk_init.sh
</pre></div>
</div>
<p>Next, you will want to create a working directory for your grid of binaries.
For this example, we will create a working directory called <cite>example_grid</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">example_grid</span>
<span class="n">cd</span> <span class="n">example_grid</span>
</pre></div>
</div>
<p>This directory will contain all the binary runs and associated data generated
by the individual MESA runs as well as the functionality for slurm to run the
grid.</p>
<p>Now that we have our grid, we need to create two separate files: a file
containing the list of binaries we want to evolve and an .ini file that
contains all the parameters associated with running the grid. Let’s start with
the list of binaries we want to evolve. For the case of this example, let’s
evolve a series of high-mass X-ray binaries with neutron star accretors at a
series of initial binary periods. We’ll use our favorite text editor to add the
following lines into a file we’ll call <cite>grid.csv</cite>. As we’ll see below, it can
be given any name, but the entries must be separated by commas.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">initial_period_in_days</span>
<span class="mi">10</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mi">1</span>
<span class="mi">10</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mi">10</span>
<span class="mi">10</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mi">100</span>
<span class="mi">10</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mi">1000</span>
</pre></div>
</div>
<p>POSYDON internally allows any variable to be included here, so long as it has
the same name as a variable in MESA. However, these three parameters ought to
always be specified, otherwise you will be evolving a binary with a default
orbital period and masses.</p>
<p>As for the .ini file, you can copy over the <a class="reference external" href="https://github.com/POSYDON-code/POSYDON/blob/development/grid_params/grid_params.ini">example</a>
from the <a class="reference internal" href="../inifile.html#inifile"><span class="std std-ref">.ini file documentation for POSYDON GRIDS</span></a> page, which provides a more detailed description of all
the entries. Make sure to carefully go through each of the separate entries and
adjust them for your particular needs. Place that .ini file (which we have
named <cite>example_grid.ini</cite>) in our example_grid directory.</p>
<p>Now, with our <cite>grid.csv</cite> and <cite>example_grid.ini</cite> files ready to go, we use a
POSYDON script <cite>posydon-setup-grid</cite> to generate all the necessary files to run
the grid using slurm. Note the different arguments here. We are designating
that: 1) we are using a fixed grid, 2) the name of the .ini file, and 3) that
our job scheduler is slurm. We may expand compatibility for other job
schedulers in the future, but for now slurm is the only implemented option.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">posydon</span><span class="o">-</span><span class="n">setup</span><span class="o">-</span><span class="n">grid</span> <span class="o">--</span><span class="n">grid</span><span class="o">-</span><span class="nb">type</span> <span class="n">fixed</span> <span class="o">--</span><span class="n">inifile</span> <span class="n">example_grid</span><span class="o">.</span><span class="n">ini</span> <span class="o">--</span><span class="n">submission</span><span class="o">-</span><span class="nb">type</span> <span class="n">slurm</span>
</pre></div>
</div>
<p>This will take a minute to run. You will note that it includes a pull from the
POSYDON GitHub repository to ensure the correct, designated version of the MESA
inlists are being used. It is possible that you will need to enter your
GitHub username and password during this step. Additionally, note that this
step takes some time to run, as several MESA files are being compiled.</p>
<p>Once finished, you will note that in our <cite>example_grid</cite> directory, we now have
several new files and new directories. One advantage of this implementation is
that all the binaries we run use a single version of the MESA executables,
rather than each binary having its own copy of the same files.</p>
<p>Finally, we are ready to submit our jobs with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sbatch</span> <span class="n">slurm_job_array_grid_submit</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Once the grid of runs is completed, we recommend you use our provided PSyGrid
functionality to interpret and collate the individual binary runs
(link for documentation: <a class="reference internal" href="../../PSyGrid/PSyGrid.html#psygrid"><span class="std std-ref">The PSyGrid Object</span></a>.)</p>
</section>
<section id="non-default-evolutionary-parameters">
<h2>Non-default evolutionary parameters<a class="headerlink" href="#non-default-evolutionary-parameters" title="Permalink to this headline"></a></h2>
<p>If you want to change the binary evolution parameters so you are using
non-default options, we have constructed a hierarchy of MESA inlists. You can
provide a non-default option in your own user-provided MESA inlist, which is
explicitly linked in the inifile (make sure you uncomment the appropriate
lines). We additionally provide the capability to use your own
<cite>run_star_extras.f</cite> and <cite>run_binary_extras.f</cite> as well as provide your own list
of history and profile columns. See <a class="reference internal" href="../inifile.html#inifile"><span class="std std-ref">.ini file documentation for POSYDON GRIDS</span></a> for details.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../inifile.html" class="btn btn-neutral float-left" title=".ini file documentation for POSYDON GRIDS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../PSyGrid/PSyGrid.html" class="btn btn-neutral float-right" title="The PSyGrid Object" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Tassos Fragos.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      Version: 1.0.0
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        
        <dl>
            <dt> v2</dt>
            
            <dd><a href="https://posydon.org/POSYDON/v2.0.0/index.html">2.0</a></dd>
            
        </dl>
        
        <dl>
            <dt> v1</dt>
            
            <dd><a href="https://posydon.org/POSYDON/v1.0.5/index.html">1.0</a></dd>
            
        </dl>
        
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>